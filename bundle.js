(()=>{"use strict";var __webpack_modules__={349:(t,e,r)=>{r.d(e,{SH:()=>n,ZP:()=>i,Fy:()=>o,bE:()=>_,OK:()=>a,ZA:()=>s});var n=192,i=224,o=192,_=224;function a(t){return t/o}function s(t){return t/_}},506:(t,e,r)=>{r.d(e,{R0:()=>u,gT:()=>l});var n,i=r(869),o=r(822),_=r(349),a=r(566),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),u={render_layer:i.bm,collide_group:i.A4,collide_mask:i.A4,kill_on_exit:!0,kill_by_bomb:!0,auto_direction:!0,life:0},c=function(t,e){return!0},l=function(t){function e(e,r){var n=t.call(this,e)||this;return n.state=i.ZM.PRE_ENTRY,n.motion=c,n.motion_stat=null,n.config=r,n.time=0,n}return s(e,t),e.prototype.setMotion=function(t){return this.motion=t,this.simpleInit(0,0,0,0)},e.prototype.simpleInit=function(t,e,r,n){return this.px=t,this.py=e,this.vx=r*Math.cos(n),this.vy=r*Math.sin(n),this.dir=n,this},e.prototype.update=function(t){this.state==i.ZM.PRE_ENTRY&&(this.state=i.ZM.ALIVE);var e=o.n.INSTANCE.special_effects.time_rate;this.time+=e,this.motion(this,e)&&(this.px+=this.vx*e,this.py+=this.vy*e,this.config.auto_direction&&(this.dir=Math.atan2(this.vy,this.vx)))},e.prototype.postUpdate=function(t){var e,r;(null===(r=null===(e=this.shaped_sprite)||void 0===e?void 0:e.shape)||void 0===r?void 0:r.exitScreen(this.px,this.py,this.dir,_.SH,_.ZP))&&this.config.kill_on_exit&&(this.state=i.ZM.LEAVING),this.config.life&&this.time>=this.config.life&&(this.state=i.ZM.LEAVING),this.state==i.ZM.LEAVING&&(this.state=i.ZM.DEAD)},e.prototype.attack=function(t,e){e.damaged(e,this)},e.prototype.damaged=function(t,e){return!(!this.config.kill_by_bomb||e.config.collide_group!=i.t_&&e.config.collide_group!=i.T||(this.state=i.ZM.LEAVING,0))},e}(a.eY)},869:(t,e,r)=>{r.d(e,{T:()=>i,ZE:()=>o,yR:()=>_,A4:()=>a,t_:()=>s,T7:()=>u,KZ:()=>c,DV:()=>l,P4:()=>p,k8:()=>h,Gs:()=>f,Io:()=>d,NH:()=>E,bm:()=>y,ZM:()=>n,d9:()=>A,S:()=>b});var n,i=0,o=1,_=2,a=3,s=4,u=5,c=0,l=1,p=1,h=1,f=14,d=0,E=0,y=500;function A(t){return Object.assign({},t)}!function(t){t[t.PRE_ENTRY=0]="PRE_ENTRY",t[t.ALIVE=1]="ALIVE",t[t.LEAVING=2]="LEAVING",t[t.DEAD=3]="DEAD"}(n||(n={}));var b={render_layer:700,collide_group:i,collide_mask:c}},533:(t,e,r)=>{r.d(e,{U:()=>s});var n,i=r(566),o=r(349),_=r(869),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=function(t){function e(r,n,i,o,a){var s=t.call(this,(0,_.d9)(r))||this;return s.config=_.S,s.state=_.ZM.ALIVE,s.miss=!1,s.bomb=!1,s.pre_miss=0,s.miss_time=0,s.invince_time=0,e.INSTANCE=s,s.proto=n,s.ability=i,s.sprite=r,s.px=o,s.py=a,s.dir=0,s}return a(e,t),e.updateState=function(t){e.action=t},e.prototype.update=function(t){e.action&&(this.px+=e.action.pos_x,this.py+=e.action.pos_y,this.px<-o.SH&&(this.px=-o.SH),this.px>o.SH&&(this.px=o.SH),this.py<-o.ZP&&(this.py=-o.ZP),this.py>o.ZP&&(this.py=o.ZP),this.proto.updateShoot(e.action.key_z),this.bomb=this.proto.updateBomb(e.action.key_x),this.proto.updateSpecial(e.action.key_c))},e.prototype.postUpdate=function(t){this.miss_time>0&&this.miss_time--,this.pre_miss>0&&(this.pre_miss--,0==this.pre_miss&&(console.log("missed"),this.miss_time=this.ability.miss_time)),this.miss&&(this.miss=!1,this.pre_miss=this.ability.pre_miss),this.bomb&&(this.bomb=!1,this.miss_time=this.ability.bomb_time,this.pre_miss>0&&(console.log("bomb after miss"),this.pre_miss=0)),this.miss_time>0||this.pre_miss>0?(this.invince_time++,Math.floor(this.invince_time/6)%2==0?this.shaped_sprite.sprite=null:this.shaped_sprite.sprite=this.sprite.sprite):(this.invince_time=0,this.shaped_sprite.sprite=this.sprite.sprite)},e.prototype.attack=function(t,e){},e.prototype.damaged=function(t,e){return 0==this.pre_miss&&0==this.miss_time&&(this.miss=!0),e.damaged(e,this)},e.INSTANCE=null,e.action=null,e}(i.eY)},822:(t,e,r)=>{r.d(e,{n:()=>s});var n,i=r(869),o=r(566),_=r(68),a=function(){this.time_rate=1};!function(t){t[t.PRE_INIT=0]="PRE_INIT",t[t.UPDATE=1]="UPDATE",t[t.POST_UPDATE=2]="POST_UPDATE",t[t.ADD_BACK=3]="ADD_BACK"}(n||(n={}));var s=function(){function t(){this.groups=[],this.pending=[],this.update_stage=n.PRE_INIT,this.time=0,this.special_effects=new a,t.INSTANCE=this,this.groups.push({id:i.T,mask:i.KZ,list:[]}),this.groups.push({id:i.ZE,mask:i.DV,list:[]}),this.groups.push({id:i.yR,mask:i.P4,list:[]}),this.groups.push({id:i.A4,mask:i.k8,list:[]}),this.groups.push({id:i.t_,mask:i.Gs,list:[]}),this.groups.push({id:i.T7,mask:i.Io,list:[]})}return t.prototype.registerGroup=function(t){var e=this.groups.length;return this.groups.push({id:e,mask:t,list:[]}),e},t.prototype.add=function(t){this.update_stage!=n.ADD_BACK&&this.update_stage!=n.PRE_INIT?this.pending.push(t):this.groups[t.config.collide_group].list.push(t)},t.prototype.update=function(){var t=this;this.update_stage=n.UPDATE,this.groups.forEach((function(t){return t.list.forEach((function(t){return t.update(t)}))}));for(var e=0;e<this.groups.length;e++)for(var r=0;r<this.groups.length;r++)if(this.groups[e].mask&1<<r)for(var _=0,a=this.groups[e].list;_<a.length;_++){var s=a[_];if(s.state==i.ZM.ALIVE&&s.shaped_sprite&&s.shaped_sprite.shape)for(var u=0,c=this.groups[r].list;u<c.length;u++){var l=c[u];l.state==i.ZM.ALIVE&&l.shaped_sprite&&l.shaped_sprite.shape&&(0,o._R)(s,l)&&s.attack(s,l)}}this.update_stage=n.POST_UPDATE,this.groups.forEach((function(t){return t.list.forEach((function(t){return t.postUpdate(t)}))})),this.groups.forEach((function(t){return t.list=t.list.filter((function(t){return t.state!=i.ZM.DEAD}))})),this.update_stage=n.ADD_BACK,this.pending.forEach((function(e){return t.add(e)})),this.pending=[],this.time++},t.prototype.render=function(){var t,e,r,n,i,o,a,s;return i=this,o=void 0,s=function(){var i,o,a,s,u,c,l,p,h,f;return function(t,e){var r,n,i,o,_={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;_;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return _.label++,{value:o[1],done:!1};case 5:_.label++,n=o[1],o=[0];continue;case 7:o=_.ops.pop(),_.trys.pop();continue;default:if(!((i=(i=_.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){_=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){_.label=o[1];break}if(6===o[0]&&_.label<i[1]){_.label=i[1],i=o;break}if(i&&_.label<i[2]){_.label=i[2],_.ops.push(o);break}i[2]&&_.ops.pop(),_.trys.pop();continue}o=e.call(t,_)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}(this,(function(d){for(i=new Map,o=0,a=this.groups;o<a.length;o++)for(s=a[o],u=0,c=s.list;u<c.length;u++)(l=c[u]).config.render_layer&&(null===(t=l.shaped_sprite)||void 0===t?void 0:t.sprite)&&(i.has(l.config.render_layer)||i.set(l.config.render_layer,new Map),p=i.get(l.config.render_layer),h=null===(n=null===(r=null===(e=l.shaped_sprite)||void 0===e?void 0:e.sprite)||void 0===r?void 0:r.sprite)||void 0===n?void 0:n.path,p.has(h)||p.set(h,[]),p.get(h).push(l));return f=[],i.forEach((function(t,e){return f.push({rl:e,v:t})})),f.sort((function(t,e){return t.rl-e.rl})),f.forEach((function(t){return t.v.forEach((function(t,e){return _.Z.get(e).draw(t)}))})),[2]}))},new((a=void 0)||(a=Promise))((function(t,e){function r(t){try{_(s.next(t))}catch(t){e(t)}}function n(t){try{_(s.throw(t))}catch(t){e(t)}}function _(e){var i;e.done?t(e.value):(i=e.value,i instanceof a?i:new a((function(t){t(i)}))).then(r,n)}_((s=s.apply(i,o||[])).next())}))},t}()},334:(t,e,r)=>{r.d(e,{hP:()=>f,b2:()=>E});var n,i=r(869),o=r(566),_=r(822),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],_=0,a=o.length;_<a;_++,i++)n[i]=o[_];return n},u=function(){},c=function(t){function e(e){var r=t.call(this)||this;return r.remain=e,r}return a(e,t),e.prototype.update=function(t){return this.remain-=t,this.remain<0?-this.remain:0},e}(u),l=function(t){function e(e){var r=t.call(this)||this;return r.todo=e,r}return a(e,t),e.prototype.update=function(t){return this.todo(),t},e}(u),p=function(){};function h(t){return t.map((function(t){return"number"==typeof t?new c(t):"function"==typeof t?new l(t):t}))}var f=function(t){function e(e,r){var n=t.call(this)||this;return n.index=0,n.todo=e,n.total=r,n}return a(e,t),e.prototype.supply=function(){return this.index>=this.total?null:(t="function"==typeof this.todo?this.todo(this.index):this.todo,this.index++,h(t));var t},e}(p),d={render_layer:i.NH,collide_group:i.T7,collide_mask:i.Io},E=function(t){function e(e){var r=t.call(this)||this;return r.config=d,r.state=i.ZM.PRE_ENTRY,r.list=h(e),r}return a(e,t),e.prototype.update=function(t){this.state==i.ZM.PRE_ENTRY&&(this.state=i.ZM.ALIVE);for(var e=_.n.INSTANCE.special_effects.time_rate;this.list.length>0&&e;){var r=this.list[0];if(r instanceof p){var n=r.supply();n&&n.length?this.list=s(n,this.list):this.list.shift()}else(e=r.update(e))>0&&this.list.shift()}0==this.list.length&&(this.state=i.ZM.LEAVING)},e.prototype.postUpdate=function(t){this.state==i.ZM.LEAVING&&(this.state=i.ZM.DEAD)},e.prototype.attack=function(t){},e.prototype.damaged=function(t,e){return!1},e}(o.u5)},176:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{S:()=>init});var _entity_Bullet__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(506),_entity_SelfMachine__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(533),_stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(334),_util_SpriteManager__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(68),_util_sprites__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(940),_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(583),_stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(822),_entity_Entity__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(869),__awaiter=function(t,e,r,n){return new(r||(r=Promise))((function(i,o){function _(t){try{s(n.next(t))}catch(t){o(t)}}function a(t){try{s(n.throw(t))}catch(t){o(t)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(_,a)}s((n=n.apply(t,e||[])).next())}))},__generator=function(t,e){var r,n,i,o,_={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;_;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return _.label++,{value:o[1],done:!1};case 5:_.label++,n=o[1],o=[0];continue;case 7:o=_.ops.pop(),_.trys.pop();continue;default:if(!((i=(i=_.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){_=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){_.label=o[1];break}if(6===o[0]&&_.label<i[1]){_.label=i[1],i=o;break}if(i&&_.label<i[2]){_.label=i[2],_.ops.push(o);break}i[2]&&_.ops.pop(),_.trys.pop();continue}o=e.call(t,_)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},sm_proto={updateShoot:function(t){return!1},updateBomb:function(t){return!1},updateSpecial:function(t){return!1}},sm_abi={pre_miss:30,miss_time:60,bomb_time:60},repeat=function(t,e){return void 0===e&&(e=1/0),new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.hP(t,e)},stage_000=function(t){var e=_util_sprites__WEBPACK_IMPORTED_MODULE_4__.hZ(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.Dp.Oval,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.C8.Red,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.fz.Overlay),r=_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.x(e,1,1);return new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([60*t,repeat((function(e){return[repeat((function(n){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _entity_Bullet__WEBPACK_IMPORTED_MODULE_0__.gT(r,_entity_Bullet__WEBPACK_IMPORTED_MODULE_0__.R0).simpleInit(0,0,3/t,5e-4/t*e*e+2*Math.PI/5*n))}]}),5),1*t]}),1/0)])},stage_001=function(t){var e=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_Bullet__WEBPACK_IMPORTED_MODULE_0__.R0);e.life=120*t,e.kill_on_exit=!1;var r=1*t,n=3/t,i=-n/55,o=.06/t,_=null,a=function(t,a,s,u){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([repeat((function(c){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(_=new _entity_Bullet__WEBPACK_IMPORTED_MODULE_0__.gT(null,e).simpleInit(0,0,n,2*Math.PI/47*c*a*t))},repeat((function(e){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _entity_Bullet__WEBPACK_IMPORTED_MODULE_0__.gT((p=c%2==0?s:u,_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.x(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.e8(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qb.Scale,p,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.fz.Overlay),1,1)),_entity_Bullet__WEBPACK_IMPORTED_MODULE_0__.R0).setMotion((r=_,n=2*Math.PI/40*e,a=o*t,55,l=i,function(t,e){null==t.motion_stat&&(t.motion_stat={a:n}),t.motion_stat.a+=a*e;var i=55*Math.sin(l*t.time);return t.px=r.px+i*Math.cos(t.motion_stat.a),t.py=r.py+i*Math.sin(t.motion_stat.a),t.dir=Math.atan2(i*a,55*l*Math.cos(l*t.time))+t.motion_stat.a,!1})));var r,n,a,l,p}]}),40),r]}),47)]))};return _util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Red,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Blue,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Green,new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([30*t,repeat((function(e){return[function(){return a(e%2*2-1,7,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Red,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Green)},45*t,function(){return a(e%2*2-1,3,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Yellow,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Blue)},45*t,function(){return a(e%2*2-1,1,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Cyan,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Pink)},90*t]}))])},sinit={load_sprite:function(){return _util_SpriteManager__WEBPACK_IMPORTED_MODULE_3__.Z.get(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.Xp.path).load()},add_player:function(){return new _entity_SelfMachine__WEBPACK_IMPORTED_MODULE_1__.U(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.x(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.a_,1,1),sm_proto,sm_abi,0,-192)},add_schedule:stage_001};function init(){return __awaiter(this,void 0,void 0,(function(){var pool;return __generator(this,(function(_a){switch(_a.label){case 0:return[4,sinit.load_sprite()];case 1:return _a.sent(),pool=new _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n,pool.add(sinit.add_player()),pool.add(sinit.add_schedule(2)),eval("window.debug_info.pool = pool"),[2]}}))}))}},566:(t,e,r)=>{r.d(e,{D8:()=>a,eY:()=>u,u5:()=>c,_R:()=>l});var n,i,o=r(68),_=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),a=function(t){function e(e){var r=t.call(this)||this;return r.radius=e,r}return _(e,t),e.prototype.exitScreen=function(t,e,r,n,i){return Math.abs(t)>n+this.radius||Math.abs(e)>i+this.radius},e.prototype.distanceTo=function(t,e,r){return e-=t.px,r-=t.py,Math.sqrt(e*e+r*r)-this.radius},e.prototype._distanceTo=function(t,e){return Math.sqrt(t*t+e*e)-this.radius},e}(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.distanceTo=function(t,e,r){e-=t.px,r-=t.py;var n=t.dir,i=e*Math.cos(-n)-r*Math.sin(-n),o=r*Math.cos(-n)+e*Math.sin(-n);return this._distanceTo(i,o)},e}((function(){}))),s=(_((function(){return null!==i&&i.apply(this,arguments)||this}),i=function(){}),function(){function t(t,e){this.renderType=t,this.shaped_sprite=e}return t.prototype.distanceTo=function(t,e){return this.shaped_sprite.shape.distanceTo(this,t,e)},t}()),u=function(t){function e(e){return t.call(this,o.I.RECT,e)||this}return _(e,t),e.prototype.rectCount=function(){return 1},e.prototype.render=function(t,e){t[10*e+0]=this.px,t[10*e+1]=this.py,t[10*e+2]=this.dir-Math.PI/2,t[10*e+3]=this.shaped_sprite.w/2,t[10*e+4]=this.shaped_sprite.h/2;var r=this.shaped_sprite.sprite;t[10*e+5]=r.tx/r.sprite.w,t[10*e+6]=r.ty/r.sprite.h,t[10*e+7]=r.tw/r.sprite.w,t[10*e+8]=r.th/r.sprite.h,t[10*e+9]=this.shaped_sprite.alpha},e}(s),c=function(t){function e(){return t.call(this,null,null)||this}return _(e,t),e}(s);function l(t,e){if(t instanceof u&&t.shaped_sprite.shape instanceof a)return e.distanceTo(t.px,t.py)<t.shaped_sprite.shape.radius;if(e instanceof u&&e.shaped_sprite.shape instanceof a)return l(e,t);throw new Error("non-circle non-circle collision not found")}},68:(t,e,r)=>{r.d(e,{I:()=>n,Z:()=>o});var n,i=r(924);!function(t){t[t.RECT=0]="RECT",t[t.STRIP=1]="STRIP"}(n||(n={}));var o=function(){function t(t){this.img=null,this.path=t}return t.prototype.loaded=function(){return this.img},t.prototype.load=function(){return t=this,e=void 0,n=function(){var t;return function(t,e){var r,n,i,o,_={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;_;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return _.label++,{value:o[1],done:!1};case 5:_.label++,n=o[1],o=[0];continue;case 7:o=_.ops.pop(),_.trys.pop();continue;default:if(!((i=(i=_.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){_=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){_.label=o[1];break}if(6===o[0]&&_.label<i[1]){_.label=i[1],i=o;break}if(i&&_.label<i[2]){_.label=i[2],_.ops.push(o);break}i[2]&&_.ops.pop(),_.trys.pop();continue}o=e.call(t,_)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}(this,(function(e){switch(e.label){case 0:return[4,(0,i.po)(this.path)];case 1:return t=e.sent(),this.img=(0,i.yG)(t),[2]}}))},new((r=void 0)||(r=Promise))((function(i,o){function _(t){try{s(n.next(t))}catch(t){o(t)}}function a(t){try{s(n.throw(t))}catch(t){o(t)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(_,a)}s((n=n.apply(t,e||[])).next())}));var t,e,r,n},t.get=function(e){return t.INS[e]?t.INS[e]:t.INS[e]=new t(e)},t.prototype.draw=function(t){for(var e=t.reduce((function(t,e){return e.renderType==n.RECT?t+e.rectCount():t}),0),r=new Float32Array(10*e),o=0,_=0,a=t;_<a.length;_++)if((l=a[_]).renderType==n.RECT){var s=l;s.render(r,o),o+=s.rectCount()}(0,i.bn)(r,t.length,this.img);for(var u=0,c=t;u<c.length;u++){var l;if((l=c[u]).renderType==n.STRIP)for(var p=l,h=p.getSprite(),f=h.sprite,d=0,E=p.render();d<E.length;d++){var y=E[d];(0,i.AJ)(y,h.w,y.length/2,f.tx,f.ty,f.tw,f.th,this.img)}}},t.INS={},t}()},583:(t,e,r)=>{r.d(e,{x:()=>_});var n=r(566),i=r(68),o=[[1.4],[2.4,2.4,4,4,2.4,2.4,2.4,2.8,2.4,2.4,4,2.4,2.4,2.4,2.4,2.4],[6,7,8.5,7,6,7,0,10],[14,14]];function _(t,e,r){return{sprite:t,shape:new n.D8(o[t.category][t.type]*e/2),w:t.tw/2,h:t.th/2,renderType:i.I.RECT,alpha:r}}},940:(t,e,r)=>{var n,i,o,_,a,s,u,c;r.d(e,{fz:()=>n,qO:()=>o,qb:()=>_,C8:()=>a,Dp:()=>s,Xp:()=>l,e8:()=>p,hZ:()=>h,a_:()=>f}),function(t){t[t.Overlay=0]="Overlay",t[t.AddBlend=1]="AddBlend"}(n||(n={})),function(t){t[t.Special=0]="Special",t[t.Small=1]="Small",t[t.Medium=2]="Medium",t[t.Large=3]="Large"}(i||(i={})),function(t){t[t.Grey=0]="Grey",t[t.RedX=1]="RedX",t[t.Red=2]="Red",t[t.PinkX=3]="PinkX",t[t.Pink=4]="Pink",t[t.BlueX=5]="BlueX",t[t.Blue=6]="Blue",t[t.CyanX=7]="CyanX",t[t.Cyan=8]="Cyan",t[t.GreenX=9]="GreenX",t[t.Green=10]="Green",t[t.Lemon=11]="Lemon",t[t.YellowX=12]="YellowX",t[t.Yellow=13]="Yellow",t[t.Orange=14]="Orange",t[t.White=15]="White"}(o||(o={})),function(t){t[t.Laser=0]="Laser",t[t.Scale=1]="Scale",t[t.Ring=2]="Ring",t[t.Ball=3]="Ball",t[t.Grain=4]="Grain",t[t.Niddle=5]="Niddle",t[t.Knife=6]="Knife",t[t.Spell=7]="Spell",t[t.Bullet=8]="Bullet",t[t.Germ=9]="Germ",t[t.Star=10]="Star",t[t.Planet=11]="Planet",t[t.S_Cross=12]="S_Cross",t[t.S_Ball=13]="S_Ball",t[t.Curve=14]="Curve",t[t.Drop=15]="Drop"}(_||(_={})),function(t){t[t.Grey=0]="Grey",t[t.Red=1]="Red",t[t.Pink=2]="Pink",t[t.Blue=3]="Blue",t[t.Cyan=4]="Cyan",t[t.Green=5]="Green",t[t.Yellow=6]="Yellow",t[t.White=7]="White"}(a||(a={})),function(t){t[t.Light=0]="Light",t[t.Star=1]="Star",t[t.Ball=2]="Ball",t[t.Butterfly=3]="Butterfly",t[t.Knife=4]="Knife",t[t.Oval=5]="Oval",t[t.LightX=6]="LightX",t[t.Heart=7]="Heart"}(s||(s={})),function(t){t[t.Red=0]="Red",t[t.Blue=1]="Blue",t[t.Green=2]="Green",t[t.Yellow=3]="Yellow"}(u||(u={})),function(t){t[t.Ball=0]="Ball",t[t.Rose=1]="Rose"}(c||(c={}));var l={path:"assets/bullet_000.png",w:516,h:772};function p(t,e,r){return{sprite:l,tx:t<12?1+16*e:t<14?1+e%8*8:t<15?1:258+16*e,ty:t<12?1+16*t:t<14?(t<13?193:241)+8*(e>>3):e<15?515+16*e:449,tw:t<12?16:t<14?8:t<15?256:16,th:t<12?16:t<14?8:16,mode:r,category:i.Small,type:t,color:e}}function h(t,e,r){return{sprite:l,tx:(t<7?1:258)+32*e,ty:0==t?209:t<7?226+32*t:257,tw:32,th:32,mode:r,category:i.Medium,type:t,color:e}}var f={sprite:l,tx:258,ty:17,tw:64,th:64,mode:n.Overlay,category:i.Special,type:0,color:0};n.Overlay,i.Special,n.Overlay,i.Special},924:(t,e,r)=>{r.d(e,{cY:()=>o,po:()=>_,yG:()=>s,ZH:()=>u,bn:()=>f,AJ:()=>d});var n=r(349);const i={gl:null,shader:{program:0,attribute:{coord:0,tex:0,alpha:0},uniform:{uSampler:0}}};function o(){var t=document.getElementById("glcanvas"),e=t.getContext("webgl");if(null===e)return void alert("Unable to initialize WebGL. Your browser or machine may not support it.");i.gl=e;var r=e.createShader(e.VERTEX_SHADER),n=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(r,"\nattribute vec2 coord;\nattribute vec2 tex;\nattribute float alpha;\nvarying highp vec2 vTexCoord;\nvarying highp float vTexAlpha;\nvoid main() {\n    gl_Position = vec4(coord, 0.0, 1.0);\n    vTexCoord = tex;\n    vTexAlpha = alpha;\n}\n"),e.shaderSource(n,"\nprecision highp float;\nvarying highp vec2 vTexCoord;\nvarying highp float vTexAlpha;\nuniform sampler2D uSampler;\nvoid main() {\n    vec4 col = texture2D(uSampler, vTexCoord);\n    col.a *= vTexAlpha;\n    gl_FragColor = col;\n}\n"),e.compileShader(r),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS)){var o=e.getShaderInfoLog(n);return void console.log(o)}var _=e.createProgram();e.attachShader(_,r),e.attachShader(_,n),e.linkProgram(_),e.useProgram(_);const a=i.shader;a.program=_,a.attribute.coord=e.getAttribLocation(_,"coord"),a.attribute.tex=e.getAttribLocation(_,"tex"),a.attribute.alpha=e.getAttribLocation(_,"alpha"),a.uniform.uSampler=e.getUniformLocation(_,"uSampler"),e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.disable(e.DEPTH_TEST),e.viewport(0,0,t.width,t.height)}function _(t){return new Promise(((e,r)=>{let n=new Image;n.onload=()=>e(n),n.onerror=r,n.src=t}))}function a(t,e,r,n,o){const _=i.gl,a=_.createBuffer(),s=i.shader.attribute.coord;_.bindBuffer(_.ARRAY_BUFFER,a),_.bufferData(_.ARRAY_BUFFER,t,_.STATIC_DRAW),_.vertexAttribPointer(s,2,_.FLOAT,!1,0,0),_.enableVertexAttribArray(s);const u=_.createBuffer(),c=i.shader.attribute.tex;_.bindBuffer(_.ARRAY_BUFFER,u),_.bufferData(_.ARRAY_BUFFER,e,_.STATIC_DRAW),_.vertexAttribPointer(c,2,_.FLOAT,!1,0,0),_.enableVertexAttribArray(c);const l=_.createBuffer(),p=i.shader.attribute.alpha;_.bindBuffer(_.ARRAY_BUFFER,l),_.bufferData(_.ARRAY_BUFFER,r,_.STATIC_DRAW),_.vertexAttribPointer(p,1,_.FLOAT,!1,0,0),_.enableVertexAttribArray(p),_.activeTexture(_.TEXTURE0),_.bindTexture(_.TEXTURE_2D,n),_.uniform1i(i.shader.uniform.uSampler,0),_.drawArrays(_.TRIANGLES,0,o)}function s(t){const e=i.gl,r=e.createTexture();return e.bindTexture(e.TEXTURE_2D,r),e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_SHORT_4_4_4_4,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),r}function u(){const t=i.gl;t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT),t.clearColor(0,0,1,1)}const c=[1,-2,-1,1,0,-1],l=[0,0,1,0,1,1],p=[0,1,1,0,0,1];function h(t){for(var e=0;e<t.length/2;e++)t[2*e]=(0,n.OK)(t[2*e]),t[2*e+1]=(0,n.ZA)(t[2*e+1])}function f(t,e,r){const n=new Float32Array(12*e),i=new Float32Array(12*e),o=new Float32Array(6*e),_=Math.PI/2;for(var s=0;s<e;s++)for(var u=0;u<6;u++){const e=t[10*s+2]+c[u]*_;n[12*s+2*u+0]=t[10*s+0]+t[10*s+3]*Math.cos(e)-t[10*s+4]*Math.sin(e),n[12*s+2*u+1]=t[10*s+1]+t[10*s+3]*Math.sin(e)+t[10*s+4]*Math.cos(e),i[12*s+2*u+0]=t[10*s+5]+l[u]*t[10*s+7],i[12*s+2*u+1]=t[10*s+6]+p[u]*t[10*s+8],o[6*s+u]=t[10*s+9]}h(n),a(n,i,o,r,6*e)}function d(t,e,r,n,o,_,a,s){const u=new Float32Array(6*r),c=new Float32Array(r),l=new Float32Array(6*r),p=new Int16Array(2*(r-1));for(var f=0,d=0;d<r-1;d++){const r=t[2*d],n=t[2*d+1],i=t[2*d+2],o=t[2*d+3],_=(r+i)/2,a=(n+o)/2,s=Math.sqrt((i-r)*(i-r)+(o-n)*(o-n));c[d]=s,f+=s,u[6*d+0]=r,u[6*d+1]=n,u[6*d+2]=_-(a-n)/s*e,u[6*d+3]=a+(_-r)/s*e,u[6*d+4]=_+(a-n)/s*e,u[6*d+5]=a-(_-r)/s*e}h(u),f-=c[0]/2+c[r-1]/2;var E=-c[0]/2;for(d=1;d<r;d++)l[6*d+0]=n+_*E/f,l[6*d+1]=o+a/2,E+=c[d]/2,l[6*d+2]=n+_*E/f,l[6*d+3]=o,l[6*d+4]=n+_*E/f,l[6*d+5]=o+a,E+=c[d]/2;for(d=0;d<r-1;d++)p[2*d+0]=3*d+1,p[2*d+1]=3*d+3;p[2*r-3]--;const y=i.gl,A=y.createBuffer(),b=i.shader.attribute.coord;y.bindBuffer(y.ARRAY_BUFFER,A),y.bufferData(y.ARRAY_BUFFER,u,y.STATIC_DRAW),y.vertexAttribPointer(b,2,y.FLOAT,!1,0,0),y.enableVertexAttribArray(b);const T=y.createBuffer(),m=i.shader.attribute.tex;y.bindBuffer(y.ARRAY_BUFFER,T),y.bufferData(y.ARRAY_BUFFER,l,y.STATIC_DRAW),y.vertexAttribPointer(m,2,y.FLOAT,!1,0,0),y.enableVertexAttribArray(m),y.activeTexture(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,s),y.uniform1i(i.shader.uniform.uSampler,0);const R=y.createBuffer();for(y.bindBuffer(y.ELEMENT_ARRAY_BUFFER,R),y.bufferData(y.ELEMENT_ARRAY_BUFFER,p,y.STATIC_DRAW),y.drawElements(y.TRIANGLE_STRIP,2*r-2,y.UNSIGNED_SHORT,0),d=0;d<r-1;d++)p[2*d+0]=3*d,p[2*d+1]=3*d+2;p[0]++,y.bufferData(y.ELEMENT_ARRAY_BUFFER,p,y.STATIC_DRAW),y.drawElements(y.TRIANGLE_STRIP,2*r-2,y.UNSIGNED_SHORT,0)}window.debug_info={},window.debug_info.global_gl=i,window.debug_info.gl_func={setup:o,clear:u,draw:a,drawStrip:function(t,e,r,n,o){const _=i.gl,a=_.createBuffer(),s=i.shader.attribute.coord;_.bindBuffer(_.ARRAY_BUFFER,a),_.bufferData(_.ARRAY_BUFFER,t,_.STATIC_DRAW),_.vertexAttribPointer(s,2,_.FLOAT,!1,0,0),_.enableVertexAttribArray(s);const u=_.createBuffer(),c=i.shader.attribute.tex;_.bindBuffer(_.ARRAY_BUFFER,u),_.bufferData(_.ARRAY_BUFFER,e,_.STATIC_DRAW),_.vertexAttribPointer(c,2,_.FLOAT,!1,0,0),_.enableVertexAttribArray(c);const l=_.createBuffer();_.bindBuffer(_.ELEMENT_ARRAY_BUFFER,l),_.bufferData(_.ELEMENT_ARRAY_BUFFER,r,_.STATIC_DRAW),_.activeTexture(_.TEXTURE0),_.bindTexture(_.TEXTURE_2D,n),_.uniform1i(i.shader.uniform.uSampler,0),_.drawElements(_.TRIANGLE_STRIP,o,_.UNSIGNED_SHORT,0)},drawRects:f,drawSnake:d}}},__webpack_module_cache__={};function __webpack_require__(t){if(__webpack_module_cache__[t])return __webpack_module_cache__[t].exports;var e=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](e,e.exports,__webpack_require__),e.exports}__webpack_require__.d=(t,e)=>{for(var r in e)__webpack_require__.o(e,r)&&!__webpack_require__.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t={};__webpack_require__.r(t),__webpack_require__.d(t,{KEY_CLICK:()=>O,KEY_PRESS:()=>M,canvas_height:()=>h,canvas_width:()=>p,devicePixelRatio:()=>y,keys:()=>R,last_update_rate:()=>A,mainloop_start:()=>P,mainloop_terminate:()=>w,mouse:()=>m,setup_canvas:()=>v,test_fps:()=>b});var e=__webpack_require__(176),r=__webpack_require__(924),n=__webpack_require__(822),i=__webpack_require__(533),o=__webpack_require__(349),_=!1,a=!1,s=0,u=0,c=0,l=0;var p,h,f=0,d=0,E=null,y=1,A=1;function b(){return f=performance.now(),d=241,T(),new Promise(((t,e)=>{E=t}))}function T(){if(--d)requestAnimationFrame(T);else{var t=(performance.now()-f)/240;A=Math.round(t/(1e3/60)),E(A)}}var m={x:0,y:0},R={};function v(){document.onmousemove=t=>{m.x=t.pageX,m.y=t.pageY},document.ontouchstart=t=>{R._touch=3,m.x=t.pageX,m.y=t.pageY,t.preventDefault()},document.ontouchend=t=>{R._touch=1,m.x=t.pageX,m.y=t.pageY,t.preventDefault()},document.ontouchmove=t=>{m.x=t.pageX,m.y=t.pageY,t.preventDefault()},document.onmousedown=t=>{R._press=3},document.onmouseup=t=>{R._press=1},document.addEventListener("keydown",(t=>{var e=t.key;1==e.length&&(e=e.toLowerCase()),R[e]=3}),!1),document.addEventListener("keyup",(t=>{var e=t.key;1==e.length&&(e=e.toLowerCase()),R[e]=1}),!1);var t=window.innerWidth,e=window.innerHeight,n=.95*Math.min(t/o.Fy,e/o.bE),i=document.getElementById("glcanvas");p=n*o.Fy,h=n*o.bE,i.style.width=p+"px",i.style.height=h+"px",y=window.devicePixelRatio||1,i.width=p*y,i.height=h*y,r.cY()}var g=!1;function P(){g||(g=!0,D())}function w(){g=!1}function D(){!function(){var t=n.n.INSTANCE;if(t){var e=function(){if(R.Escape==O&&(_=!_),_)return a=!1,null;var t=0,e=0;R.Shift>=M||R._touch>=M||R._press>=M?(a||(a=!0,s=m.x,u=m.y,c=0,l=0),t=m.x-s-c,e=m.y-u-l,c+=t,l+=e):a=!1,t=t/p*o.Fy*2,e=-e/h*o.bE*2;var r=R.Shift>=M?2:3;return(R.w>=M||R.ArrowUp>=M)&&(e+=r),(R.s>=M||R.ArrowDown>=M)&&(e-=r),(R.a>=M||R.ArrowLeft>=M)&&(t-=r),(R.d>=M||R.ArrowRight>=M)&&(t+=r),{pos_x:t,pos_y:e,key_z:R.z>=M,key_x:R.x==O,key_c:R.c==O}}();if(!_&&(i.U.updateState(e),!_))for(var f=0;f<A;f++)t.update();r.ZH(),t.render()}}(),function(){for(var t in R)3==R[t]&&(R[t]=2),1==R[t]&&(R[t]=0)}(),g&&requestAnimationFrame(D)}const M=2,O=3;window.onload=async function(){b(),v(),await e.S(),P(),window.debug_info.stg={fps:b,init:e.S,start:P,terminate:w},window.debug_info.platform=t}})()})();