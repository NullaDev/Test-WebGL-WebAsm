(()=>{var __webpack_modules__={349:(t,e,r)=>{"use strict";r.d(e,{SH:()=>n,ZP:()=>i,Fy:()=>o,bE:()=>a,OK:()=>s,ZA:()=>u,io:()=>_,ax:()=>p});var n=192,i=224,o=360,a=240;function s(t){return t/o}function u(t){return t/a}var c=1/64;function _(t){t.rect([-n,-i,2*n,2*i],c)}function p(t){var e=function(e){return t.rect(e,c)};e([-n,a-16,2*n,16]),e([-n,-a,2*n,16]),e([-o,-a,o-n,2*a]),e([n,-a,o-n,2*a])}},780:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{l:()=>GLHelper});var _gl__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(924),_Screen__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(349),__spreadArrays=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)n[i]=o[a];return n},GLHelper=function(){function GLHelper(){this.ver=[],this.tex=[],this.alp=[],this.n=0}return GLHelper.prototype.bind=function(t){this.img=t},GLHelper.prototype.rect=function(t,e){var r,n,i=t[0],o=t[1],a=t[2],s=t[3],u=[i,o,i,o+s,i+a,o,i,o+s,i+a,o,i+a,o+s];(r=this.ver).push.apply(r,u),(n=this.tex).push.apply(n,u.map((function(t){return t*e}))),this.alp.push(1,1,1,1,1,1),this.n+=6},GLHelper.prototype.fan=function(_a,n){for(var _b,_c,da=_a[0],oa=_a[1],ox=_a[2],oy=_a[3],or=_a[4],ta=_a[5],tx=_a[6],ty=_a[7],trw=_a[8],trh=_a[9],alpha=_a[10],num=Math.ceil(Math.abs(da)/(2*Math.PI)*n),f0=function(t,e,r,n,i){return[t+r*Math.cos(i),e+n*Math.sin(i)]},f1=function(t,e,r,n,i,o){return __spreadArrays(f0(t,e,0,0,0),f0(t,e,r,n,i),f0(t,e,r,n,o))},i=0;i<num;i++)(_b=this.ver).push.apply(_b,f1(ox,oy,or,or,oa+da/num*i,oa+da/num*(i+1))),(_c=this.tex).push.apply(_c,f1(tx,ty,trw,trh,ta+da/num*i,ta+da/num*(i+1))),this.alp.push(alpha,alpha,alpha);this.n+=3*num,eval("window.debug_info.fver = this.ver")},GLHelper.prototype.flush=function(){for(var t=new Float32Array(this.ver),e=0;e<t.length;e+=2)t[e]=(0,_Screen__WEBPACK_IMPORTED_MODULE_1__.OK)(t[e]),t[e+1]=(0,_Screen__WEBPACK_IMPORTED_MODULE_1__.ZA)(t[e+1]);_gl__WEBPACK_IMPORTED_MODULE_0__.draw(t,new Float32Array(this.tex),new Float32Array(this.alp),this.img,this.n),this.ver=[],this.tex=[],this.alp=[],this.n=0},GLHelper}()},642:(t,e,r)=>{"use strict";r.d(e,{Q:()=>p});var n=r(924),i=r(780),o=r(940),a=r(583),s=r(68),u=r(869),c=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)n[i]=o[a];return n},_=a.xg(o.cI,1),p=function(){function t(t){this.special_duration=t,this.special_remain=0}return t.prototype.updateEnable=function(t,e){return this.special_remain>0&&this.update(),!(this.special_remain>0||!(e&&t.ability_count>0)||(t.ability_count--,this.special_remain=this.special_duration,this.onActivate(),1))},t.prototype.render=function(t,e){if(t==u.t4+50){var r=new i.l;n.setMode(0);var o=_.sprite,a=[(o.tx+o.tw/2)/o.sprite.w,(o.ty+o.th/2)/o.sprite.h,o.tw/2/o.sprite.w,o.th/2/o.sprite.h];if(r.bind(s.Z.get(o.sprite.path).img),0==this.special_remain){var p=2*Math.PI*e.ability_count/(e.ability.max_ability+1),h=2*Math.PI*(e.graze_current/e.ability.max_graze)/(e.ability.max_ability+1),l=e.post_grazed?.7:.5,f=e.graze_current==e.ability.max_graze?l:e.post_grazed?.7:.2;r.fan(c([p,Math.PI/2,e.px,e.py,_.w/2,Math.PI/6],a,[l]),32),r.fan(c([h,Math.PI/2+p,e.px,e.py,_.w/2,Math.PI/6+p],a,[f]),32)}else p=2*Math.PI*this.special_remain/this.special_duration,r.fan(c([p,-p+Math.PI/2,e.px,e.py,_.w/2,-p+Math.PI/6],a,[1]),32);r.flush()}},t.prototype.layers=function(){return[u.t4+50]},t}()},516:(t,e,r)=>{"use strict";r.d(e,{n:()=>s});var n,i=r(822),o=r(642),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=function(t){function e(){return t.call(this,120)||this}return a(e,t),e.prototype.update=function(){i.n.INSTANCE.special_effects.time_slowdown(.5),this.special_remain-=i.n.INSTANCE.special_effects.time_rate},e.prototype.onActivate=function(){},e}(o.Q)},293:(t,e,r)=>{"use strict";r.d(e,{U:()=>s});var n,i=r(822),o=r(642),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=function(t){function e(){return t.call(this,120)||this}return a(e,t),e.prototype.update=function(){i.n.INSTANCE.special_effects.time_slowdown(0),this.special_remain--},e.prototype.onActivate=function(){},e}(o.Q)},413:(t,e,r)=>{"use strict";r.d(e,{r:()=>o,i:()=>a});var n=r(822),i=r(334),o=function(t,e){return void 0===e&&(e=1/0),function(){return new i.hP(t,e)}},a=function(t){return function(){return n.n.INSTANCE.add(new i.b2(t))}}},555:(t,e,r)=>{"use strict";r.d(e,{z:()=>c});var n=r(651),i=r(334),o=r(940),a=r(583),s=r(822),u=r(413),c={name:"波与粒的境界",default_scale:3,init:function(t){var e=o.hZ(5,1,0),r=a.xg(e,1);return new i.b2([30*t,(0,u.r)((function(e){return[(0,u.r)((function(i){return[function(){return s.n.INSTANCE.add(new n.uQ(r,n.R0).simpleInit(0,0,8/t,.003/t*e*e+2*Math.PI/5*i))}]}),5),1*t]}),1/0)])}}},121:(t,e,r)=>{"use strict";r.d(e,{N:()=>_});var n=r(651),i=r(334),o=r(940),a=r(583),s=r(822),u=r(869),c=r(413),_={name:"龙纹弹",default_scale:3,init:function(t){var e=function(t){return a.xg(o.e8(1,t,0),1)},r=(0,u.d9)(n.R0);r.life=180*t,r.kill_on_exit=!1;var _={duration:100*t,px0:-96,px1:96,py0:32,py1:112,dx1:64,dy1:64,ease:function(t){return(1-Math.cos(Math.PI*t))/2}},p=1*t,h=3/t,l=-h/70,f=.06/t,d=new n.uQ(a.xg(o.cI,2),n.R0).setMotion((function(t){return t.dir=t.time*Math.PI*2/600,!1})).simpleInit(0,64,0,0),y=null,v=function(t,e,o,a){return s.n.INSTANCE.add(new i.b2([(0,c.r)((function(i){return[function(){return s.n.INSTANCE.add(y=new n.uQ(null,r).simpleInit(d.px,d.py,h,2*Math.PI/47*i*e*t))},(0,c.r)((function(e){return[function(){return s.n.INSTANCE.add(new n.uQ(i%2==0?o:a,n.R0).setMotion((r=y,u=2*Math.PI/30*e,c=f*t,70,_=l,function(t,e){var n=u+c*t.time,i=70*Math.sin(_*t.time);return t.px=r.px+i*Math.cos(n),t.py=r.py+i*Math.sin(n),t.dir=Math.atan2(i*c,70*_*Math.cos(_*t.time))+n,!1})));var r,u,c,_}]}),30),p]}),47)]))};return new i.b2([function(){return s.n.INSTANCE.add(d)},30*t,(0,c.r)((function(r){return[function(){return v(r%2*2-1,7,e(2),e(10))},50*t,function(){return v(r%2*2-1,5,e(13),e(6))},50*t,function(){return v(r%2*2-1,1,e(8),e(4))},i.FX.random(d,_)]}))])}}},285:(t,e,r)=>{"use strict";r.d(e,{t:()=>_});var n=r(651),i=r(334),o=r(940),a=r(583),s=r(822),u=r(869),c=r(413),_={name:"rotating long bullet",default_scale:3,init:function(t){var e=a.p3(2,0,64),r=(0,u.d9)(n.R0);r.auto_direction=!1;var _={duration:50*t,px0:-96,px1:96,py0:32,py1:112,dx1:64,dy1:64,ease:function(t){return(1-Math.cos(Math.PI*t))/2}},p=new n.uQ(a.xg(o.cI,2),n.R0).setMotion((function(t){return t.dir=t.time*Math.PI*2/600,!1})).simpleInit(0,64,0,0),h=function(t){return(0,c.r)((function(i){return[function(){return s.n.INSTANCE.add(new n.uQ(e,r).setMotion((function(e,r){return e.dir+=r*t,!0})).simpleInit(p.px,p.py,y,v+2*Math.PI/l*i).init((function(t){return t.dir+=2*Math.PI*f/l*i})))}]}),l)},l=50,f=2.5,d=2*Math.PI/60/t,y=6/t,v=0;return new i.b2([function(){return s.n.INSTANCE.add(p)},30*t,(0,c.r)((function(e){return[function(){return v=Math.random()*Math.PI*2},h(d),20*t,h(-d),i.FX.random(p,_)]}))])}}},265:(t,e,r)=>{"use strict";r.d(e,{c:()=>p});var n=r(651),i=r(334),o=r(940),a=r(583),s=r(822),u=r(869),c=r(799),_=r(413),p={name:"reflect and delayed altering",default_scale:3,init:function(t){var e=a.xg(o.e8(4,2,0),1),r=(0,u.d9)(n.R0);r.listener=(0,c.Fe)();var p=(0,u.d9)(c.wv);p.max=100,(0,c.cf)(p)(r.listener);var h=Math.PI/24,l=6/t,f=100*t,d=1*t,y=1*t,v={duration:f-40*y-20*d,px0:-96,px1:96,py0:32,py1:112,dx1:64,dy1:64,ease:function(t){return(1-Math.cos(Math.PI*t))/2}},m=new n.uQ(a.xg(o.cI,2),n.R0).setMotion((function(t){return t.dir=t.time*Math.PI*2/600,!1})).simpleInit(0,64,0,0),w=0;return new i.b2([function(){return s.n.INSTANCE.add(m)},30*t,(0,_.r)((function(t){return[function(){return w=Math.random()*Math.PI*2},(0,_.r)((function(t){return[(0,_.i)([(0,_.r)((function(){return[function(){return s.n.INSTANCE.add(new n.uQ(e,r).setMotion((function(e,r){var n=f-t*y;return e.time-r<n&&e.time>=n&&((0,c.DP)(p)(e),e.simpleInit(e.px,e.py,l,e.dir+(2*Math.random()-1)*h)),!0})).simpleInit(m.px,m.py,l,w+2*Math.PI/40*t))},d]}),20)]),y]}),40),20*d,i.FX.random(m,v)]}))])}}},415:(t,e,r)=>{"use strict";r.d(e,{$:()=>p});var n=r(651),i=r(334),o=r(940),a=r(583),s=r(822),u=r(869),c=r(799),_=r(413),p={name:"finite reflect",default_scale:3,init:function(t){var e=[a.xg(o.e8(4,2,0),1),a.xg(o.e8(4,6,0),1)],r=(0,u.d9)(n.R0),p=(0,u.d9)(n.R0);r.listener=(0,c.Fe)(),p.listener=(0,c.Fe)();var h=(0,u.d9)(c.wv),l=(0,u.d9)(c.wv);h.max=2,h.h0=-1/0,l.max=1,l.h0=-1/0,(0,c.cf)(h)(r.listener),(0,c.cf)(l)(p.listener);var f=6/t,d=1*t,y=3*t,v={duration:40*t,px0:-96,px1:96,py0:32,py1:112,dx1:64,dy1:64,ease:function(t){return(1-Math.cos(Math.PI*t))/2}},m=new n.uQ(a.xg(o.cI,2),n.R0).setMotion((function(t){return t.dir=t.time*Math.PI*2/600,!1})).simpleInit(0,64,0,0),w=0,b=function(t,e,r,i){return(0,_.r)((function(o){return[(0,_.i)([(0,_.r)((function(a){return[(0,_.r)((function(u){return[function(){return s.n.INSTANCE.add(new n.uQ(t,i).simpleInit(m.px,m.py,f,w+r*Math.PI*2*(o/8/4+u/4+a/4/8/e*.5)))}]}),8),d]}),e)]),y]}),8)};return new i.b2([function(){return s.n.INSTANCE.add(m)},30*t,(0,_.r)((function(t){return[function(){return w=Math.random()*Math.PI*2},b(e[0],10,1,r),10*d,i.FX.random(m,v),b(e[1],15,-1,p),20*d,i.FX.random(m,v)]}))])}}},950:(t,e,r)=>{"use strict";r.d(e,{c:()=>p});var n=r(651),i=r(334),o=r(583),a=r(822),s=r(869),u=r(296),c=r(799),_=r(413),p={name:"reflect laser",default_scale:3,init:function(t){var e=function(e,r){var i=o.iW(4,e,r,1,1,1,.75),a={render_layer:n.R0.render_layer,collide_group:n.R0.collide_group,collide_mask:n.R0.collide_mask,warning_time:0,open_time:0,alive_time:1/0,close_time:0,listener:null},u=(0,s.d9)(a);a.listener=(0,c.VN)();var _=(0,s.d9)(c.zA);return _.max=2,_.v=8/t,_.maxlen=128,_.body=i,_.cf=u,_.name=e+"-"+r,(0,c.so)(_)(a.listener),[i,a,_]},r=[e(6,3),e(2,1)],p=2*Math.PI/t,h=t,l=function(t,e,n,i,o,s){return(0,_.r)((function(t){return[(0,_.r)((function(o){return[function(){return a.n.INSTANCE.add(new u.Fu(r[e][0],r[e][1],null).init(0,0,s+2*Math.PI/n*o+i*t,0))}]}),n),o]}),t)};return new i.b2([30*t,(0,_.r)((function(e){return[l(20,0,3,(e%2*2-1)*p*.0678,6*h,2*Math.random()*Math.PI),100*t,l(120,1,1,(e%2*2-1)*p*.0234,h,2*Math.random()*Math.PI),100*t]}))])}}},93:(t,e,r)=>{"use strict";r.d(e,{W:()=>c});var n=r(651),i=r(334),o=r(583),a=r(822),s=r(296),u=r(413),c={name:"RayLaser Hitbox Test",default_scale:3,init:function(t){var e=function(t,e,r){return o.iW(t,2,1,1,e,r,1)},r=[e(0,0,0),e(0,1,1),e(0,0,1),e(0,1,0),e(4,0,0),e(4,1,1),e(4,0,1),e(4,1,0),e(1,0,0),e(1,1,0)],c={render_layer:n.R0.render_layer,collide_group:n.R0.collide_group,collide_mask:n.R0.collide_mask,warning_time:30*t,open_time:10*t,alive_time:6e3*t,close_time:10*t,listener:null},_=0*Math.PI*2/240/t;return new i.b2([30*t,(0,u.r)((function(e){return[(0,u.r)((function(t){return[function(){return a.n.INSTANCE.add(new s.Fu(r[t],c,(n=_*(e%2*2-1),function(t,e){return t.dir+=e*n})).init(50*Math.cos(2*Math.PI/10*t),50*Math.sin(2*Math.PI/10*t),2*Math.PI/10*t,100));var n}]}),10),6e3*t]}))])}}},799:(t,e,r)=>{"use strict";r.d(e,{Fe:()=>a,VN:()=>s,wv:()=>u,cf:()=>c,DP:()=>_,zA:()=>p,so:()=>h});var n=r(349),i=r(822),o=r(296),a=function(){return{onInit:[],onUpdate:[],onPostMotion:[],onPostUpdate:[],onAttack:[],onDestroy:[],onExitScreen:[],onKill:[]}},s=function(){return{onInit:[],onUpdate:[],onPostMotion:[],onStateChange:[],onPostUpdate:[],onAttack:[],onContact:[],onDestroy:[]}},u={w0:-n.SH,w1:n.SH,h0:-n.ZP,h1:n.ZP,max:1/0,inner_bound:!0,outer_bound:!1},c=function(t){return function(e){e.onInit.push((function(e){var r=e.custom_fields;r.in_screen=e.px>t.w0&&e.px<t.w1&&e.py>t.h0&&e.py<t.h1,r.ref_count=0})),e.onPostMotion.push((function(e,r){var n=e.custom_fields,i=n.in_screen;n.in_screen=e.px>t.w0&&e.px<t.w1&&e.py>t.h0&&e.py<t.h1,i&&!n.in_screen&&t.inner_bound&&(n.ref_count<t.max&&e.px<=t.w0&&(n.ref_count++,e.vx=-e.vx,e.px=2*t.w0-e.px),n.ref_count<t.max&&e.px>=t.w1&&(n.ref_count++,e.vx=-e.vx,e.px=2*t.w1-e.px),n.ref_count<t.max&&e.py<=t.h0&&(n.ref_count++,e.vy=-e.vy,e.py=2*t.h0-e.py),n.ref_count<t.max&&e.py>=t.h1&&(n.ref_count++,e.vy=-e.vy,e.py=2*t.h1-e.py),e.dir=Math.atan2(e.vy,e.vx),n.in_screen=!0),!i&&n.in_screen&&t.outer_bound&&(n.ref_count<t.max&&e.px>=t.w0&&(n.ref_count++,e.vx=-e.vx,e.px=2*t.w0-e.px),n.ref_count<t.max&&e.px<=t.w1&&(n.ref_count++,e.vx=-e.vx,e.px=2*t.w1-e.px),n.ref_count<t.max&&e.py>=t.h0&&(n.ref_count++,e.vy=-e.vy,e.py=2*t.h0-e.py),n.ref_count<t.max&&e.py<=t.h1&&(n.ref_count++,e.vy=-e.vy,e.py=2*t.h1-e.py),e.dir=Math.atan2(e.vy,e.vx),n.in_screen=!1)}))}},_=function(t){return function(e){return e.custom_fields.ref_count=t.max}},p={name:"",w0:-n.SH,w1:n.SH,h0:-n.ZP,h1:n.ZP,max:1/0,maxlen:NaN,v:NaN,body:null,cf:null},h=function(t){return function(e){var r=function(e,r){var i=e.custom_fields;if(i.togrow>0){var o=Math.min(i.togrow,t.v*r);r-=o/t.v,e.len+=o,i.togrow-=o}r>0&&(e.px+=r*i.vx,e.py+=r*i.vy),e.shaped_sprite.end.shape.rawExitScreen(e.px+e.len*Math.cos(e.dir),e.py+e.len*Math.sin(e.dir),e.shaped_sprite.base,n.SH,n.ZP)&&e.shaped_sprite.base.shape.rawExitScreen(e.px,e.py,e.shaped_sprite.base,n.SH,n.ZP)&&(e.state=3)},a=function(e,r){return e>t.w0&&e<t.w1&&r>t.h0&&r<t.h1},s=function(e,r){var i=e.custom_fields;if(i.toshrink>0){var o=Math.min(i.toshrink,t.v*r);e.len-=o,i.toshrink-=o,i.toshrink<=0&&(e.state=3)}i.togrow>0&&(r-=(o=Math.min(i.togrow,t.v*r))/t.v,e.len+=o,i.togrow-=o),r>0&&(e.px+=r*i.vx,e.py+=r*i.vy),e.shaped_sprite.base.shape.rawExitScreen(e.px,e.py,e.shaped_sprite.base,n.SH,n.ZP)&&(e.state=3)};e.onInit.push((function(e){var n=e.custom_fields;n.ref_count=0,n.vx=t.v*Math.cos(e.dir),n.vy=t.v*Math.sin(e.dir),n.togrow=t.maxlen,n.toshrink=0,e.motion=r})),e.onPostMotion.push((function(e,r){var n=e.custom_fields,u=(a(e.px,e.py),e.px+e.len*Math.cos(e.dir)),c=e.py+e.len*Math.sin(e.dir);if(!a(u,c)&&n.ref_count<t.max){var _=new o.Fu(t.body,t.cf,s);_.init(e.px,e.py,e.dir,e.len);var p=_.custom_fields;p.vx=n.vx,p.vy=n.vy,p.togrow=n.togrow,i.n.INSTANCE.add(_);var h=0,l=0;n.ref_count<t.max&&u<=t.w0&&(h=t.w0,l=e.py+(t.w0-e.px)*n.vy/n.vx,n.ref_count++,n.vx=-n.vx,e.px=2*t.w0-e.px),n.ref_count<t.max&&u>=t.w1&&(h=t.w1,l=e.py+(t.w1-e.px)*n.vy/n.vx,n.ref_count++,n.vx=-n.vx,e.px=2*t.w1-e.px),n.ref_count<t.max&&c<=t.h0&&(l=t.h0,h=e.px+(t.h0-e.py)*n.vx/n.vy,n.ref_count++,n.vy=-n.vy,e.py=2*t.h0-e.py),n.ref_count<t.max&&c>=t.h1&&(l=t.h1,h=e.px+(t.h1-e.py)*n.vx/n.vy,n.ref_count++,n.vy=-n.vy,e.py=2*t.h1-e.py);var f=Math.sqrt(Math.pow(e.px-h,2)+Math.pow(e.py-l,2));e.len-=f,e.px=h,e.py=l,n.togrow+=f,_.len=f,p.toshrink=f+p.togrow,e.dir=Math.atan2(n.vy,n.vx)}}))}}},869:(t,e,r)=>{"use strict";r.d(e,{T:()=>n,ZE:()=>i,yR:()=>o,A4:()=>a,t_:()=>s,T7:()=>u,KZ:()=>c,DV:()=>_,P4:()=>p,k8:()=>h,Gs:()=>l,Io:()=>f,NH:()=>d,t4:()=>y,bm:()=>v,$7:()=>m,d9:()=>w,S:()=>b});var n=0,i=1,o=2,a=3,s=4,u=5,c=0,_=1,p=1,h=1,l=14,f=0,d=0,y=100,v=500,m=700;function w(t){return Object.assign({},t)}var b={render_layer:m,collide_group:n,collide_mask:c}},651:(t,e,r)=>{"use strict";r.d(e,{R0:()=>c,uQ:()=>p});var n,i=r(869),o=r(822),a=r(349),s=r(566),u=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),c={render_layer:i.bm,collide_group:i.A4,collide_mask:i.A4,kill_on_exit:!0,kill_by:function(t){return t==i.t_||t==i.T},auto_direction:!0,life:0,listener:null},_=function(t,e){return!0},p=function(t){function e(e,r){var n=t.call(this,e)||this;return n.state=0,n.motion=_,n.custom_fields={},n.config=r,n.time=0,n}return u(e,t),e.prototype.setMotion=function(t){return this.motion=t,this.simpleInit(0,0,0,0)},e.prototype.simpleInit=function(t,e,r,n){return this.px=t,this.py=e,this.vx=r*Math.cos(n),this.vy=r*Math.sin(n),this.dir=n,this.motion(this,0)&&this.config.auto_direction&&(this.dir=Math.atan2(this.vy,this.vx)),this},e.prototype.init=function(t){return t(this),this},e.prototype.update=function(t){var e,r,n,i,a,s,u,c,_=this;0==this.state&&(this.state=1,null===(r=null===(e=this.config.listener)||void 0===e?void 0:e.onInit)||void 0===r||r.forEach((function(t){return t(_)})));var p=o.n.INSTANCE.special_effects.time_rate;this.time+=p,null===(i=null===(n=this.config.listener)||void 0===n?void 0:n.onUpdate)||void 0===i||i.forEach((function(t){return t(_,p)})),this.motion(this,p)&&(this.px+=this.vx*p,this.py+=this.vy*p,this.config.auto_direction&&(this.dir=Math.atan2(this.vy,this.vx))),(null===(s=null===(a=this.shaped_sprite)||void 0===a?void 0:a.sprite)||void 0===s?void 0:s.omega)&&(this.dir=this.time*this.shaped_sprite.sprite.omega),null===(c=null===(u=this.config.listener)||void 0===u?void 0:u.onPostMotion)||void 0===c||c.forEach((function(t){return t(_,p)}))},e.prototype.postUpdate=function(t){var e,r,n,i,o,s,u,c,_=this;(null===(r=null===(e=this.shaped_sprite)||void 0===e?void 0:e.shape)||void 0===r?void 0:r.exitScreen(this,a.SH,a.ZP))&&(this.config.kill_on_exit&&(this.state=2),null===(i=null===(n=this.config.listener)||void 0===n?void 0:n.onExitScreen)||void 0===i||i.forEach((function(t){return t(_)}))),this.config.life&&this.time>=this.config.life&&(this.state=2),null===(s=null===(o=this.config.listener)||void 0===o?void 0:o.onPostUpdate)||void 0===s||s.forEach((function(t){return t(_)})),2==this.state&&(null===(c=null===(u=this.config.listener)||void 0===u?void 0:u.onDestroy)||void 0===c||c.forEach((function(t){return t(_)})),this.state=3)},e.prototype.attack=function(t,e){var r,n,i=this;null===(n=null===(r=this.config.listener)||void 0===r?void 0:r.onAttack)||void 0===n||n.forEach((function(t){return t(i,e)})),e.damaged(e,this)},e.prototype.damaged=function(t,e){var r,n,i=this;return!!this.config.kill_by(e.config.collide_group)&&(this.state=2,null===(n=null===(r=this.config.listener)||void 0===r?void 0:r.onKill)||void 0===n||n.forEach((function(t){return t(i,e)})),!0)},e}(s.eY)},296:(t,e,r)=>{"use strict";r.d(e,{cE:()=>u,Fu:()=>c});var n,i,o=r(566),a=r(822),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),u=function(t){function e(e){var r=t.call(this)||this;return r.func=e,r}return s(e,t),e.prototype.distanceTo=function(t,e,r){return Math.min(this.func(t,e,r),t.shaped_sprite.base.shape.rawDistanceTo(t.px,t.py,1,e,r),t.shaped_sprite.end.shape.rawDistanceTo(t.px+t.len*Math.cos(t.dir),t.py+t.len*Math.sin(t.dir),1,e,r))},e.line_circle=function(t,e,r){var n=t.px+t.shaped_sprite.hitbox_width*Math.cos(t.dir),i=t.py+t.shaped_sprite.hitbox_width*Math.sin(t.dir),o=t.px+(t.len-t.shaped_sprite.hitbox_width)*Math.cos(t.dir),a=t.py+(t.len-t.shaped_sprite.hitbox_width)*Math.sin(t.dir),s=Math.sqrt(Math.pow(n-o,2)+Math.pow(i-a,2)),u=Math.abs((o-n)*(i-r)-(n-e)*(a-i)),c=Math.sqrt(Math.pow(n-e,2)+Math.pow(i-r,2)),_=Math.sqrt(Math.pow(o-e,2)+Math.pow(a-r,2));return Math.pow(Math.max(c,_),2)>Math.pow(Math.min(c,_),2)+Math.pow(s,2)?Math.min(c,_)-t.shaped_sprite.hitbox_width*t.w:Math.min(u/s,c,_)-t.shaped_sprite.hitbox_width*t.w},e.double_arc=function(t,e,r){var n=e-t.px,i=r-t.py,a=n*Math.cos(-t.dir)-i*Math.sin(-t.dir),s=n*Math.sin(-t.dir)+i*Math.cos(-t.dir);return o.HC.orthDis(a-t.len/2,s,t.len/2,t.w*t.shaped_sprite.hitbox_width)},e.half_arc=function(t,e,r){var n=e-t.px,i=r-t.py,a=n*Math.cos(-t.dir)-i*Math.sin(-t.dir),s=n*Math.sin(-t.dir)+i*Math.cos(-t.dir);return a<0?Math.sqrt(Math.pow(a,2)+Math.pow(s,2)):o.HC.orthDis(a,s,t.len,t.w*t.shaped_sprite.hitbox_width)},e}(o.bn),c=(i=o.Yw,s((function(){return null!==i&&i.apply(this,arguments)||this}),i),function(t){function e(e,r,n){var i=t.call(this,e)||this;return i.state=0,i.rstate=0,i.time=0,i.custom_fields={},i.config=r,i.motion=n,i}return s(e,t),e.prototype.init=function(t,e,r,n){return this.len=n,this.dir=r,this.px=t,this.py=e,this.checkState(),this},e.prototype.checkState=function(){var t,e,r,n,i,o,a,s,u,c,_=this;0==this.state&&(this.state=2,null===(e=null===(t=this.config.listener)||void 0===t?void 0:t.onInit)||void 0===e||e.forEach((function(t){return t(_)})));var p=this.config.warning_time,h=this.config.open_time+p,l=this.config.alive_time+h,f=this.config.close_time+l;0==this.rstate&&this.time>=p&&(this.rstate=1,null===(n=null===(r=this.config.listener)||void 0===r?void 0:r.onStateChange)||void 0===n||n.forEach((function(t){return t(_)}))),1==this.rstate&&(this.w=Math.min(1,(this.time-p)/(h-p)),this.time>=h&&(this.rstate=2,this.state=1,this.w=1,null===(o=null===(i=this.config.listener)||void 0===i?void 0:i.onStateChange)||void 0===o||o.forEach((function(t){return t(_)})))),2==this.rstate&&this.time>=l&&(this.rstate=3,this.state=2,null===(s=null===(a=this.config.listener)||void 0===a?void 0:a.onStateChange)||void 0===s||s.forEach((function(t){return t(_)}))),3==this.rstate&&(this.w=Math.max(0,1-(this.time-l)/(f-l)),this.time>=f&&(this.state=3,null===(c=null===(u=this.config.listener)||void 0===u?void 0:u.onDestroy)||void 0===c||c.forEach((function(t){return t(_)}))))},e.prototype.update=function(t){var e,r,n,i,o,s,u=this;0==this.state&&(this.state=2,null===(r=null===(e=this.config.listener)||void 0===e?void 0:e.onInit)||void 0===r||r.forEach((function(t){return t(u)})));var c=a.n.INSTANCE.special_effects.time_rate;this.time+=c,this.checkState(),null===(i=null===(n=this.config.listener)||void 0===n?void 0:n.onUpdate)||void 0===i||i.forEach((function(t){return t(u,c)})),this.motion(this,c),null===(s=null===(o=this.config.listener)||void 0===o?void 0:o.onPostMotion)||void 0===s||s.forEach((function(t){return t(u,c)}))},e.prototype.postUpdate=function(t){var e,r,n=this;null===(r=null===(e=this.config.listener)||void 0===e?void 0:e.onPostUpdate)||void 0===r||r.forEach((function(t){return t(n)}))},e.prototype.attack=function(t,e){var r,n,i=this;null===(n=null===(r=this.config.listener)||void 0===r?void 0:r.onAttack)||void 0===n||n.forEach((function(t){return t(i,e)})),e.damaged(e,this)},e.prototype.damaged=function(t,e){var r,n,i=this;return null===(n=null===(r=this.config.listener)||void 0===r?void 0:r.onContact)||void 0===n||n.forEach((function(t){return t(i,e)})),!1},e}(function(t){function e(e){var r=t.call(this,0,e)||this;return r.w=0,r}return s(e,t),e.prototype.rectCount=function(){return 3},e.prototype.render=function(t,e){var r=this.shaped_sprite.l_ratio*this.len/2;t[10*e+0]=this.px+r*Math.cos(this.dir),t[10*e+1]=this.py+r*Math.sin(this.dir),t[10*e+2]=this.dir+Math.PI/2,t[10*e+3]=Math.max(1,this.shaped_sprite.sprite_width*this.w),t[10*e+4]=r;var n=this.shaped_sprite.sprite;t[10*e+5]=n.tx/n.sprite.w,t[10*e+6]=n.ty/n.sprite.h,t[10*e+7]=n.tw/n.sprite.w,t[10*e+8]=n.th/n.sprite.h,t[10*e+9]=1,e++;var i=this.shaped_sprite.base;t[10*e+0]=this.px,t[10*e+1]=this.py,t[10*e+2]=this.dir+Math.PI/2,t[10*e+3]=i.w/2,t[10*e+4]=i.h/2,n=i.sprite,t[10*e+5]=n.tx/n.sprite.w,t[10*e+6]=n.ty/n.sprite.h,t[10*e+7]=n.tw/n.sprite.w,t[10*e+8]=n.th/n.sprite.h,t[10*e+9]=1,e++,i=this.shaped_sprite.end,t[10*e+0]=this.px+this.len*Math.cos(this.dir),t[10*e+1]=this.py+this.len*Math.sin(this.dir),t[10*e+2]=this.dir+Math.PI/2,t[10*e+3]=i.w/2,t[10*e+4]=i.h/2,n=i.sprite,t[10*e+5]=n.tx/n.sprite.w,t[10*e+6]=n.ty/n.sprite.h,t[10*e+7]=n.tw/n.sprite.w,t[10*e+8]=n.th/n.sprite.h,t[10*e+9]=1},e}(o.hE)))},533:(t,e,r)=>{"use strict";r.d(e,{f:()=>p,U:()=>h});var n,i=r(566),o=r(68),a=r(349),s=r(869),u=r(822),c=r(924),_=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),p=function(){function t(t,e,r){this.shoot=t,this.bomb=e,this.ability=r}return t.prototype.updateShoot=function(t,e){var r;return null===(r=this.shoot)||void 0===r?void 0:r.updateEnable(t,e)},t.prototype.updateBomb=function(t,e){var r;return null===(r=this.bomb)||void 0===r?void 0:r.updateEnable(t,e)},t.prototype.updateAbility=function(t,e){var r;return null===(r=this.ability)||void 0===r?void 0:r.updateEnable(t,e)},t.prototype.render=function(t,e){var r,n,i;null===(r=this.shoot)||void 0===r||r.render(t,e),null===(n=this.bomb)||void 0===n||n.render(t,e),null===(i=this.ability)||void 0===i||i.render(t,e)},t.prototype.layers=function(){var t=[];return this.shoot&&(t=t.concat(this.shoot.layers())),this.bomb&&(t=t.concat(this.bomb.layers())),this.ability&&(t=t.concat(this.ability.layers())),t},t}(),h=function(t){function e(r,n,i,o,a){var u=t.call(this,2,null)||this;return u.config=s.S,u.state=1,u.time=0,u.missed=!1,u.bombed=!1,u.grazed=!1,u.post_grazed=!1,u.pre_miss=0,u.miss_time=0,u.invince_time=0,u.px=0,u.py=0,u.dir=0,u.prex=0,u.prey=0,u.graze_total=0,u.graze_current=0,u.collideCheck=function(t){for(var e=Math.sqrt(Math.pow(u.px-u.prex,2)+Math.pow(u.py-u.prey,2)),r=Math.max(1,Math.ceil(e/2)),n=1/0,i=0;i<r;i++){var o=u.px+(u.prex-u.px)*i/r,a=u.py+(u.prey-u.py)*i/r;n=Math.min(n,t.distanceTo(o,a))}return n-u.shaped_sprite.shape.radius<u.ability.graze_radius&&(u.grazed=!0),n<u.shaped_sprite.shape.radius},e.INSTANCE=u,u.proto=n,u.ability=i,u.sprite=r,u.px=o,u.py=a,u.dir=0,u.bomb_count=i.init_bomb,u.life_count=i.init_life,u.ability_count=i.init_ability,u.renderType=2,u}return _(e,t),e.updateState=function(t){e.action=t},e.prototype.update=function(t){if(e.action){this.prex=this.px,this.prey=this.py;var r=u.n.INSTANCE.special_effects.time_rate;this.time+=r,this.px+=e.action.pos_x,this.py+=e.action.pos_y,this.px<-a.SH&&(this.px=-a.SH),this.px>a.SH&&(this.px=a.SH),this.py<-a.ZP&&(this.py=-a.ZP),this.py>a.ZP&&(this.py=a.ZP),this.dir=this.time*this.sprite.sprite.omega,this.bombed=this.proto.updateShoot(this,e.action.key_z),this.bombed||(this.bombed=this.proto.updateBomb(this,e.action.key_x)),this.bombed||(this.bombed=this.proto.updateAbility(this,e.action.key_c))}},e.prototype.postUpdate=function(t){this.post_grazed=this.grazed,this.grazed&&(this.graze_current<this.ability.max_graze&&(this.graze_current+=u.n.INSTANCE.special_effects.time_rate),this.graze_total++,this.graze_current>=this.ability.max_graze&&this.ability_count<this.ability.max_ability&&(this.ability_count++,this.graze_current=0),this.grazed=!1),this.miss_time>0&&this.miss_time--,this.pre_miss>0&&(this.pre_miss--,0==this.pre_miss&&(console.log("missed"),this.miss_time=this.ability.miss_time)),this.missed&&(this.missed=!1,this.pre_miss=this.ability.pre_miss),this.bombed&&(this.bombed=!1,this.miss_time=this.ability.bomb_time,this.pre_miss>0&&(console.log("bomb after miss"),this.pre_miss=0)),this.miss_time>0||this.pre_miss>0?(this.state=2,this.invince_time++,Math.floor(this.invince_time/6)%2==0?this.shaped_sprite=null:this.shaped_sprite=this.sprite):(this.state=1,this.invince_time=0,this.shaped_sprite=this.sprite)},e.prototype.attack=function(t,e){},e.prototype.damaged=function(t,e){return 0==this.pre_miss&&0==this.miss_time&&(this.missed=!0),e.damaged(e,this)},e.prototype.layers=function(){return function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)n[i]=o[a];return n}(this.proto.layers(),[s.$7])},e.prototype.render=function(t){var e,r=[],n=0,i=null;this.proto.render(t,this),t==s.$7&&(null===(e=this.shaped_sprite)||void 0===e?void 0:e.sprite)&&(function(t,e,a,s,u){r.push(t),r.push(e),r.push(a+Math.PI/2),r.push(u.w/2),r.push(u.h/2);var c=u.sprite;r.push(c.tx/c.sprite.w),r.push(c.ty/c.sprite.h),r.push(c.tw/c.sprite.w),r.push(c.th/c.sprite.h),r.push(1),n++,i=o.Z.get(c.sprite.path).img}(this.px,this.py,this.dir,0,this.shaped_sprite),c.setMode(0),c.drawRects(new Float32Array(r),n,i))},e.INSTANCE=null,e.action=null,e}(i.hE)},822:(t,e,r)=>{"use strict";r.d(e,{n:()=>s});var n=r(869),i=r(566),o=r(68),a=function(){function t(){this.time_rate=1,this.time_rate_next=1}return t.prototype.process=function(){this.time_rate=this.time_rate_next,this.time_rate_next=1},t.prototype.time_slowdown=function(t){this.time_rate_next*=t},t}(),s=function(){function t(){this.groups=[],this.pending=[],this.update_stage=0,this.time=0,this.special_effects=new a,t.INSTANCE=this,this.groups.push({id:n.T,mask:n.KZ,list:[]}),this.groups.push({id:n.ZE,mask:n.DV,list:[]}),this.groups.push({id:n.yR,mask:n.P4,list:[]}),this.groups.push({id:n.A4,mask:n.k8,list:[]}),this.groups.push({id:n.t_,mask:n.Gs,list:[]}),this.groups.push({id:n.T7,mask:n.Io,list:[]})}return t.prototype.registerGroup=function(t){var e=this.groups.length;return this.groups.push({id:e,mask:t,list:[]}),e},t.prototype.add=function(t){3!=this.update_stage&&0!=this.update_stage?this.pending.push(t):this.groups[t.config.collide_group].list.push(t)},t.prototype.update=function(){var t=this;this.update_stage=1,this.groups.forEach((function(t){return t.list.forEach((function(t){return t.update(t)}))}));for(var e=0;e<this.groups.length;e++)for(var r=0;r<this.groups.length;r++)if(this.groups[e].mask&1<<r)for(var n=0,o=this.groups[e].list;n<o.length;n++){var a=o[n];if(1==a.state&&a.shaped_sprite&&a.shaped_sprite.shape)for(var s=0,u=this.groups[r].list;s<u.length;s++){var c=u[s];1==c.state&&c.shaped_sprite&&c.shaped_sprite.shape&&(0,i._R)(a,c)&&a.attack(a,c)}}this.update_stage=2,this.groups.forEach((function(t){return t.list.forEach((function(t){return t.postUpdate(t)}))})),this.groups.forEach((function(t){return t.list=t.list.filter((function(t){return 3!=t.state}))})),this.update_stage=3,this.special_effects.process(),this.pending.forEach((function(e){return t.add(e)})),this.pending=[],this.time++},t.prototype.render=function(){var t,e,r,n,i,a,s,u;return i=this,a=void 0,u=function(){var i,a,s,u,c,_,p,h,l,f,d,y;return function(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(v){for(i=new Map,a=[],s=0,u=this.groups;s<u.length;s++)for(c=u[s],_=0,p=c.list;_<p.length;_++)2!=(h=p[_]).renderType?h.config.render_layer&&(null===(t=h.shaped_sprite)||void 0===t?void 0:t.sprite)&&(i.has(h.config.render_layer)||i.set(h.config.render_layer,new Map),f=i.get(h.config.render_layer),d=null===(n=null===(r=null===(e=h.shaped_sprite)||void 0===e?void 0:e.sprite)||void 0===r?void 0:r.sprite)||void 0===n?void 0:n.path,f.has(d)||f.set(d,[]),f.get(d).push(h)):(l=h,a.push(l),l.layers().forEach((function(t){return i.set(t,new Map)})));return y=[],i.forEach((function(t,e){return y.push({rl:e,v:t})})),y.sort((function(t,e){return t.rl-e.rl})),y.forEach((function(t){a.forEach((function(e){return e.render(t.rl)})),t.v.forEach((function(t,e){return o.Z.get(e).draw(t)}))})),[2]}))},new((s=void 0)||(s=Promise))((function(t,e){function r(t){try{o(u.next(t))}catch(t){e(t)}}function n(t){try{o(u.throw(t))}catch(t){e(t)}}function o(e){var i;e.done?t(e.value):(i=e.value,i instanceof s?i:new s((function(t){t(i)}))).then(r,n)}o((u=u.apply(i,a||[])).next())}))},t}()},334:(t,e,r)=>{"use strict";r.d(e,{FX:()=>p,hP:()=>d,b2:()=>v});var n,i=r(869),o=r(566),a=r(822),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),u=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)n[i]=o[a];return n},c=function(){},_=function(t){function e(e){var r=t.call(this)||this;return r.remain=e,r}return s(e,t),e.prototype.update=function(t){return this.remain-=t,this.remain<0?-this.remain:0},e}(c),p=function(t){function e(e){var r=t.call(this)||this;return r.time=0,r.init=e,r}return s(e,t),e.random=function(t,r){return function(){return new e((function(e){var n=Math.max(r.px0-t.px,-r.dx1),i=Math.min(r.px1-t.px,r.dx1),o=Math.max(r.py0-t.py,-r.dy1),a=Math.min(r.py1-t.py,r.dy1),s=n+Math.random()*(i-n),u=o+Math.random()*(a-o);e.target=t,e.duration=r.duration,e.dx=s,e.dy=u,e.x0=t.px,e.y0=t.py,e.ease=r.ease}))}},e.prototype.update=function(t){0==this.time&&this.init(this),this.time+=t;var e=Math.min(1,this.time/this.duration),r=this.ease(e);return this.target.px=this.x0+this.dx*r,this.target.py=this.y0+this.dy*r,this.time>this.duration?this.time-this.duration:0},e}(c),h=function(t){function e(e){var r=t.call(this)||this;return r.todo=e,r}return s(e,t),e.prototype.update=function(t,e){var r=this.todo();return void 0===r?t:"number"==typeof r?(e.list[0]=new _(r),e.list[0].update(t,e)):(e.list.unshift(e.list[0]),e.list[1]=r,t)},e}(c),l=function(){};function f(t){return t.map((function(t){return"number"==typeof t?new _(t):"function"==typeof t?new h(t):t}))}var d=function(t){function e(e,r){var n=t.call(this)||this;return n.index=0,n.todo=e,n.total=r,n}return s(e,t),e.prototype.supply=function(){return this.index>=this.total?null:(t="function"==typeof this.todo?this.todo(this.index):this.todo,this.index++,f(t));var t},e}(l),y={render_layer:i.NH,collide_group:i.T7,collide_mask:i.Io},v=function(t){function e(e){var r=t.call(this)||this;return r.custom_fields={},r.config=y,r.state=0,r.time=0,r.list=f("object"==typeof e?e:e(r)),r}return s(e,t),e.prototype.init=function(t){return t(this),this},e.prototype.update=function(t){0==this.state&&(this.state=1);var e=a.n.INSTANCE.special_effects.time_rate;for(this.time+=e;this.list.length>0&&e;){var r=this.list[0];if(r instanceof l){var n=r.supply();n&&n.length?this.list=u(n,this.list):this.list.shift()}else(e=r.update(e,this))>0&&this.list.shift()}0==this.list.length&&(this.state=2)},e.prototype.postUpdate=function(t){2==this.state&&(this.state=3)},e.prototype.attack=function(t){},e.prototype.damaged=function(t,e){return!1},e}(o.u5)},176:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{S:()=>init});var _entity_SelfMachine__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(533),_util_SpriteManager__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(68),_util_sprites__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(940),_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(583),_stage_EntityPool__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(822),_data_SlowAbility__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(516),_data_StopAbility__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(293),_data_stage_stage_000__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(555),_data_stage_stage_001__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(121),_data_stage_stage_002__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(285),_data_stage_stage_003__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(265),_data_stage_stage_004__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(415),_data_stage_stage_005__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(950),_data_stage_test_000__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(93),__awaiter=function(t,e,r,n){return new(r||(r=Promise))((function(i,o){function a(t){try{u(n.next(t))}catch(t){o(t)}}function s(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))},__generator=function(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},abilities=[function(){return new _data_SlowAbility__WEBPACK_IMPORTED_MODULE_5__.n},function(){return new _data_StopAbility__WEBPACK_IMPORTED_MODULE_6__.U}],stage_list=[_data_stage_stage_000__WEBPACK_IMPORTED_MODULE_7__.z,_data_stage_stage_001__WEBPACK_IMPORTED_MODULE_8__.N,_data_stage_stage_002__WEBPACK_IMPORTED_MODULE_9__.t,_data_stage_stage_003__WEBPACK_IMPORTED_MODULE_10__.c,_data_stage_stage_004__WEBPACK_IMPORTED_MODULE_11__.$,_data_stage_stage_005__WEBPACK_IMPORTED_MODULE_12__.c,_data_stage_test_000__WEBPACK_IMPORTED_MODULE_13__.W,_data_stage_test_000__WEBPACK_IMPORTED_MODULE_13__.W],sm_abi={pre_miss:30,miss_time:60,bomb_time:60,graze_radius:24,max_graze:600,init_bomb:3,init_life:3,init_ability:5,max_bomb:10,max_life:10,max_ability:5},stage_settings={init,stage:1,scale:3,ability:1,list:stage_list},sinit={load_sprite:function(){return _util_SpriteManager__WEBPACK_IMPORTED_MODULE_1__.Z.get(_util_sprites__WEBPACK_IMPORTED_MODULE_2__.Xp.path).load()},add_player:function(){return new _entity_SelfMachine__WEBPACK_IMPORTED_MODULE_0__.U(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_3__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_2__.a_,1),new _entity_SelfMachine__WEBPACK_IMPORTED_MODULE_0__.f(null,null,abilities[stage_settings.ability]()),sm_abi,0,-192)},add_schedule:null};function init(){return __awaiter(this,void 0,void 0,(function(){var pool;return __generator(this,(function(_a){switch(_a.label){case 0:return[4,sinit.load_sprite()];case 1:return _a.sent(),pool=new _stage_EntityPool__WEBPACK_IMPORTED_MODULE_4__.n,pool.add(sinit.add_player()),pool.add(stage_list[stage_settings.stage].init(stage_settings.scale)),eval("window.debug_info.pool = pool"),eval("window.debug_info.stage = stage_settings"),[2]}}))}))}},566:(t,e,r)=>{"use strict";r.d(e,{bn:()=>a,D8:()=>u,HC:()=>c,Yw:()=>_,hE:()=>p,eY:()=>h,u5:()=>l,_R:()=>f});var n,i,o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),a=function(){},s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(a),u=function(t){function e(e){var r=t.call(this)||this;return r.radius=e,r}return o(e,t),e.prototype.exitScreen=function(t,e,r){var n=Math.sqrt(Math.pow(t.shaped_sprite.w,2)+Math.pow(t.shaped_sprite.h,2));return Math.abs(t.px)>e+n*t.magn||Math.abs(t.py)>r+n*t.magn},e.prototype.distanceTo=function(t,e,r){return Math.sqrt(Math.pow(e-t.px,2)+Math.pow(r-t.py,2))-this.radius*t.magn},e.prototype.rawDistanceTo=function(t,e,r,n,i){return Math.sqrt(Math.pow(n-t,2)+Math.pow(i-e,2))-this.radius*r},e.prototype.rawExitScreen=function(t,e,r,n,i){var o=Math.sqrt(Math.pow(r.w,2)+Math.pow(r.h,2));return Math.abs(t)>n+o||Math.abs(e)>i+o},e}(s),c=function(t){function e(e,r){var n=t.call(this)||this;return n.len=e,n.rad=r,n}return o(e,t),e.orthDis=function(t,e,r,n){var i=n/2;t=Math.abs(t);var o=r*r/i/2+i/2-i;return(e=Math.abs(e))>=0&&r*(e+o)>t*o?Math.sqrt(Math.pow(t,2)+Math.pow(e+o,2))-o-i:Math.sqrt(Math.pow(t-r,2)+Math.pow(e,2))-i},e.prototype.exitScreen=function(t,e,r){var n=Math.sqrt(Math.pow(t.shaped_sprite.w,2)+Math.pow(t.shaped_sprite.h,2));return Math.abs(t.px)>e+n*t.magn||Math.abs(t.py)>r+n*t.magn},e.prototype.distanceTo=function(t,r,n){var i=r-t.px,o=n-t.py,a=i*Math.cos(-t.dir)-o*Math.sin(-t.dir),s=i*Math.sin(-t.dir)+o*Math.cos(-t.dir);return e.orthDis(a,s,this.len/2*t.magn,this.rad*t.magn)},e}(s),_=function(){},p=(o((function(){return null!==i&&i.apply(this,arguments)||this}),i=_),function(){function t(t,e){this.collideCheck=null,this.renderType=t,this.shaped_sprite=e}return t.prototype.distanceTo=function(t,e){var r;return(null===(r=this.shaped_sprite)||void 0===r?void 0:r.shape)?this.shaped_sprite.shape.distanceTo(this,t,e):1/0},t}()),h=function(t){function e(e){var r=t.call(this,0,e)||this;return r.magn=1,r.alpha=1,r}return o(e,t),e.prototype.rectCount=function(){return 1},e.prototype.render=function(t,e){t[10*e+0]=this.px,t[10*e+1]=this.py,t[10*e+2]=this.dir+Math.PI/2,t[10*e+3]=this.shaped_sprite.w/2*this.magn,t[10*e+4]=this.shaped_sprite.h/2*this.magn;var r=this.shaped_sprite.sprite;t[10*e+5]=r.tx/r.sprite.w,t[10*e+6]=r.ty/r.sprite.h,t[10*e+7]=r.tw/r.sprite.w,t[10*e+8]=r.th/r.sprite.h,t[10*e+9]=this.alpha},e}(p),l=function(t){function e(){return t.call(this,null,null)||this}return o(e,t),e}(p);function f(t,e){if(t.collideCheck)return t.collideCheck(e);if(e.collideCheck)return e.collideCheck(t);if(t instanceof h&&t.shaped_sprite.shape instanceof u)return e.distanceTo(t.px,t.py)<t.shaped_sprite.shape.radius;if(e instanceof h&&e.shaped_sprite.shape instanceof u)return f(e,t);throw new Error("non-circle non-circle collision not found")}},68:(t,e,r)=>{"use strict";r.d(e,{Z:()=>i});var n=r(924),i=function(){function t(t){this.img=null,this.path=t}return t.prototype.loaded=function(){return this.img},t.prototype.load=function(){return t=this,e=void 0,i=function(){var t;return function(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(e){switch(e.label){case 0:return[4,n.loadImage(this.path)];case 1:return t=e.sent(),this.img=n.loadTexture(t),[2]}}))},new((r=void 0)||(r=Promise))((function(n,o){function a(t){try{u(i.next(t))}catch(t){o(t)}}function s(t){try{u(i.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((i=i.apply(t,e||[])).next())}));var t,e,r,i},t.get=function(e){return t.INS[e]?t.INS[e]:t.INS[e]=new t(e)},t.prototype.draw=function(t){this.drawRect(t,0),this.drawRect(t,1);for(var e=0,r=t;e<r.length;e++){var i=r[e];if(1==i.renderType)for(var o=i,a=o.getSprite(),s=a.sprite,u=0,c=o.render();u<c.length;u++){var _=c[u];n.drawSnake(_,a.w,_.length/2,s.tx,s.ty,s.tw,s.th,this.img)}}},t.prototype.drawRect=function(t,e){var r=t.reduce((function(t,r){return 0==r.renderType&&r.shaped_sprite.sprite.mode==e?t+r.rectCount():t}),0);if(r){n.setMode(e);for(var i=new Float32Array(10*r),o=0,a=0,s=t;a<s.length;a++){var u=s[a];if(0==u.renderType&&u.shaped_sprite.sprite.mode==e){var c=u;c.render(i,o),o+=c.rectCount()}}n.drawRects(i,r,this.img)}},t.INS={},t}()},583:(t,e,r)=>{"use strict";r.d(e,{xg:()=>u,p3:()=>c,iW:()=>_});var n=r(296),i=r(566),o=r(940),a=[[1.4,0],[2.4,2.4,4,4,2.4,2.4,2.4,2.8,2.4,2.4,4,2.4,2.4,2.4,2.4,2.4],[6,7,8.5,7,6,7,0,10],[14,14]],s=.75;function u(t,e){return e*=s,{sprite:t,shape:new i.D8(a[t.category][t.type]*e),w:t.tw*e,h:t.th*e,renderType:0}}function c(t,e,r){var n=(0,o.e8)(4,t,e);return{sprite:n,shape:new i.HC(r,a[1][4]*s),renderType:0,w:n.tw*s,h:1.25*r}}function _(t,e,r,i,a,c,_){var p=(0,o.e8)(t,e,i);return p.ty+=0==t?4:4==t||1==t?1:NaN,p.th-=0==t?8:4==t?2:1==t?1:NaN,{sprite:p,shape:new n.cE(0==t?n.cE.line_circle:1==t?n.cE.half_arc:4==t?n.cE.double_arc:null),renderType:0,sprite_width:p.tw*s/2*_,hitbox_width:2.4*s*_,l_ratio:0==t||c>0?1:4==t?1.15:1==t?1.2:NaN,base:u((0,o.hZ)(0,r,i),a*_),end:u((0,o.hZ)(0,r,i),c*_)}}},940:(t,e,r)=>{"use strict";r.d(e,{Xp:()=>a,e8:()=>s,hZ:()=>u,a_:()=>c,cI:()=>_});var n=[0,0,1,1,0,0,0,0,0,1,1,1,1,0,0],i=[1,1,1,0,0,0,1,0],o=2*Math.PI/600,a={path:"assets/bullet_000.png",w:516,h:772};function s(t,e,r){return{sprite:a,tx:t<12?1+16*e:t<14?1+e%8*8:t<15?1:258+16*e,ty:t<12?1+16*t:t<14?(t<13?193:241)+8*(e>>3):e<15?515+16*e:449,tw:t<12?16:t<14?8:t<15?256:16,th:t<12?16:t<14?8:16,mode:r,category:1,type:t,color:e,omega:n[t]*o}}function u(t,e,r){return{sprite:a,tx:(t<7?1:258)+32*e,ty:0==t?209:t<7?226+32*t:257,tw:32,th:32,mode:r,category:2,type:t,color:e,omega:i[t]*o}}var c={sprite:a,tx:258,ty:17,tw:64,th:64,mode:0,category:0,type:0,color:0,omega:o},_={sprite:a,tx:386,ty:81,tw:128,th:128,mode:0,category:0,type:2,color:0,omega:o}},235:()=>{const t=document.getElementById("stage_start"),e=document.getElementById("stage_dec"),r=document.getElementById("stage_inc"),n=debug_info.stage,i=()=>{e.disabled=0==n.stage,r.disabled=n.stage==n.list.length-1,t.value=`start stage ${n.list[n.stage].name}`};e.onclick=()=>{n.stage>0&&n.stage--,i()},r.onclick=()=>{n.stage<n.list.length&&n.stage++,i()},i()},924:(t,e,r)=>{"use strict";r.r(e),r.d(e,{global_gl:()=>i,setup:()=>o,setMode:()=>a,loadImage:()=>s,draw:()=>u,drawStrip:()=>c,loadTexture:()=>_,clear:()=>p,drawRects:()=>v,drawSnake:()=>m});var n=r(349);const i={gl:null,shader:{program:0,attribute:{coord:0,tex:0,alpha:0},uniform:{uSampler:0}}};function o(){var t=document.getElementById("glcanvas"),e=t.getContext("webgl");if(null===e)return void alert("Unable to initialize WebGL. Your browser or machine may not support it.");i.gl=e;var r=e.createShader(e.VERTEX_SHADER),n=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(r,"\nattribute vec2 coord;\nattribute vec2 tex;\nattribute float alpha;\nvarying highp vec2 vTexCoord;\nvarying highp float vTexAlpha;\nvoid main() {\n    gl_Position = vec4(coord, 0.0, 1.0);\n    vTexCoord = tex;\n    vTexAlpha = alpha;\n}\n"),e.shaderSource(n,"\nprecision highp float;\nvarying highp vec2 vTexCoord;\nvarying highp float vTexAlpha;\nuniform sampler2D uSampler;\nvoid main() {\n    vec4 col = texture2D(uSampler, vTexCoord);\n    col.a *= vTexAlpha;\n    col.rgb *= col.a;\n    gl_FragColor = col;\n}\n"),e.compileShader(r),e.compileShader(n);var o=e.createProgram();e.attachShader(o,r),e.attachShader(o,n),e.linkProgram(o),e.useProgram(o);const a=i.shader;a.program=o,a.attribute.coord=e.getAttribLocation(o,"coord"),a.attribute.tex=e.getAttribLocation(o,"tex"),a.attribute.alpha=e.getAttribLocation(o,"alpha"),a.uniform.uSampler=e.getUniformLocation(o,"uSampler"),e.enable(e.BLEND),e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA),e.disable(e.DEPTH_TEST),e.viewport(0,0,t.width,t.height)}function a(t){const e=i.gl;0==t?e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA):e.blendFuncSeparate(e.ONE,e.ONE,e.ONE,e.ONE_MINUS_SRC_ALPHA)}function s(t){return new Promise(((e,r)=>{let n=new Image;n.onload=()=>e(n),n.onerror=r,n.src=t}))}function u(t,e,r,n,o){const a=i.gl,s=a.createBuffer(),u=i.shader.attribute.coord;a.bindBuffer(a.ARRAY_BUFFER,s),a.bufferData(a.ARRAY_BUFFER,t,a.STATIC_DRAW),a.vertexAttribPointer(u,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(u);const c=a.createBuffer(),_=i.shader.attribute.tex;a.bindBuffer(a.ARRAY_BUFFER,c),a.bufferData(a.ARRAY_BUFFER,e,a.STATIC_DRAW),a.vertexAttribPointer(_,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(_);const p=a.createBuffer(),h=i.shader.attribute.alpha;a.bindBuffer(a.ARRAY_BUFFER,p),a.bufferData(a.ARRAY_BUFFER,r,a.STATIC_DRAW),a.vertexAttribPointer(h,1,a.FLOAT,!1,0,0),a.enableVertexAttribArray(h),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,n),a.uniform1i(i.shader.uniform.uSampler,0),a.drawArrays(a.TRIANGLES,0,o)}function c(t,e,r,n,o){const a=i.gl,s=a.createBuffer(),u=i.shader.attribute.coord;a.bindBuffer(a.ARRAY_BUFFER,s),a.bufferData(a.ARRAY_BUFFER,t,a.STATIC_DRAW),a.vertexAttribPointer(u,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(u);const c=a.createBuffer(),_=i.shader.attribute.tex;a.bindBuffer(a.ARRAY_BUFFER,c),a.bufferData(a.ARRAY_BUFFER,e,a.STATIC_DRAW),a.vertexAttribPointer(_,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(_);const p=a.createBuffer();a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,p),a.bufferData(a.ELEMENT_ARRAY_BUFFER,r,a.STATIC_DRAW),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,n),a.uniform1i(i.shader.uniform.uSampler,0),a.drawElements(a.TRIANGLE_STRIP,o,a.UNSIGNED_SHORT,0)}function _(t,e=!0,r=!1){const n=i.gl,o=n.createTexture();return n.bindTexture(n.TEXTURE_2D,o),n.bindTexture(n.TEXTURE_2D,o),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_SHORT_4_4_4_4,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,e?n.LINEAR:n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,e?n.LINEAR:n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,r?n.REPEAT:n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,r?n.REPEAT:n.CLAMP_TO_EDGE),o}function p(){const t=i.gl;t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT),t.clearColor(0,0,1,1)}const h=[-1,-1,1,-1,1,1],l=[-1,1,1,-1,-1,1],f=[0,0,1,0,1,1],d=[0,1,1,0,0,1];function y(t){for(var e=0;e<t.length/2;e++)t[2*e]=(0,n.OK)(t[2*e]),t[2*e+1]=(0,n.ZA)(t[2*e+1])}function v(t,e,r){const n=new Float32Array(12*e),i=new Float32Array(12*e),o=new Float32Array(6*e);for(var a=0;a<e;a++)for(var s=0;s<6;s++){const e=t[10*a+2],r=t[10*a+3]*h[s],u=t[10*a+4]*l[s];n[12*a+2*s+0]=t[10*a+0]+r*Math.cos(e)-u*Math.sin(e),n[12*a+2*s+1]=t[10*a+1]+r*Math.sin(e)+u*Math.cos(e),i[12*a+2*s+0]=t[10*a+5]+f[s]*t[10*a+7],i[12*a+2*s+1]=t[10*a+6]+d[s]*t[10*a+8],o[6*a+s]=t[10*a+9]}y(n),u(n,i,o,r,6*e)}function m(t,e,r,n,o,a,s,u){const c=new Float32Array(6*r),_=new Float32Array(r),p=new Float32Array(6*r),h=new Int16Array(2*(r-1));for(var l=0,f=0;f<r-1;f++){const r=t[2*f],n=t[2*f+1],i=t[2*f+2],o=t[2*f+3],a=(r+i)/2,s=(n+o)/2,u=Math.sqrt((i-r)*(i-r)+(o-n)*(o-n));_[f]=u,l+=u,c[6*f+0]=r,c[6*f+1]=n,c[6*f+2]=a-(s-n)/u*e,c[6*f+3]=s+(a-r)/u*e,c[6*f+4]=a+(s-n)/u*e,c[6*f+5]=s-(a-r)/u*e}y(c),l-=_[0]/2+_[r-1]/2;var d=-_[0]/2;for(f=1;f<r;f++)p[6*f+0]=n+a*d/l,p[6*f+1]=o+s/2,d+=_[f]/2,p[6*f+2]=n+a*d/l,p[6*f+3]=o,p[6*f+4]=n+a*d/l,p[6*f+5]=o+s,d+=_[f]/2;for(f=0;f<r-1;f++)h[2*f+0]=3*f+1,h[2*f+1]=3*f+3;h[2*r-3]--;const v=i.gl,m=v.createBuffer(),w=i.shader.attribute.coord;v.bindBuffer(v.ARRAY_BUFFER,m),v.bufferData(v.ARRAY_BUFFER,c,v.STATIC_DRAW),v.vertexAttribPointer(w,2,v.FLOAT,!1,0,0),v.enableVertexAttribArray(w);const b=v.createBuffer(),g=i.shader.attribute.tex;v.bindBuffer(v.ARRAY_BUFFER,b),v.bufferData(v.ARRAY_BUFFER,p,v.STATIC_DRAW),v.vertexAttribPointer(g,2,v.FLOAT,!1,0,0),v.enableVertexAttribArray(g),v.activeTexture(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,u),v.uniform1i(i.shader.uniform.uSampler,0);const x=v.createBuffer();for(v.bindBuffer(v.ELEMENT_ARRAY_BUFFER,x),v.bufferData(v.ELEMENT_ARRAY_BUFFER,h,v.STATIC_DRAW),v.drawElements(v.TRIANGLE_STRIP,2*r-2,v.UNSIGNED_SHORT,0),f=0;f<r-1;f++)h[2*f+0]=3*f,h[2*f+1]=3*f+2;h[0]++,v.bufferData(v.ELEMENT_ARRAY_BUFFER,h,v.STATIC_DRAW),v.drawElements(v.TRIANGLE_STRIP,2*r-2,v.UNSIGNED_SHORT,0)}window.debug_info={},window.debug_info.global_gl=i,window.debug_info.gl_func={setup:o,clear:p,draw:u,drawStrip:c,drawRects:v,drawSnake:m}}},__webpack_module_cache__={};function __webpack_require__(t){if(__webpack_module_cache__[t])return __webpack_module_cache__[t].exports;var e=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](e,e.exports,__webpack_require__),e.exports}__webpack_require__.d=(t,e)=>{for(var r in e)__webpack_require__.o(e,r)&&!__webpack_require__.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{"use strict";var t={};__webpack_require__.r(t),__webpack_require__.d(t,{KEY_CLICK:()=>D,KEY_PRESS:()=>O,canvas_height:()=>y,canvas_width:()=>d,devicePixelRatio:()=>b,keys:()=>A,last_update_rate:()=>g,mainloop_start:()=>R,mainloop_terminate:()=>I,mouse:()=>M,setup_canvas:()=>T,test_fps:()=>x});var e,r,n=__webpack_require__(176),i=__webpack_require__(924),o=__webpack_require__(822),a=__webpack_require__(533),s=__webpack_require__(349),u=__webpack_require__(780),c=!1,_=!1,p=0,h=0,l=0,f=0;var d,y,v=0,m=0,w=null,b=1,g=1;function x(){return v=performance.now(),m=241,E(),new Promise(((t,e)=>{w=t}))}function E(){if(--m)requestAnimationFrame(E);else{var t=(performance.now()-v)/240;g=Math.round(t/(1e3/60)),w(g)}}var M={x:0,y:0},A={};function T(){document.onmousemove=t=>{M.x=t.pageX,M.y=t.pageY},document.ontouchstart=t=>{A._touch=3,M.x=t.pageX,M.y=t.pageY,t.preventDefault()},document.ontouchend=t=>{A._touch=1,M.x=t.pageX,M.y=t.pageY,t.preventDefault()},document.ontouchmove=t=>{M.x=t.pageX,M.y=t.pageY,t.preventDefault()},document.onmousedown=t=>{A._press=3},document.onmouseup=t=>{A._press=1},document.addEventListener("keydown",(t=>{var e=t.key;1==e.length&&(e=e.toLowerCase()),A[e]=3}),!1),document.addEventListener("keyup",(t=>{var e=t.key;1==e.length&&(e=e.toLowerCase()),A[e]=1}),!1);var t=window.innerWidth,e=window.innerHeight,r=.95*Math.min(t/s.Fy,e/s.bE),n=document.getElementById("glcanvas");d=r*s.Fy,y=r*s.bE,n.style.width=d+"px",n.style.height=y+"px",b=window.devicePixelRatio||1,n.width=d*b,n.height=y*b,i.setup()}var P=!1;async function R(){P||(P=!0,await function(){return t=this,n=void 0,a=function(){var t,n,o,a;return function(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(s){switch(s.label){case 0:return n=(t=i).loadTexture,[4,i.loadImage("assets/ui_bg.png")];case 1:return e=n.apply(t,[s.sent(),!1,!0]),a=(o=i).loadTexture,[4,i.loadImage("assets/scene_bg.png")];case 2:return r=a.apply(o,[s.sent(),!1,!0]),[2]}}))},new((o=void 0)||(o=Promise))((function(e,r){function i(t){try{u(a.next(t))}catch(t){r(t)}}function s(t){try{u(a.throw(t))}catch(t){r(t)}}function u(t){var r;t.done?e(t.value):(r=t.value,r instanceof o?r:new o((function(t){t(r)}))).then(i,s)}u((a=a.apply(t,n||[])).next())}));var t,n,o,a}(),S())}function I(){P=!1}function S(){!function(){var t=o.n.INSTANCE;if(t){var n=function(){if(A.Escape==D&&(c=!c),c)return _=!1,null;var t=0,e=0;A.Shift>=O||A._touch>=O||A._press>=O?(_||(_=!0,p=M.x,h=M.y,l=0,f=0),t=M.x-p-l,e=M.y-h-f,l+=t,f+=e):_=!1,t=t/d*s.Fy*2,e=-e/y*s.bE*2;var r=A.Shift>=O?2:3;return(A.w>=O||A.ArrowUp>=O)&&(e+=r),(A.s>=O||A.ArrowDown>=O)&&(e-=r),(A.a>=O||A.ArrowLeft>=O)&&(t-=r),(A.d>=O||A.ArrowRight>=O)&&(t+=r),{pos_x:t,pos_y:e,key_z:A.z>=O,key_x:A.x==D,key_c:A.c==D}}();if(!c&&(a.U.updateState(n),!c))for(var v=0;v<g;v++)t.update();i.clear();var m=new u.l;m.bind(r),s.io(m),m.flush(),t.render(),i.setMode(0),m.bind(e),s.ax(m),m.flush()}}(),function(){for(var t in A)3==A[t]&&(A[t]=2),1==A[t]&&(A[t]=0)}(),P&&requestAnimationFrame(S)}const O=2,D=3;window.onload=async function(){T(),await n.S(),__webpack_require__(235),R(),window.debug_info.stg={fps:x,init:n.S,start:R,terminate:I},window.debug_info.platform=t}})()})();