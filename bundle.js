(()=>{"use strict";var t,n,e={349:(t,n,e)=>{e.d(n,{SH:()=>i,ZP:()=>r,Fy:()=>o,bE:()=>a,OK:()=>s,ZA:()=>u,io:()=>h,ax:()=>p});var i=192,r=224,o=360,a=240;function s(t){return t/o}function u(t){return t/a}var c=1/64;function h(t){t.rect([-i,-r,2*i,2*r],c)}function p(t){var n=function(n){return t.rect(n,c)};n([-i,a-16,2*i,16]),n([-i,-a,2*i,16]),n([-o,-a,o-i,2*a]),n([i,-a,o-i,2*a])}},81:(t,n,e)=>{e.r(n);var i=e(684),r=document.getElementById("stage_start"),o=document.getElementById("stage_dec"),a=document.getElementById("stage_inc"),s=document.getElementById("ability_set"),u=document.getElementById("ability_dec"),c=document.getElementById("ability_inc"),h=i.A,p=function(){o.disabled=0==h.stage,a.disabled=h.stage==h.stage_list.length-1,r.value=""+h.stage_list[h.stage].name,u.disabled=0==h.ability,c.disabled=h.ability==h.ability_list.length-1,s.value=""+h.ability_list[h.ability].name,h.scale=h.stage_list[h.stage].default_scale};o.onclick=function(){h.stage--,p()},a.onclick=function(){h.stage++,p()},u.onclick=function(){h.ability--,p()},c.onclick=function(){h.ability++,p()},p()},86:(t,n,e)=>{e.r(n),e.d(n,{global_gl:()=>r,setup:()=>o,setMode:()=>a,loadImage:()=>s,draw:()=>u,loadTexture:()=>c,clear:()=>h,drawRects:()=>v,drawSnake:()=>m});var i=e(349),r={gl:null,shader:{program:0,attribute:{coord:0,tex:0,alpha:0},uniform:{uSampler:0}}};function o(){var t=document.getElementById("glcanvas"),n=t.getContext("webgl");if(null!==n){r.gl=n;var e=n.createShader(n.VERTEX_SHADER),i=n.createShader(n.FRAGMENT_SHADER);n.shaderSource(e,"\nattribute vec2 coord;\nattribute vec2 tex;\nattribute float alpha;\nvarying highp vec2 vTexCoord;\nvarying highp float vTexAlpha;\nvoid main() {\n    gl_Position = vec4(coord, 0.0, 1.0);\n    vTexCoord = tex;\n    vTexAlpha = alpha;\n}\n"),n.shaderSource(i,"\nprecision highp float;\nvarying highp vec2 vTexCoord;\nvarying highp float vTexAlpha;\nuniform sampler2D uSampler;\nvoid main() {\n    vec4 col = texture2D(uSampler, vTexCoord);\n    col.a *= vTexAlpha;\n    col.rgb *= col.a;\n    gl_FragColor = col;\n}\n"),n.compileShader(e),n.compileShader(i);var o=n.createProgram();n.attachShader(o,e),n.attachShader(o,i),n.linkProgram(o),n.useProgram(o);var a=r.shader;a.program=o,a.attribute.coord=n.getAttribLocation(o,"coord"),a.attribute.tex=n.getAttribLocation(o,"tex"),a.attribute.alpha=n.getAttribLocation(o,"alpha"),a.uniform.uSampler=n.getUniformLocation(o,"uSampler"),n.enable(n.BLEND),n.blendEquationSeparate(n.FUNC_ADD,n.FUNC_ADD),n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA),n.disable(n.DEPTH_TEST),n.viewport(0,0,t.width,t.height)}else alert("Unable to initialize WebGL. Your browser or machine may not support it.")}function a(t){var n=r.gl;0==t?n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA):n.blendFuncSeparate(n.ONE,n.ONE,n.ONE,n.ONE_MINUS_SRC_ALPHA)}function s(t){return new Promise((function(n,e){var i=new Image;i.onload=function(){return n(i)},i.onerror=e,i.src=t}))}function u(t,n,e,i,o){var a=r.gl,s=a.createBuffer(),u=r.shader.attribute.coord;a.bindBuffer(a.ARRAY_BUFFER,s),a.bufferData(a.ARRAY_BUFFER,t,a.STATIC_DRAW),a.vertexAttribPointer(u,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(u);var c=a.createBuffer(),h=r.shader.attribute.tex;a.bindBuffer(a.ARRAY_BUFFER,c),a.bufferData(a.ARRAY_BUFFER,n,a.STATIC_DRAW),a.vertexAttribPointer(h,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(h);var p=a.createBuffer(),l=r.shader.attribute.alpha;a.bindBuffer(a.ARRAY_BUFFER,p),a.bufferData(a.ARRAY_BUFFER,e,a.STATIC_DRAW),a.vertexAttribPointer(l,1,a.FLOAT,!1,0,0),a.enableVertexAttribArray(l),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,i),a.uniform1i(r.shader.uniform.uSampler,0),a.drawArrays(a.TRIANGLES,0,o)}function c(t,n,e){void 0===n&&(n=!0),void 0===e&&(e=!1);var i=r.gl,o=i.createTexture();return i.bindTexture(i.TEXTURE_2D,o),i.bindTexture(i.TEXTURE_2D,o),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_SHORT_4_4_4_4,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,n?i.LINEAR:i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,n?i.LINEAR:i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,e?i.REPEAT:i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,e?i.REPEAT:i.CLAMP_TO_EDGE),o}function h(){var t=r.gl;t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT),t.clearColor(0,0,1,1)}var p=[-1,-1,1,-1,1,1],l=[-1,1,1,-1,-1,1],f=[0,0,1,0,1,1],d=[0,1,1,0,0,1];function y(t){for(var n=0;n<t.length/2;n++)t[2*n]=(0,i.OK)(t[2*n]),t[2*n+1]=(0,i.ZA)(t[2*n+1])}function v(t,n,e){for(var i=new Float32Array(12*n),r=new Float32Array(12*n),o=new Float32Array(6*n),a=0;a<n;a++)for(var s=0;s<6;s++){var c=t[10*a+2],h=t[10*a+3]*p[s],v=t[10*a+4]*l[s];i[12*a+2*s+0]=t[10*a+0]+h*Math.cos(c)-v*Math.sin(c),i[12*a+2*s+1]=t[10*a+1]+h*Math.sin(c)+v*Math.cos(c),r[12*a+2*s+0]=t[10*a+5]+f[s]*t[10*a+7],r[12*a+2*s+1]=t[10*a+6]+d[s]*t[10*a+8],o[6*a+s]=t[10*a+9]}y(i),u(i,r,o,e,6*n)}function _(t,n,e,i,r,o,a,s,u,c){var h=2*n+4*i,p=2*n+8*(e-1)-4*(i+1);t[h+0]=a,t[h+1]=s,t[p+0]=u,t[p+1]=c,0==i?(h>0&&(t[h-2]=a,t[h-1]=s),t[p+2]=t[h+0],t[p+3]=t[h+1],t[p+4]=t[h+0],t[p+5]=t[h+1]):i==e-2?(t[h-2]=r,t[h-1]=o,t[p+2]=r,t[p+3]=o,t[h+2]=t[p+0],t[h+3]=t[p+1]):(t[h-2]=r,t[h-1]=o,t[p+2]=r,t[p+3]=o)}function m(t,n,e){for(var i=n.reduce((function(t,n){return n.len.reduce((function(t,n){return t+4*(n-1)+2}),t)}),0),o=new Float32Array(2*i),a=new Float32Array(2*i),s=new Float32Array(i),u=new Float32Array(n.reduce((function(t,n){return n.len.reduce((function(t,n){return Math.max(t,n)}),t)}),0)),c=0,h=0,p=0,l=n;p<l.length;p++)for(var f=l[p],d=0,v=f.len;d<v.length;d++){for(var m=v[d],w=0,g=0;g<m-1;g++){var x=t[2*c+2*g],b=t[2*c+2*g+1],M=t[2*c+2*g+2],A=t[2*c+2*g+3],E=(x+M)/2,I=(b+A)/2,T=Math.sqrt((M-x)*(M-x)+(A-b)*(A-b));u[g]=T,w+=T,_(o,h,m,g,x,b,E-(I-b)/T*f.w,I+(E-x)/T*f.w,E+(I-b)/T*f.w,I-(E-x)/T*f.w)}w-=u[0]/2+u[m-2]/2;var P=-u[0]/2;for(g=0;g<m-1;g++)_(a,h,m,g,f.tx+f.tw*P/w,f.ty+f.th/2,f.tx+f.tw*(P+u[g]/2)/w,f.ty,f.tx+f.tw*(P+u[g]/2)/w,f.ty+f.th),P+=u[g];c+=m,h+=4*(m-1)+2}for(g=0;g<i;g++)s[g]=1;y(o);var S=r.gl,N=S.createBuffer(),R=r.shader.attribute.coord;S.bindBuffer(S.ARRAY_BUFFER,N),S.bufferData(S.ARRAY_BUFFER,o,S.STATIC_DRAW),S.vertexAttribPointer(R,2,S.FLOAT,!1,0,0),S.enableVertexAttribArray(R);var k=S.createBuffer(),O=r.shader.attribute.tex;S.bindBuffer(S.ARRAY_BUFFER,k),S.bufferData(S.ARRAY_BUFFER,a,S.STATIC_DRAW),S.vertexAttribPointer(O,2,S.FLOAT,!1,0,0),S.enableVertexAttribArray(O);var C=S.createBuffer(),F=r.shader.attribute.alpha;S.bindBuffer(S.ARRAY_BUFFER,C),S.bufferData(S.ARRAY_BUFFER,s,S.STATIC_DRAW),S.vertexAttribPointer(F,1,S.FLOAT,!1,0,0),S.enableVertexAttribArray(F),S.activeTexture(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,e),S.uniform1i(r.shader.uniform.uSampler,0),S.drawArrays(S.TRIANGLE_STRIP,0,i-2)}},780:(t,n,e)=>{e.d(n,{l:()=>o});var i=e(86),r=e(349),o=function(){function t(){this.ver=[],this.tex=[],this.alp=[],this.n=0}return t.prototype.bind=function(t){this.img=t},t.prototype.rect=function(t,n){var e,i,r=t[0],o=t[1],a=t[2],s=t[3],u=[r,o,r,o+s,r+a,o,r,o+s,r+a,o,r+a,o+s];(e=this.ver).push.apply(e,u),(i=this.tex).push.apply(i,u.map((function(t){return t*n}))),this.alp.push(1,1,1,1,1,1),this.n+=6},t.prototype.fan=function(t,n){for(var e=t[0],i=t[1],r=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],h=t[8],p=t[9],l=t[10],f=Math.ceil(Math.abs(e)/(2*Math.PI)*n),d=function(t,n,e,i,r,o,a){return t.push(n,e,n+i*Math.cos(o),e+r*Math.sin(o),n+i*Math.cos(a),e+r*Math.sin(a))},y=0;y<f;y++)d(this.ver,r,o,a,a,i+e/f*y,i+e/f*(y+1)),d(this.tex,u,c,h,p,s+e/f*y,s+e/f*(y+1)),this.alp.push(l,l,l);this.n+=3*f},t.prototype.flush=function(){for(var t=new Float32Array(this.ver),n=0;n<t.length;n+=2)t[n]=(0,r.OK)(t[n]),t[n+1]=(0,r.ZA)(t[n+1]);i.draw(t,new Float32Array(this.tex),new Float32Array(this.alp),this.img,this.n),this.ver=[],this.tex=[],this.alp=[],this.n=0},t}()},506:(t,n,e)=>{e.d(n,{rW:()=>B,OJ:()=>j,Uv:()=>m,fx:()=>_,Mw:()=>L,XP:()=>T,pF:()=>M,dB:()=>N,Jz:()=>I,wW:()=>P,a:()=>A});var i,r,o=e(86),a=e(822),s=e(533),u=e(349),c=e(780),h=!1,p=!1,l=0,f=0,d=0,y=0;function v(){return t=this,n=void 0,a=function(){var t,n,e,a;return function(t,n){var e,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=n.call(t,a)}catch(t){o=[6,t],i=0}finally{e=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(s){switch(s.label){case 0:return n=(t=o).loadTexture,[4,o.loadImage("assets/ui_bg.png")];case 1:return i=n.apply(t,[s.sent(),!1,!0]),a=(e=o).loadTexture,[4,o.loadImage("assets/scene_bg.png")];case 2:return r=a.apply(e,[s.sent(),!1,!0]),[2]}}))},new((e=void 0)||(e=Promise))((function(i,r){function o(t){try{u(a.next(t))}catch(t){r(t)}}function s(t){try{u(a.throw(t))}catch(t){r(t)}}function u(t){var n;t.done?i(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(o,s)}u((a=a.apply(t,n||[])).next())}));var t,n,e,a}var _,m,w=0,g=0,x=null,b=1,M=1;function A(){return w=performance.now(),g=31,E(),new Promise((function(t,n){x=t}))}function E(){if(--g)requestAnimationFrame(E);else{var t=(performance.now()-w)/30;(M=Math.round(t/(1e3/60)))>2&&(M=1),x(M)}}var I={x:0,y:0},T={};function P(){document.onmousemove=function(t){I.x=t.pageX,I.y=t.pageY},document.onmousedown=function(t){T._press=3},document.onmouseup=function(t){T._press=1},document.addEventListener("keydown",(function(t){var n=t.key;1==n.length&&(n=n.toLowerCase()),T[n]=3}),!1),document.addEventListener("keyup",(function(t){var n=t.key;1==n.length&&(n=n.toLowerCase()),T[n]=1}),!1);var t=window.innerWidth,n=window.innerHeight,e=.95*Math.min(t/u.Fy,n/u.bE),i=document.getElementById("glcanvas");_=e*u.Fy,m=e*u.bE,i.style.width=_+"px",i.style.height=m+"px",b=window.devicePixelRatio||1,i.width=_*b,i.height=m*b,o.setup()}var S=!1;function N(){return t=this,n=void 0,i=function(){return function(t,n){var e,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=n.call(t,a)}catch(t){o=[6,t],i=0}finally{e=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(t){switch(t.label){case 0:return S?[2]:(S=!0,[4,v()]);case 1:return t.sent(),D(),[2]}}))},new((e=void 0)||(e=Promise))((function(r,o){function a(t){try{u(i.next(t))}catch(t){o(t)}}function s(t){try{u(i.throw(t))}catch(t){o(t)}}function u(t){var n;t.done?r(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,s)}u((i=i.apply(t,n||[])).next())}));var t,n,e,i}var R=0,k=0,O=0,C=0,F=0,U=new Float32Array(60);function D(){R=performance.now(),k&&R-k>33&&console.log("Violation: interval takes "+Math.round(100*(R-k))/100+" ms"),function(){var t=a.n.INSTANCE;if(t){var n=function(){if(T.Escape==B&&(h=!h),h)return p=!1,null;var t=0,n=0;T.Shift>=j||T._touch>=j||T._press>=j?(p||(p=!0,l=I.x,f=I.y,d=0,y=0),t=I.x-l-d,n=I.y-f-y,d+=t,y+=n):p=!1,t=t/_*u.Fy*2,n=-n/m*u.bE*2;var e=T.Shift>=j?2:3;return(T.w>=j||T.ArrowUp>=j)&&(n+=e),(T.s>=j||T.ArrowDown>=j)&&(n-=e),(T.a>=j||T.ArrowLeft>=j)&&(t-=e),(T.d>=j||T.ArrowRight>=j)&&(t+=e),{pos_x:t,pos_y:n,key_z:T.z>=j,key_x:T.x==B,key_c:T.c==B}}();if(!h&&(s.U.updateState(n),!h))for(var e=0;e<M;e++)t.update();o.clear();var v=new c.l;v.bind(r),u.io(v),v.flush(),t.render(),o.setMode(0),v.bind(i),u.ax(v),v.flush()}}(),function(){for(var t in T)3==T[t]&&(T[t]=2),1==T[t]&&(T[t]=0)}(),O=k,(k=performance.now())-R>16&&console.log("Violation: loop takes "+Math.round(100*(k-R))/100+" ms"),F-=U[C],F+=k-O,U[C]=k-O,C=(C+1)%60,document.title="WebGL stg engine | fps = "+Math.round(6e6/F)/100,S&&requestAnimationFrame(D)}var j=2,B=3,H=window,L={pool:null,stage:null};H.debug_info=L},869:(t,n,e)=>{e.d(n,{T:()=>i,ZE:()=>r,yR:()=>o,A4:()=>a,t_:()=>s,T7:()=>u,KZ:()=>c,DV:()=>h,P4:()=>p,k8:()=>l,Gs:()=>f,Io:()=>d,NH:()=>y,t4:()=>v,bm:()=>_,$7:()=>m,d9:()=>w,S:()=>g});var i=0,r=1,o=2,a=3,s=4,u=5,c=0,h=1,p=1,l=1,f=14,d=0,y=0,v=100,_=500,m=700;function w(t){return Object.assign({},t)}var g={render_layer:m,collide_group:i,collide_mask:c,damage_info:null}},533:(t,n,e)=>{e.d(n,{f:()=>p,U:()=>l});var i,r=e(566),o=e(68),a=e(349),s=e(869),u=e(822),c=e(86),h=(i=function(t,n){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}i(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),p=function(){function t(t,n,e){this.shoot=t,this.bomb=n,this.ability=e}return t.prototype.updateShoot=function(t,n){var e;null===(e=this.shoot)||void 0===e||e.updateEnable(t,n)},t.prototype.updateBomb=function(t,n){var e;return null===(e=this.bomb)||void 0===e?void 0:e.updateEnable(t,n)},t.prototype.updateAbility=function(t,n){var e;return null===(e=this.ability)||void 0===e?void 0:e.updateEnable(t,n)},t.prototype.render=function(t,n){var e,i,r;null===(e=this.shoot)||void 0===e||e.render(t,n),null===(i=this.bomb)||void 0===i||i.render(t,n),null===(r=this.ability)||void 0===r||r.render(t,n)},t.prototype.layers=function(){var t=[];return this.shoot&&(t=t.concat(this.shoot.layers())),this.bomb&&(t=t.concat(this.bomb.layers())),this.ability&&(t=t.concat(this.ability.layers())),t},t}(),l=function(t){function n(e,i,r,o,a){var u=t.call(this,2,null)||this;return u.config=s.S,u.state=1,u.missed=!1,u.bombed=0,u.grazed=!1,u.post_grazed=!1,u.pre_miss=0,u.miss_time=0,u.invince_time=0,u.px=0,u.py=0,u.dir=0,u.prex=0,u.prey=0,u.graze_total=0,u.graze_current=0,u.magn=1,u.collideCheck=function(t){for(var n=Math.sqrt(Math.pow(u.px-u.prex,2)+Math.pow(u.py-u.prey,2)),e=Math.max(1,Math.ceil(n/2)),i=1/0,r=0;r<e;r++){var o=u.px+(u.prex-u.px)*r/e,a=u.py+(u.prey-u.py)*r/e;i=Math.min(i,t.distanceTo(o,a))}var s=u.sprite.shape.radius*u.ability.radius*u.magn;return i-s<u.ability.graze_radius&&(u.grazed=!0),i<s},n.INSTANCE=u,u.proto=i,u.ability=r,u.sprite=e,u.px=o,u.py=a,u.dir=0,u.bomb_count=r.init_bomb,u.life_count=r.init_life,u.ability_count=r.init_ability,u.renderType=2,u}return h(n,t),n.updateState=function(t){n.action=t},n.prototype.update=function(t){if(n.action){this.prex=this.px,this.prey=this.py;var e=u.n.INSTANCE.special_effects.time_rate;this.time+=e,this.px+=n.action.pos_x,this.py+=n.action.pos_y,this.px<-a.SH&&(this.px=-a.SH),this.px>a.SH&&(this.px=a.SH),this.py<-a.ZP&&(this.py=-a.ZP),this.py>a.ZP&&(this.py=a.ZP),this.dir=this.time*this.sprite.sprite.sprite.omega,this.proto.updateShoot(this,n.action.key_z),this.bombed=this.proto.updateBomb(this,n.action.key_x),this.bombed||(this.bombed=this.proto.updateAbility(this,n.action.key_c))}},n.prototype.postUpdate=function(t){this.post_grazed=this.grazed,this.grazed&&(this.graze_current<this.ability.max_graze&&(this.graze_current+=u.n.INSTANCE.special_effects.time_rate),this.graze_total++,this.graze_current>=this.ability.max_graze&&this.ability_count<this.ability.max_ability&&(this.ability_count++,this.graze_current=0),this.grazed=!1),this.miss_time>0&&this.miss_time--,this.pre_miss>0&&(this.pre_miss--,0==this.pre_miss&&(console.log("missed"),this.miss_time=this.ability.miss_time)),this.missed&&(this.missed=!1,this.pre_miss=this.ability.pre_miss),this.bombed&&(this.miss_time=this.bombed,this.bombed=0,this.pre_miss>0&&(console.log("bomb after miss"),this.pre_miss=0)),this.miss_time>0||this.pre_miss>0?(this.state=2,this.invince_time++,Math.floor(this.invince_time/6)%2==0?this.shaped_sprite=null:this.shaped_sprite=this.sprite):(this.state=1,this.invince_time=0,this.shaped_sprite=this.sprite)},n.prototype.attack=function(t,n){},n.prototype.damaged=function(t,n){return 0==this.pre_miss&&0==this.miss_time&&(this.missed=!0),n.damaged(n,this)},n.prototype.layers=function(){return function(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var i=Array(t),r=0;for(n=0;n<e;n++)for(var o=arguments[n],a=0,s=o.length;a<s;a++,r++)i[r]=o[a];return i}(this.proto.layers(),[s.$7])},n.prototype.render=function(t){var n,e=this,i=[],r=0,a=null;this.proto.render(t,this),t==s.$7&&(null===(n=this.shaped_sprite)||void 0===n?void 0:n.sprite)&&(function(t,n,s,u,c){i.push(t),i.push(n),i.push(s+Math.PI/2),i.push(c.w/2),i.push(c.h/2);var h=c.sprite;h.pushXYWH(i,e.time),i.push(1),r++,a=o.Z.get(h.sprite.sprite.path).img}(this.px,this.py,this.dir,0,this.shaped_sprite),c.setMode(0),c.drawRects(new Float32Array(i),r,a))},n.INSTANCE=null,n.action=null,n}(r.hE)},822:(t,n,e)=>{e.d(n,{n:()=>s});var i=e(869),r=e(566),o=e(68),a=function(){function t(){this.time_rate=1,this.list=[]}return t.prototype.process=function(){this.time_rate=this.list.reduce((function(t,n){return t*n.rate}),1),this.list=this.list.filter((function(t){return--t.duration>0}))},t.prototype.time_slowdown=function(t,n){this.list.push({rate:t,duration:n})},t}(),s=function(){function t(){this.groups=[],this.pending=[],this.update_stage=0,this.time=0,this.special_effects=new a,t.INSTANCE=this,this.groups.push({id:i.T,mask:i.KZ,list:[]}),this.groups.push({id:i.ZE,mask:i.DV,list:[]}),this.groups.push({id:i.yR,mask:i.P4,list:[]}),this.groups.push({id:i.A4,mask:i.k8,list:[]}),this.groups.push({id:i.t_,mask:i.Gs,list:[]}),this.groups.push({id:i.T7,mask:i.Io,list:[]})}return t.prototype.registerGroup=function(t){var n=this.groups.length;return this.groups.push({id:n,mask:t,list:[]}),n},t.prototype.add=function(t){3!=this.update_stage&&0!=this.update_stage?this.pending.push(t):this.groups[t.config.collide_group].list.push(t)},t.prototype.update=function(){var t=this;this.update_stage=1,this.groups.forEach((function(t){return t.list.forEach((function(t){return t.update(t)}))}));for(var n=0;n<this.groups.length;n++)for(var e=0;e<this.groups.length;e++)if(this.groups[n].mask&1<<e)for(var i=0,o=this.groups[n].list;i<o.length;i++){var a=o[i];if(1==a.state&&a.shaped_sprite&&a.shaped_sprite.shape)for(var s=0,u=this.groups[e].list;s<u.length;s++){var c=u[s];1==c.state&&c.shaped_sprite&&c.shaped_sprite.shape&&(0,r._R)(a,c)&&a.attack(a,c)}}this.update_stage=2,this.groups.forEach((function(t){return t.list.forEach((function(t){return t.postUpdate(t)}))})),this.groups.forEach((function(t){return t.list=t.list.filter((function(t){return 3!=t.state}))})),this.update_stage=3,this.special_effects.process(),this.pending.forEach((function(n){return t.add(n)})),this.pending=[],this.time++},t.prototype.render=function(){var t,n,e,i,r,a,s,u;return r=this,a=void 0,u=function(){var r,a,s,u,c,h,p,l,f,d,y,v;return function(t,n){var e,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=n.call(t,a)}catch(t){o=[6,t],i=0}finally{e=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(_){for(r=new Map,a=[],s=0,u=this.groups;s<u.length;s++)for(c=u[s],h=0,p=c.list;h<p.length;h++)2!=(l=p[h]).renderType?l.config.render_layer&&(null===(t=l.shaped_sprite)||void 0===t?void 0:t.sprite)&&(r.has(l.config.render_layer)||r.set(l.config.render_layer,new Map),d=r.get(l.config.render_layer),y=null===(i=null===(e=null===(n=l.shaped_sprite)||void 0===n?void 0:n.sprite)||void 0===e?void 0:e.sprite.sprite)||void 0===i?void 0:i.path,d.has(y)||d.set(y,[]),d.get(y).push(l)):(f=l,a.push(f),f.layers().forEach((function(t){return r.set(t,new Map)})));return v=[],r.forEach((function(t,n){return v.push({rl:n,v:t})})),v.sort((function(t,n){return t.rl-n.rl})),v.forEach((function(t){a.forEach((function(n){return n.render(t.rl)})),t.v.forEach((function(t,n){return o.Z.get(n).draw(t)}))})),[2]}))},new((s=void 0)||(s=Promise))((function(t,n){function e(t){try{o(u.next(t))}catch(t){n(t)}}function i(t){try{o(u.throw(t))}catch(t){n(t)}}function o(n){var r;n.done?t(n.value):(r=n.value,r instanceof s?r:new s((function(t){t(r)}))).then(e,i)}o((u=u.apply(r,a||[])).next())}))},t}()},684:(t,n,e)=>{e.d(n,{S:()=>zt,A:()=>Lt});var i={};e.r(i),e.d(i,{ability_invinc:()=>W,ability_slow:()=>H,ability_small:()=>V,ability_stop:()=>Y});var r={};e.r(r),e.d(r,{stage_000:()=>gt,stage_001:()=>xt,stage_002:()=>bt,stage_003:()=>Mt,stage_004:()=>At,stage_005:()=>Et,stage_006:()=>It,stage_007:()=>Tt,test_000:()=>Pt,test_001:()=>St,test_002:()=>Ut});var o,a,s=e(533),u=e(822),c=e(566),h=(o=function(t,n){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),p=function(t){function n(n){var e=t.call(this)||this;return e.func=n,e}return h(n,t),n.prototype.distanceTo=function(t,n,e){return Math.min(this.func(t,n,e),t.shaped_sprite.base.shape.rawDistanceTo(t.px,t.py,1,n,e),t.shaped_sprite.end.shape.rawDistanceTo(t.px+t.len*Math.cos(t.dir),t.py+t.len*Math.sin(t.dir),1,n,e))},n.line_circle=function(t,n,e){var i=t.px+t.shaped_sprite.hitbox_width*Math.cos(t.dir),r=t.py+t.shaped_sprite.hitbox_width*Math.sin(t.dir),o=t.px+(t.len-t.shaped_sprite.hitbox_width)*Math.cos(t.dir),a=t.py+(t.len-t.shaped_sprite.hitbox_width)*Math.sin(t.dir),s=Math.sqrt(Math.pow(i-o,2)+Math.pow(r-a,2)),u=Math.abs((o-i)*(r-e)-(i-n)*(a-r)),c=Math.sqrt(Math.pow(i-n,2)+Math.pow(r-e,2)),h=Math.sqrt(Math.pow(o-n,2)+Math.pow(a-e,2));return Math.pow(Math.max(c,h),2)>Math.pow(Math.min(c,h),2)+Math.pow(s,2)?Math.min(c,h)-t.shaped_sprite.hitbox_width*t.w:Math.min(u/s,c,h)-t.shaped_sprite.hitbox_width*t.w},n.double_arc=function(t,n,e){var i=n-t.px,r=e-t.py,o=i*Math.cos(-t.dir)-r*Math.sin(-t.dir),a=i*Math.sin(-t.dir)+r*Math.cos(-t.dir);return c.HC.orthDis(o-t.len/2,a,t.len/2,t.w*t.shaped_sprite.hitbox_width)},n.half_arc=function(t,n,e){var i=n-t.px,r=e-t.py,o=i*Math.cos(-t.dir)-r*Math.sin(-t.dir),a=i*Math.sin(-t.dir)+r*Math.cos(-t.dir);return o<0?Math.sqrt(Math.pow(o,2)+Math.pow(a,2)):c.HC.orthDis(o,a,t.len,t.w*t.shaped_sprite.hitbox_width)},n}(c.bn),l=function(){this.onInit=[],this.onStateChange=[],this.onUpdate=[],this.onPostMotion=[],this.onPostUpdate=[],this.onDestroy=[],this.onAttack=[],this.onContact=[]},f=(a=c.Yw,h((function(){return null!==a&&a.apply(this,arguments)||this}),a),function(t){function n(n,e,i){var r=t.call(this,n)||this;return r.state=0,r.rstate=0,r.custom_fields={},r.config=e,r.motion=i,r}return h(n,t),n.prototype.init=function(t,n,e,i){return this.len=i,this.dir=e,this.px=t,this.py=n,this.checkState(),this},n.prototype.checkState=function(){var t,n,e,i,r,o,a,s,u,c,h=this;0==this.state&&(this.state=2,null===(n=null===(t=this.config.listener)||void 0===t?void 0:t.onInit)||void 0===n||n.forEach((function(t){return t(h)})));var p=this.config.warning_time,l=this.config.open_time+p,f=this.config.alive_time+l,d=this.config.close_time+f;0==this.rstate&&this.time>=p&&(this.rstate=1,null===(i=null===(e=this.config.listener)||void 0===e?void 0:e.onStateChange)||void 0===i||i.forEach((function(t){return t(h)}))),1==this.rstate&&(this.w=Math.min(1,(this.time-p)/(l-p)),this.time>=l&&(this.rstate=2,this.state=1,this.w=1,null===(o=null===(r=this.config.listener)||void 0===r?void 0:r.onStateChange)||void 0===o||o.forEach((function(t){return t(h)})))),2==this.rstate&&this.time>=f&&(this.rstate=3,this.state=2,null===(s=null===(a=this.config.listener)||void 0===a?void 0:a.onStateChange)||void 0===s||s.forEach((function(t){return t(h)}))),3==this.rstate&&(this.w=Math.max(0,1-(this.time-f)/(d-f)),this.time>=d&&(this.state=3,null===(c=null===(u=this.config.listener)||void 0===u?void 0:u.onDestroy)||void 0===c||c.forEach((function(t){return t(h)}))))},n.prototype.update=function(t){var n,e,i,r,o,a,s=this;0==this.state&&(this.state=2,null===(e=null===(n=this.config.listener)||void 0===n?void 0:n.onInit)||void 0===e||e.forEach((function(t){return t(s)})));var c=u.n.INSTANCE.special_effects.time_rate;this.time+=c,this.checkState(),null===(r=null===(i=this.config.listener)||void 0===i?void 0:i.onUpdate)||void 0===r||r.forEach((function(t){return t(s,c)})),this.motion(this,c),null===(a=null===(o=this.config.listener)||void 0===o?void 0:o.onPostMotion)||void 0===a||a.forEach((function(t){return t(s,c)}))},n.prototype.postUpdate=function(t){var n,e,i=this;null===(e=null===(n=this.config.listener)||void 0===n?void 0:n.onPostUpdate)||void 0===e||e.forEach((function(t){return t(i)}))},n.prototype.attack=function(t,n){var e,i,r=this;null===(i=null===(e=this.config.listener)||void 0===e?void 0:e.onAttack)||void 0===i||i.forEach((function(t){return t(r,n)})),n.damaged(n,this)},n.prototype.damaged=function(t,n){var e,i,r=this;return null===(i=null===(e=this.config.listener)||void 0===e?void 0:e.onContact)||void 0===i||i.forEach((function(t){return t(r,n)})),!1},n}(function(t){function n(n){var e=t.call(this,0,n)||this;return e.w=0,e}return h(n,t),n.prototype.rectCount=function(){return 3},n.prototype.render=function(t,n){var e=this.shaped_sprite.l_ratio*this.len/2;t[10*n+0]=this.px+e*Math.cos(this.dir),t[10*n+1]=this.py+e*Math.sin(this.dir),t[10*n+2]=this.dir+Math.PI/2,t[10*n+3]=Math.max(1,this.shaped_sprite.sprite_width*this.w),t[10*n+4]=e;var i=this.shaped_sprite.sprite;i.injectXYWH(t,10*n+5,this.time),t[10*n+9]=1,n++;var r=this.shaped_sprite.base;t[10*n+0]=this.px,t[10*n+1]=this.py,t[10*n+2]=this.dir+Math.PI/2,t[10*n+3]=r.w/2,t[10*n+4]=r.h/2,(i=r.sprite).injectXYWH(t,10*n+5,this.time),t[10*n+9]=1,n++,r=this.shaped_sprite.end,t[10*n+0]=this.px+this.len*Math.cos(this.dir),t[10*n+1]=this.py+this.len*Math.sin(this.dir),t[10*n+2]=this.dir+Math.PI/2,t[10*n+3]=r.w/2,t[10*n+4]=r.h/2,(i=r.sprite).injectXYWH(t,10*n+5,this.time),t[10*n+9]=1},n}(c.hE))),d=function(){function t(t,n,e){this.sprite=t,this.sw=t.sprite.w,this.sh=t.sprite.h,this.texs=n,this.rate=e}return t.prototype.setAlternation=function(t,n){this.texs=t,this.rate=n},t.prototype.injectXYWH=function(t,n,e){var i=this.texs[Math.floor(e/this.rate)%this.texs.length],r=this.sprite.tx+i.x,o=this.sprite.ty+i.y;t[n+0]=r/this.sw,t[n+1]=o/this.sh,t[n+2]=this.sprite.tw/this.sw,t[n+3]=this.sprite.th/this.sh},t.prototype.pushXYWH=function(t,n){var e=this.texs[Math.floor(n/this.rate)%this.texs.length],i=this.sprite.tx+e.x,r=this.sprite.ty+e.y;t.push(i/this.sw),t.push(r/this.sh),t.push(this.sprite.tw/this.sw),t.push(this.sprite.th/this.sh)},t.prototype.setXYWH=function(t,n){var e=this.texs[Math.floor(n/this.rate)%this.texs.length],i=this.sprite.tx+e.x,r=this.sprite.ty+e.y;return t.tx=i/this.sw,t.ty=r/this.sh,t.tw=this.sprite.tw/this.sw,t.th=this.sprite.th/this.sh,t},t}(),y=[0,0,1,1,0,0,0,0,0,1,1,1,1,0,0],v=[1,1,1,0,0,0,1,0],_=2*Math.PI/600,m={path:"assets/bullet_000.png",w:516,h:772};function w(t){return t.tx+=.5,t.ty+=.5,t.tw-=1,t.th-=1,new d(t,[{x:0,y:0}],1)}function g(t,n,e){return w({sprite:m,tx:t<12?1+16*n:t<14?1+n%8*8:t<15?1:258+16*n,ty:t<12?1+16*t:t<14?(t<13?193:241)+8*(n>>3):n<15?515+16*n:449,tw:t<12?16:t<14?8:t<15?256:16,th:t<12?16:t<14?8:16,mode:e,category:1,type:t,color:n,omega:y[t]*_})}function x(t,n,e){return w({sprite:m,tx:(t<7?1:258)+32*n,ty:0==t?209:t<7?226+32*t:257,tw:32,th:32,mode:e,category:2,type:t,color:n,omega:v[t]*_})}function b(t,n,e){return w({sprite:m,tx:(0==t?1:258)+64*n,ty:0==t?449:290,tw:64,th:64,mode:e,category:3,type:t,color:n,omega:_})}var M=w({sprite:m,tx:258,ty:17,tw:64,th:64,mode:0,category:0,type:0,color:0,omega:_}),A=(w({sprite:m,tx:322,ty:17,tw:64,th:64,mode:0,category:0,type:1,color:0,omega:_}),w({sprite:m,tx:386,ty:81,tw:128,th:128,mode:0,category:0,type:2,color:0,omega:_})),E=[[Math.sqrt(27),0],[2.4,2.4,4,4,2.4,2.4,2.4,2.8,2.4,2.4,4,2.4,2.4,2.4,2.4,2.4],[6,7,8.5,7,6,7,0,10],[14,14]],I=.75;function T(t){return Math.sqrt(Math.pow(t,2)+Math.pow(3,2))-3}function P(t,n,e){void 0===e&&(e=1),n*=I;var i=t.sprite;return{sprite:t,shape:new c.D8(T(E[i.category][i.type])*n*e),w:i.tw*n,h:i.th*n,renderType:0}}function S(t,n,e,i,r,o,a,s){void 0===s&&(s=1);var u=g(t,n,i),c=u.sprite;return c.ty+=0==t?4:4==t||1==t?1:NaN,c.th-=0==t?8:4==t?2:1==t?1:NaN,{sprite:u,shape:new p(0==t?p.line_circle:1==t?p.half_arc:4==t?p.double_arc:null),renderType:0,sprite_width:c.tw*I/2*a,hitbox_width:T(2.4)*I*a*s,l_ratio:0==t||o>0?1:4==t?1.15:1==t?1.2:NaN,base:P(x(0,e,i),r*a,s),end:P(x(0,e,i),o*a,s)}}function N(t,n,e){var i=g(14,t,n),r=T(E[1][14])*I;return{sprite:i,shape:e,renderType:1,w:r,sp_w:i.sprite.th*I,radius:function(t,n,e){if(n<=2||e/(n-1)*16<.5||e/(n-1)*16>15.5)return-1/0;var i=((e+.5)/n-.5)*r*16,o=255*r/2;return(Math.sqrt(Math.pow(o+r,2)-Math.pow(i,2))-o)/r}}}var R=e(68),k=e(86),O=e(780),C=e(869),F=function(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var i=Array(t),r=0;for(n=0;n<e;n++)for(var o=arguments[n],a=0,s=o.length;a<s;a++,r++)i[r]=o[a];return i},U=P(A,1),D=function(){function t(t){this.special_duration=t,this.special_remain=0}return t.prototype.updateEnable=function(t,n){return this.special_remain>0&&(this.special_remain--,this.update(t)),this.special_remain>0?0:n&&t.ability_count>0&&this.onActivate(t)?(t.ability_count--,this.special_remain=this.special_duration,0):0},t.prototype.render=function(t,n){if(t==C.t4+50){var e=new O.l;k.setMode(0);var i=U.sprite,r=i.setXYWH({},n.time),o=[r.tx+r.tw/2,r.ty+r.th/2,r.tw/2,r.th/2];if(e.bind(R.Z.get(i.sprite.sprite.path).img),0==this.special_remain){var a=2*Math.PI*n.ability_count/(n.ability.max_ability+1),s=2*Math.PI*(n.graze_current/n.ability.max_graze)/(n.ability.max_ability+1),u=n.post_grazed?.7:.5,c=n.graze_current==n.ability.max_graze?u:n.post_grazed?.7:.2;e.fan(F([a,Math.PI/2,n.px,n.py,U.w/2,Math.PI/6],o,[u]),32),e.fan(F([s,Math.PI/2+a,n.px,n.py,U.w/2,Math.PI/6+a],o,[c]),32)}else a=2*Math.PI*this.special_remain/this.special_duration,e.fan(F([a,-a+Math.PI/2,n.px,n.py,U.w/2,-a+Math.PI/6],o,[1]),32);e.flush()}},t.prototype.layers=function(){return[C.t4+50]},t}(),j=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),B=function(t){function n(){return t.call(this,240)||this}return j(n,t),n.prototype.update=function(){},n.prototype.onActivate=function(){return u.n.INSTANCE.special_effects.time_slowdown(.5,240),!0},n}(D),H={name:"slow",init:function(){return new B}},L=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),z=function(t){function n(){return t.call(this,120)||this}return L(n,t),n.prototype.update=function(){},n.prototype.onActivate=function(){return u.n.INSTANCE.special_effects.time_slowdown(0,120),!0},n}(D),Y={name:"stop",init:function(){return new z}},X=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),Z=function(t){function n(){return t.call(this,30)||this}return X(n,t),n.prototype.update=function(t){t.magn=this.special_remain>0?-1/0:1},n.prototype.onActivate=function(){return!0},n}(D),W={name:"invincibility",init:function(){return new Z}},q=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),G=function(t){function n(){return t.call(this,300)||this}return q(n,t),n.prototype.update=function(t){t.magn=this.special_remain>0?0:1},n.prototype.onActivate=function(){return!0},n}(D),V={name:"small hitbox",init:function(){return new G}},K=e(349),$=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),J=function(){this.onInit=[],this.onUpdate=[],this.onPostMotion=[],this.onPostUpdate=[],this.onExitScreen=[],this.onDestroy=[],this.onDamaged=[],this.onAttack=[]},Q={render_layer:C.bm,collide_group:C.A4,collide_mask:C.A4,init_stall:0,exit_margin:0,kill_on_exit:!0,damaged_by:function(t){return t==C.t_||t==C.T},auto_direction:!0,lifetime:0,damage_info:null,listener:null},tt=function(t,n){return!0},nt=function(t){function n(n,e){var i=t.call(this,n)||this;return i.state=0,i.motion=tt,i.custom_fields={},i.config=e,i}return $(n,t),n.prototype.setMotion=function(t){return this.motion=t,this.simpleInit(0,0,0,0)},n.prototype.simpleInit=function(t,n,e,i){return this.px=t,this.py=n,this.vx=e*Math.cos(i),this.vy=e*Math.sin(i),this.dir=i,this.motion(this,0)&&this.config.auto_direction&&(this.dir=Math.atan2(this.vy,this.vx)),this},n.prototype.init=function(t){return t(this),this},n.prototype.update=function(t){var n,e,i,r,o,a,s,c,h=this;0==this.state&&(this.state=1,null===(e=null===(n=this.config.listener)||void 0===n?void 0:n.onInit)||void 0===e||e.forEach((function(t){return t(h)})));var p=u.n.INSTANCE.special_effects.time_rate;this.time+=p,null===(r=null===(i=this.config.listener)||void 0===i?void 0:i.onUpdate)||void 0===r||r.forEach((function(t){return t(h,p)})),this.motion(this,p)&&(this.time>this.config.init_stall&&(this.px+=this.vx*p,this.py+=this.vy*p),this.config.auto_direction&&(this.dir=Math.atan2(this.vy,this.vx))),(null===(a=null===(o=this.shaped_sprite)||void 0===o?void 0:o.sprite)||void 0===a?void 0:a.sprite.omega)&&(this.dir=this.time*this.shaped_sprite.sprite.sprite.omega),null===(c=null===(s=this.config.listener)||void 0===s?void 0:s.onPostMotion)||void 0===c||c.forEach((function(t){return t(h,p)}))},n.prototype.postUpdate=function(t){var n,e,i,r,o,a,s,u,c=this,h=(null===(e=null===(n=this.shaped_sprite)||void 0===n?void 0:n.shape)||void 0===e?void 0:e.exitScreen(this))+this.config.exit_margin,p=this.px>K.SH+h,l=-this.px>K.SH+h,f=this.py>K.ZP+h,d=-this.py>K.ZP+h;this.motion||(p&&(p=this.vx>0),l&&(l=this.vx<0),f&&(f=this.vy>0),d&&(d=this.vy<0)),(p||l||f||d)&&this.config.kill_on_exit&&(this.state=2,null===(r=null===(i=this.config.listener)||void 0===i?void 0:i.onExitScreen)||void 0===r||r.forEach((function(t){return t(c)}))),this.config.lifetime&&this.time>=this.config.lifetime&&(this.state=2),null===(a=null===(o=this.config.listener)||void 0===o?void 0:o.onPostUpdate)||void 0===a||a.forEach((function(t){return t(c)})),2==this.state&&(null===(u=null===(s=this.config.listener)||void 0===s?void 0:s.onDestroy)||void 0===u||u.forEach((function(t){return t(c)})),this.state=3)},n.prototype.attack=function(t,n){var e,i,r=this;null===(i=null===(e=this.config.listener)||void 0===e?void 0:e.onAttack)||void 0===i||i.forEach((function(t){return t(r,n)})),n.damaged(n,this)},n.prototype.damaged=function(t,n){var e,i,r=this;return!!this.config.damaged_by(n.config.collide_group)&&(this.state=2,null===(i=null===(e=this.config.listener)||void 0===e?void 0:e.onDamaged)||void 0===i||i.forEach((function(t){return t(r,n)})),!0)},n}(c.eY),et=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),it=function(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var i=Array(t),r=0;for(n=0;n<e;n++)for(var o=arguments[n],a=0,s=o.length;a<s;a++,r++)i[r]=o[a];return i},rt=function(){},ot=function(t){function n(n){var e=t.call(this)||this;return e.remain=n,e}return et(n,t),n.prototype.update=function(t){return this.remain-=t,this.remain<0?-this.remain:0},n}(rt),at=function(t){function n(n){var e=t.call(this)||this;return e.time=0,e.init=n,e}return et(n,t),n.random=function(t,e){return function(){return new n((function(n){var i=Math.max(e.px0-t.px,-e.dx1),r=Math.min(e.px1-t.px,e.dx1),o=Math.max(e.py0-t.py,-e.dy1),a=Math.min(e.py1-t.py,e.dy1),s=i+Math.random()*(r-i),u=o+Math.random()*(a-o);n.target=t,n.duration=e.duration,n.dx=s,n.dy=u,n.x0=t.px,n.y0=t.py,n.ease=e.ease}))}},n.prototype.update=function(t){0==this.time&&this.init(this),this.time+=t;var n=Math.min(1,this.time/this.duration),e=this.ease(n);return this.target.px=this.x0+this.dx*e,this.target.py=this.y0+this.dy*e,this.time>this.duration?this.time-this.duration:0},n}(rt),st=function(t){function n(n){var e=t.call(this)||this;return e.todo=n,e}return et(n,t),n.prototype.update=function(t,n){var e=this.todo();return void 0===e?t:"number"==typeof e?(n.list[0]=new ot(e),n.list[0].update(t,n)):(n.list.unshift(n.list[0]),n.list[1]=e,t)},n}(rt),ut=function(){};function ct(t){return t.map((function(t){return"number"==typeof t?new ot(t):"function"==typeof t?new st(t):t}))}var ht=function(t){function n(n,e){var i=t.call(this)||this;return i.index=0,i.todo=n,i.total=e,i}return et(n,t),n.prototype.supply=function(){return this.index>=this.total?null:(t="function"==typeof this.todo?this.todo(this.index):this.todo,this.index++,ct(t));var t},n}(ut),pt={render_layer:C.NH,collide_group:C.T7,collide_mask:C.Io,damage_info:null},lt=function(t){function n(n){var e=t.call(this)||this;return e.custom_fields={},e.config=pt,e.state=0,e.list=ct("object"==typeof n?n:n(e)),e}return et(n,t),n.prototype.init=function(t){return t(this),this},n.prototype.update=function(t){0==this.state&&(this.state=1);var n=u.n.INSTANCE.special_effects.time_rate;for(this.time+=n;this.list.length>0&&n;){var e=this.list[0];if(e instanceof ut){var i=e.supply();i&&i.length?this.list=it(i,this.list):this.list.shift()}else(n=e.update(n,this))>0&&this.list.shift()}0==this.list.length&&(this.state=2)},n.prototype.postUpdate=function(t){2==this.state&&(this.state=3)},n.prototype.attack=function(t){},n.prototype.damaged=function(t,n){return!1},n}(c.u5),ft={w0:-K.SH,w1:K.SH,h0:-K.ZP,h1:K.ZP,max:1/0,inner_bound:!0,outer_bound:!1},dt=function(t){return function(n){n.onInit.push((function(n){var e=n.custom_fields;e.in_screen=n.px>t.w0&&n.px<t.w1&&n.py>t.h0&&n.py<t.h1,e.ref_count=0})),n.onPostMotion.push((function(n,e){var i=n.custom_fields,r=i.in_screen;i.in_screen=n.px>t.w0&&n.px<t.w1&&n.py>t.h0&&n.py<t.h1,r&&!i.in_screen&&t.inner_bound&&(i.ref_count<t.max&&n.px<=t.w0&&(i.ref_count++,n.vx=-n.vx,n.px=2*t.w0-n.px),i.ref_count<t.max&&n.px>=t.w1&&(i.ref_count++,n.vx=-n.vx,n.px=2*t.w1-n.px),i.ref_count<t.max&&n.py<=t.h0&&(i.ref_count++,n.vy=-n.vy,n.py=2*t.h0-n.py),i.ref_count<t.max&&n.py>=t.h1&&(i.ref_count++,n.vy=-n.vy,n.py=2*t.h1-n.py),n.dir=Math.atan2(n.vy,n.vx),i.in_screen=!0),!r&&i.in_screen&&t.outer_bound&&(i.ref_count<t.max&&n.px>=t.w0&&(i.ref_count++,n.vx=-n.vx,n.px=2*t.w0-n.px),i.ref_count<t.max&&n.px<=t.w1&&(i.ref_count++,n.vx=-n.vx,n.px=2*t.w1-n.px),i.ref_count<t.max&&n.py>=t.h0&&(i.ref_count++,n.vy=-n.vy,n.py=2*t.h0-n.py),i.ref_count<t.max&&n.py<=t.h1&&(i.ref_count++,n.vy=-n.vy,n.py=2*t.h1-n.py),n.dir=Math.atan2(n.vy,n.vx),i.in_screen=!1)}))}},yt={name:"",w0:-K.SH,w1:K.SH,h0:-K.ZP,h1:K.ZP,max:1/0,maxlen:NaN,v:NaN,body:null,cf:null},vt=function(t,n){return void 0===n&&(n=1/0),function(){return new ht(t,n)}},_t=function(t){return function(){return u.n.INSTANCE.add(new lt(t))}};function mt(t,n,e,i){var r=wt[i],o=S(4,r,i,1,0,.5,1),a=S(4,r,i,1,0,1,1),s={render_layer:Q.render_layer,collide_group:Q.collide_group,collide_mask:Q.collide_mask,warning_time:0,open_time:0,alive_time:1/0,close_time:0,listener:null,damage_info:null},c=(0,C.d9)(s);s.listener=new l;var h,p=(0,C.d9)(yt);return p.max=e,p.v=t,p.maxlen=n,p.body=a,p.cf=c,(h=p,function(t){var n=function(t,n){var e=t.custom_fields;if(e.togrow>0){var i=Math.min(e.togrow,h.v*n);n-=i/h.v,t.len+=i,e.togrow-=i}n>0&&(t.px+=n*e.vx,t.py+=n*e.vy),t.shaped_sprite.end.shape.rawExitScreen(t.px+t.len*Math.cos(t.dir),t.py+t.len*Math.sin(t.dir),t.shaped_sprite.base,K.SH,K.ZP)&&t.shaped_sprite.base.shape.rawExitScreen(t.px,t.py,t.shaped_sprite.base,K.SH,K.ZP)&&(t.state=3)},e=function(t,n){return t>h.w0&&t<h.w1&&n>h.h0&&n<h.h1},i=function(t,n){var e=t.custom_fields;if(e.toshrink>0){var i=Math.min(e.toshrink,h.v*n);t.len-=i,e.toshrink-=i,e.toshrink<=0&&(t.state=3)}e.togrow>0&&(n-=(i=Math.min(e.togrow,h.v*n))/h.v,t.len+=i,e.togrow-=i),n>0&&(t.px+=n*e.vx,t.py+=n*e.vy),t.shaped_sprite.base.shape.rawExitScreen(t.px,t.py,t.shaped_sprite.base,K.SH,K.ZP)&&(t.state=3)};t.onInit.push((function(t){var e=t.custom_fields;e.ref_count=0,e.vx=h.v*Math.cos(t.dir),e.vy=h.v*Math.sin(t.dir),e.togrow=h.maxlen,e.toshrink=0,t.motion=n})),t.onPostMotion.push((function(t,n){var r=t.custom_fields,o=(e(t.px,t.py),t.px+t.len*Math.cos(t.dir)),a=t.py+t.len*Math.sin(t.dir);if(!e(o,a)&&r.ref_count<h.max){var s=new f(h.body,h.cf,i);s.init(t.px,t.py,t.dir,t.len);var c=s.custom_fields;c.vx=r.vx,c.vy=r.vy,c.togrow=r.togrow,u.n.INSTANCE.add(s);var p=0,l=0;r.ref_count<h.max&&o<=h.w0&&(p=h.w0,l=t.py+(h.w0-t.px)*r.vy/r.vx,r.ref_count++,r.vx=-r.vx,t.px=2*h.w0-t.px),r.ref_count<h.max&&o>=h.w1&&(p=h.w1,l=t.py+(h.w1-t.px)*r.vy/r.vx,r.ref_count++,r.vx=-r.vx,t.px=2*h.w1-t.px),r.ref_count<h.max&&a<=h.h0&&(l=h.h0,p=t.px+(h.h0-t.py)*r.vx/r.vy,r.ref_count++,r.vy=-r.vy,t.py=2*h.h0-t.py),r.ref_count<h.max&&a>=h.h1&&(l=h.h1,p=t.px+(h.h1-t.py)*r.vx/r.vy,r.ref_count++,r.vy=-r.vy,t.py=2*h.h1-t.py);var d=Math.sqrt(Math.pow(t.px-p,2)+Math.pow(t.py-l,2));t.len-=d,t.px=p,t.py=l,r.togrow+=d,s.len=d,c.toshrink=d+c.togrow,t.dir=Math.atan2(r.vy,r.vx)}}))})(s.listener),[o,s,p]}var wt=[0,2,4,6,8,10,13,15],gt={name:"波与粒的境界",default_scale:3,init:function(t){var n=P(x(5,1,0),1);return[new lt([30*t,vt((function(e){return[vt((function(i){return[function(){return u.n.INSTANCE.add(new nt(n,Q).simpleInit(0,0,8/t,.003/t*e*e+2*Math.PI/5*i))}]}),5),1*t]}),1/0)])]}},xt={name:"龙纹弹",default_scale:3,init:function(t){var n=function(t){return P(g(1,t,0),1)},e=(0,C.d9)(Q);e.lifetime=180*t,e.kill_on_exit=!1;var i={duration:100*t,px0:-96,px1:96,py0:32,py1:112,dx1:64,dy1:64,ease:function(t){return(1-Math.cos(Math.PI*t))/2}},r=1*t,o=3/t,a=-o/70,s=.06/t,c=new nt(P(A,2),Q).setMotion((function(t){return t.dir=t.time*Math.PI*2/600,!1})).simpleInit(0,64,0,0),h=null,p=function(t,n,i,p){return u.n.INSTANCE.add(new lt([vt((function(l){return[function(){return u.n.INSTANCE.add(h=new nt(null,e).simpleInit(c.px,c.py,o,2*Math.PI/47*l*n*t))},vt((function(n){return[function(){return u.n.INSTANCE.add(new nt(l%2==0?i:p,Q).setMotion((e=h,r=2*Math.PI/30*n,o=s*t,70,c=a,function(t,n){var i=r+o*t.time,a=70*Math.sin(c*t.time);return t.px=e.px+a*Math.cos(i),t.py=e.py+a*Math.sin(i),t.dir=Math.atan2(a*o,70*c*Math.cos(c*t.time))+i,!1})));var e,r,o,c}]}),30),r]}),47)]))};return[new lt([function(){return u.n.INSTANCE.add(c)},30*t,vt((function(e){return[function(){return p(e%2*2-1,7,n(2),n(10))},50*t,function(){return p(e%2*2-1,5,n(13),n(6))},50*t,function(){return p(e%2*2-1,1,n(8),n(4))},at.random(c,i)]}))])]}},bt={name:"rotating long bullet",default_scale:3,init:function(t){var n=function(t,n,e,i){void 0===i&&(i=1);var r=g(4,2,0);return{sprite:r,shape:new c.HC(64,T(E[1][4])*I*i),renderType:0,w:r.sprite.tw*I,h:80}}(),e=(0,C.d9)(Q);e.auto_direction=!1;var i={duration:50*t,px0:-96,px1:96,py0:32,py1:112,dx1:64,dy1:64,ease:function(t){return(1-Math.cos(Math.PI*t))/2}},r=new nt(P(A,2),Q).setMotion((function(t){return t.dir=t.time*Math.PI*2/600,!1})).simpleInit(0,64,0,0),o=function(t){return vt((function(i){return[function(){return u.n.INSTANCE.add(new nt(n,e).setMotion((function(n,e){return n.dir+=e*t,!0})).simpleInit(r.px,r.py,p,l+2*Math.PI/a*i).init((function(t){return t.dir+=2*Math.PI*s/a*i})))}]}),a)},a=50,s=2.5,h=2*Math.PI/60/t,p=6/t,l=0;return[r,new lt([30*t,vt((function(n){return[function(){return l=Math.random()*Math.PI*2},o(h),20*t,o(-h),at.random(r,i)]}))])]}},Mt={name:"reflect and delayed altering",default_scale:3,init:function(t){var n=P(g(4,2,0),1),e=(0,C.d9)(Q);e.listener=new J;var i=(0,C.d9)(ft);i.max=100,dt(i)(e.listener);var r=Math.PI/24,o=6/t,a=100*t,s=1*t,c=1*t,h={duration:a-40*c-20*s,px0:-96,px1:96,py0:32,py1:112,dx1:64,dy1:64,ease:function(t){return(1-Math.cos(Math.PI*t))/2}},p=new nt(P(A,2),Q).setMotion((function(t){return t.dir=t.time*Math.PI*2/600,!1})).simpleInit(0,64,0,0),l=0;return[p,new lt([30*t,vt((function(t){return[function(){return l=Math.random()*Math.PI*2},vt((function(t){return[_t([vt((function(){return[function(){return u.n.INSTANCE.add(new nt(n,e).setMotion((function(n,e){var s,u=a-t*c;return n.time-e<u&&n.time>=u&&((s=i,function(t){return t.custom_fields.ref_count=s.max})(n),n.simpleInit(n.px,n.py,o,n.dir+(2*Math.random()-1)*r)),!0})).simpleInit(p.px,p.py,o,l+2*Math.PI/40*t))},s]}),20)]),c]}),40),20*s,at.random(p,h)]}))])]}},At={name:"finite reflect",default_scale:3,init:function(t){var n=[P(g(4,2,0),1),P(g(4,6,0),1)],e=(0,C.d9)(Q),i=(0,C.d9)(Q);e.listener=new J,i.listener=new J;var r=(0,C.d9)(ft),o=(0,C.d9)(ft);r.max=2,r.h0=-1/0,o.max=1,o.h0=-1/0,dt(r)(e.listener),dt(o)(i.listener);var a=6/t,s=1*t,c=3*t,h={duration:40*t,px0:-96,px1:96,py0:32,py1:112,dx1:64,dy1:64,ease:function(t){return(1-Math.cos(Math.PI*t))/2}},p=new nt(P(A,2),Q).setMotion((function(t){return t.dir=t.time*Math.PI*2/600,!1})).simpleInit(0,64,0,0),l=0,f=function(t,n,e,i){return vt((function(r){return[_t([vt((function(o){return[vt((function(s){return[function(){return u.n.INSTANCE.add(new nt(t,i).simpleInit(p.px,p.py,a,l+e*Math.PI*2*(r/8/4+s/4+o/4/8/n*.5)))}]}),8),s]}),n)]),c]}),8)};return[p,new lt([30*t,vt((function(t){return[function(){return l=Math.random()*Math.PI*2},f(n[0],10,1,e),10*s,at.random(p,h),f(n[1],15,-1,i),20*s,at.random(p,h)]}))])]}},Et={name:"reflect laser",default_scale:3,init:function(t){var n=[mt(8/t,128,2,3),mt(8/t,128,2,1)],e=2*Math.PI/t,i=t,r=function(t,e,i,r,o,a){return vt((function(t){return[vt((function(o){return[function(){return u.n.INSTANCE.add(new f(n[e][0],n[e][1],null).init(0,0,a+2*Math.PI/i*o+r*t,0))}]}),i),o]}),t)};return[new lt([30*t,vt((function(n){return[r(20,0,3,(n%2*2-1)*e*.0678,6*i,2*Math.random()*Math.PI),100*t,r(120,1,1,(n%2*2-1)*e*.0234,i,2*Math.random()*Math.PI),100*t]}))])]}},It={name:"Test Special Effect",default_scale:1,init:function(t){var n=P(g(1,2,0),1),e=P(g(1,1,0),1),i=P(b(0,0,1),1),r=Q,o=(0,C.d9)(Q);o.lifetime=160*t,o.kill_on_exit=!1,o.damaged_by=function(){return!1};var a=6/t,c=.4*a,h=2*t,p=6*t,l=Math.PI/3;return[new lt([30*t,vt((function(f){return[function(){return u.n.INSTANCE.special_effects.time_slowdown(1/4,4*(8*p+160/a))},(d=f%2*2-1,y=l,void 0===v&&(v=Math.PI/2),vt((function(t){return[_t((function(p,l){return void 0===l&&(l=p.custom_fields),[function(){l.a1=v+2*Math.PI*t/8*d;var n=l.a1+Math.PI/2*d;u.n.INSTANCE.add(l.host=new nt(i,o).simpleInit(160*Math.cos(l.a1)-240*Math.cos(n),160*Math.sin(l.a1)-240*Math.sin(n),a,n))},_t([vt((function(){return[vt((function(t){return[vt((function(n){return[function(){return u.n.INSTANCE.add(new nt(e,r).simpleInit(l.host.px,l.host.py,c*(2+t)/4,l.a1+(n-1)*Math.PI/3))}]}),3)]}),3),h]}),Math.round(480/a/h))]),Math.round(80/a),function(){l.plx=s.U.INSTANCE.px,l.ply=s.U.INSTANCE.py},vt((function(){return[function(){l.dir=Math.atan2(l.ply-l.host.py,l.plx-l.host.px)},vt((function(t){return[vt((function(e){return[function(){return u.n.INSTANCE.add(new nt(n,r).simpleInit(l.host.px,l.host.py,c*(2+t)/4,l.dir+(e-1)*y))}]}),3)]}),3),h]}),Math.round(320/a/h))]})),p]}),8)),300*t];var d,y,v}))])]}},Tt={name:"aligned rotation",default_scale:1,init:function(t){var n=P(g(3,6,0),1),e=(0,C.d9)(Q);e.exit_margin=100;var i=1/t,r=2*Math.PI/4800/t,o=-r,a=Math.PI/2,s=2*Math.PI/4800/t,c=25*t,h=function(t,n,e){return function(u,c){var h=Math.sin(t.time*r)*a+2*Math.PI/6*n,p=Math.cos(t.time*o)*a+2*Math.PI/6*e,l=150-50*Math.cos(t.time*s);return u.px=l*Math.cos(h)+i*u.time*Math.cos(p),u.py=l*Math.sin(h)+i*u.time*Math.sin(p),u.dir=p,!1}};return[new lt((function(i){return[60*t,vt((function(t){return[function(){for(var t=0;t<6;t++)for(var r=0;r<6;r++)u.n.INSTANCE.add(new nt(n,e).setMotion(h(i,t,r)))},c]}))]}))]}},Pt={name:"RayLaser Hitbox Test",default_scale:3,init:function(t){var n=function(t,n,e){return S(t,2,1,1,n,e,1)},e=[n(0,0,0),n(0,1,1),n(0,0,1),n(0,1,0),n(4,0,0),n(4,1,1),n(4,0,1),n(4,1,0),n(1,0,0),n(1,1,0)],i={render_layer:Q.render_layer,collide_group:Q.collide_group,collide_mask:Q.collide_mask,warning_time:30*t,open_time:10*t,alive_time:6e3*t,close_time:10*t,listener:null,damage_info:null},r=0*Math.PI*2/240/t;return[new lt([30*t,vt((function(n){return[vt((function(t){return[function(){return u.n.INSTANCE.add(new f(e[t],i,(o=r*(n%2*2-1),function(t,n){return t.dir+=n*o})).init(50*Math.cos(2*Math.PI/10*t),50*Math.sin(2*Math.PI/10*t),2*Math.PI/10*t,100));var o}]}),10),6e3*t]}))])]}},St={name:"Local Variable Test",default_scale:1,init:function(t){var n=(0,C.d9)(Q);n.listener=new J,n.listener.onAttack.push((function(t){return t.custom_fields.callback()}));var e=[[P(g(3,6,0),1),P(b(0,1,1),1)],[P(g(3,2,0),1),P(b(0,0,1),1)],[P(g(3,13,0),1),P(b(0,3,1),1)],[P(g(3,10,0),1),P(b(0,2,1),1)]],i={duration:40*t,px0:-96,px1:96,py0:32,py1:112,dx1:64,dy1:64,ease:function(t){return(1-Math.cos(Math.PI*t))/2}},r=2.5/t;return[new lt([60*t,vt((function(o){return[_t((a=o,function(t,o){return void 0===o&&(o=t.custom_fields),[function(){var t=Math.random()*Math.PI*2;o.px=50*Math.cos(t),o.py=64+50*Math.sin(t),o.count=0},vt([vt((function(t){return[function(){return u.n.INSTANCE.add(new nt(0==o.count?e[a][0]:e[a][1],n).simpleInit(o.px,o.py,r,2*Math.PI/40*t).init((function(t,n){void 0===n&&(n=t.custom_fields),n.callback=function(){return o.count++}})))}]}),40),function(){return o.count=0},at.random(o,i)])]})),150*t];var a}),4)])]}},Nt=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),Rt=(function(t){function n(){return null!==t&&t.apply(this,arguments)||this}Nt(n,t),n.prototype.distanceTo=function(t,n,e){var i=this;return t.getStat().list.reduce((function(r,o){return Math.min(r,i._distanceTo(t,o.start,o.len,n,e))}),1/0)}}(c.bn),function(t){Nt((function(){return null!==t&&t.apply(this,arguments)||this}),t)}(c.Yw),function(){function t(){this.exist=!1,this.list=[],this.start=-1,this.count=0}return t.prototype.reduce=function(t,n){return t&&1==t.state?(this.exist||(this.start=n),this.exist=!0,this.count++):this.exist&&(this.exist=!1,this.list.push({start:this.start,len:this.count}),this.count=0),this},t}()),kt=function(t){function n(n){var e=t.call(this,1,n)||this;return e.list=[],e}return Nt(n,t),n.prototype.getStat=function(){return this.list.reduce((function(t,n,e){return t.reduce(n,e)}),new Rt).reduce(null,0)},n.prototype.preRender=function(){return{curve:this,list:this.getStat().list}},n.prototype.getSprite=function(){return this.shaped_sprite},n}(c.hE),Ot=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),Ct={collide_group:C.T7,collide_mask:C.Io,render_layer:C.bm,damage_info:null,kill_on_empty:!0,protect:0,life:0},Ft=function(t){function n(n,e){var i=t.call(this,n)||this;return i.state=0,i.config=e,i}return Ot(n,t),n.prototype.add=function(t){return this.list.push(t),t},n.prototype.update=function(t){0==this.state&&(this.state=1);var n=u.n.INSTANCE.special_effects.time_rate;this.time+=n;for(var e=0,i=this.getStat().list;e<i.length;e++)for(var r=i[e],o=0;o<r.len;o++)this.list[o+r.start].magn=this.shaped_sprite.radius(r.start,r.len,o)},n.prototype.attack=function(t,n){},n.prototype.postUpdate=function(t){for(;this.list.length&&3==this.list[0].state;)this.list.shift();this.time>this.config.protect&&this.config.kill_on_empty&&!this.list.length&&(this.state=3)},n.prototype.damaged=function(t,n){return!1},n.prototype.distanceTo=function(t,n){return 1/0},n}(kt),Ut={name:"curve test",default_scale:1,init:function(t){var n=P(g(9,2,0),1),e=[N(1,1,null),N(12,1,null)],i=(0,C.d9)(Q),r=(0,C.d9)(Ct);i.init_stall=5*t,i.exit_margin=100,n.sprite=null;var o=2.5/t,a=2*Math.PI*.3,s=2*Math.PI/240/t,c=140*t,h=5*t,p=.17*Math.PI,l=function(t,n,e){return function(i,r){var a=t+n*Math.sin(i.time*e+p);return i.vx=o*Math.cos(a),i.vy=o*Math.sin(a),!0}};return[new lt([60*t,vt((function(t){return[_t((function(c,p){return void 0===p&&(p=c.custom_fields),[function(){p.n=Math.min(24,Math.floor(12+t/4)),p.a0=2*Math.PI*Math.random()},_t((function(c,f){return void 0===f&&(f=c.custom_fields),[function(){f.curve=[];for(var n=0;n<p.n;n++){var i=new Ft(e[t%2],r);u.n.INSTANCE.add(i),f.curve.push(i)}},vt((function(){return[function(){for(var e=0;e<p.n;e++){var r=p.a0+(Math.floor((t+1)/2)%2*2-1)*Math.PI*2/p.n*e,c=new nt(n,i);c.setMotion(l(r,(Math.floor((t+1)/2)%2*2-1)*a,(t%2*2-1)*s)),c.simpleInit(0,0,o,r),f.curve[e].add(c),u.n.INSTANCE.add(c)}},h]}),32)]}))]})),c]}))])]}},Dt=Object.values(i),jt=Object.values(r),Bt=e(506),Ht={radius:1,pre_miss:30,miss_time:60,graze_radius:24,max_graze:600,init_bomb:3,init_life:3,init_ability:5,max_bomb:10,max_life:10,max_ability:5},Lt={init:zt,stage:6,scale:1,ability:1,stage_list:jt,ability_list:Dt};function zt(){return t=this,n=void 0,i=function(){var t;return function(t,n){var e,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=n.call(t,a)}catch(t){o=[6,t],i=0}finally{e=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(n){switch(n.label){case 0:return[4,R.Z.get(m.path).load()];case 1:return n.sent(),(t=new u.n).add(new s.U(P(M,1),new s.f(null,null,Dt[Lt.ability].init()),Ht,0,-192)),jt[Lt.stage].init(Lt.scale).forEach((function(n){return t.add(n)})),Bt.Mw.pool=t,Bt.Mw.stage=Lt,[2]}}))},new((e=void 0)||(e=Promise))((function(r,o){function a(t){try{u(i.next(t))}catch(t){o(t)}}function s(t){try{u(i.throw(t))}catch(t){o(t)}}function u(t){var n;t.done?r(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,s)}u((i=i.apply(t,n||[])).next())}));var t,n,e,i}},566:(t,n,e)=>{e.d(n,{bn:()=>a,D8:()=>u,HC:()=>c,Yw:()=>h,hE:()=>p,eY:()=>l,u5:()=>f,_R:()=>d});var i,r,o=(i=function(t,n){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}i(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),a=function(){},s=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return o(n,t),n}(a),u=function(t){function n(n){var e=t.call(this)||this;return e.radius=n,e}return o(n,t),n.prototype.exitScreen=function(t){var n=Math.sqrt(Math.pow(t.shaped_sprite.w,2)+Math.pow(t.shaped_sprite.h,2));return Math.max(0,n*t.magn)},n.prototype.distanceTo=function(t,n,e){return Math.sqrt(Math.pow(n-t.px,2)+Math.pow(e-t.py,2))-this.radius*t.magn},n.prototype.rawDistanceTo=function(t,n,e,i,r){return Math.sqrt(Math.pow(i-t,2)+Math.pow(r-n,2))-this.radius*e},n.prototype.rawExitScreen=function(t,n,e,i,r){var o=Math.sqrt(Math.pow(e.w,2)+Math.pow(e.h,2));return Math.abs(t)>i+o||Math.abs(n)>r+o},n}(s),c=function(t){function n(n,e){var i=t.call(this)||this;return i.len=n,i.rad=e,i}return o(n,t),n.orthDis=function(t,n,e,i){var r=i/2;t=Math.abs(t);var o=e*e/r/2+r/2-r;return(n=Math.abs(n))>=0&&e*(n+o)>t*o?Math.sqrt(Math.pow(t,2)+Math.pow(n+o,2))-o-r:Math.sqrt(Math.pow(t-e,2)+Math.pow(n,2))-r},n.prototype.exitScreen=function(t){return Math.sqrt(Math.pow(t.shaped_sprite.w,2)+Math.pow(t.shaped_sprite.h,2))*t.magn},n.prototype.distanceTo=function(t,e,i){var r=e-t.px,o=i-t.py,a=r*Math.cos(-t.dir)-o*Math.sin(-t.dir),s=r*Math.sin(-t.dir)+o*Math.cos(-t.dir);return n.orthDis(a,s,this.len/2*t.magn,this.rad*t.magn)},n}(s),h=function(){},p=(o((function(){return null!==r&&r.apply(this,arguments)||this}),r=h),function(){function t(t,n){this.time=0,this.collideCheck=null,this.renderType=t,this.shaped_sprite=n}return t.prototype.distanceTo=function(t,n){var e;return(null===(e=this.shaped_sprite)||void 0===e?void 0:e.shape)?this.shaped_sprite.shape.distanceTo(this,t,n):1/0},t}()),l=function(t){function n(n){var e=t.call(this,0,n)||this;return e.magn=1,e.alpha=1,e}return o(n,t),n.prototype.rectCount=function(){return 1},n.prototype.render=function(t,n){t[10*n+0]=this.px,t[10*n+1]=this.py,t[10*n+2]=this.dir+Math.PI/2,t[10*n+3]=this.shaped_sprite.w/2*this.magn,t[10*n+4]=this.shaped_sprite.h/2*this.magn,this.shaped_sprite.sprite.injectXYWH(t,10*n+5,this.time),t[10*n+9]=this.alpha},n}(p),f=function(t){function n(){return t.call(this,null,null)||this}return o(n,t),n}(p);function d(t,n){if(t.collideCheck)return t.collideCheck(n);if(n.collideCheck)return n.collideCheck(t);if(t instanceof l&&t.shaped_sprite.shape instanceof u)return n.distanceTo(t.px,t.py)<t.shaped_sprite.shape.radius;if(n instanceof l&&n.shaped_sprite.shape instanceof u)return d(n,t);throw new Error("non-circle non-circle collision not found")}},68:(t,n,e)=>{e.d(n,{Z:()=>r});var i=e(86),r=function(){function t(t){this.img=null,this.path=t}return t.prototype.loaded=function(){return this.img},t.prototype.load=function(){return t=this,n=void 0,r=function(){var t;return function(t,n){var e,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=n.call(t,a)}catch(t){o=[6,t],i=0}finally{e=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(n){switch(n.label){case 0:return[4,i.loadImage(this.path)];case 1:return t=n.sent(),this.img=i.loadTexture(t),[2]}}))},new((e=void 0)||(e=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var n;t.done?i(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,s)}u((r=r.apply(t,n||[])).next())}));var t,n,e,r},t.get=function(n){return t.INS[n]?t.INS[n]:t.INS[n]=new t(n)},t.prototype.draw=function(t){this.drawRect(t,0),this.drawRect(t,1),this.drawCurve(t,0),this.drawCurve(t,1)},t.prototype.drawRect=function(t,n){var e=t.reduce((function(t,e){return 0==e.renderType&&e.shaped_sprite.sprite.sprite.mode==n?t+e.rectCount():t}),0);if(e){i.setMode(n);for(var r=new Float32Array(10*e),o=0,a=0,s=t;a<s.length;a++){var u=s[a];if(0==u.renderType&&u.shaped_sprite.sprite.sprite.mode==n){var c=u;c.render(r,o),o+=c.rectCount()}}i.drawRects(r,e,this.img)}},t.prototype.drawCurve=function(t,n){var e=t.filter((function(t){return 1==t.renderType&&t.shaped_sprite.sprite.sprite.mode==n})).map((function(t){return t.preRender()})),r=e.reduce((function(t,n){return n.list.reduce((function(t,n){return n.len<=1?t:t+n.len}),t)}),0);if(0!=r){i.setMode(n);for(var o=new Float32Array(2*r),a=0,s=0,u=e;s<u.length;s++)for(var c=u[s],h=0,p=c.list;h<p.length;h++){var l=p[h];if(!(l.len<=1))for(var f=0;f<l.len;f++)o[a++]=c.curve.list[f+l.start].px,o[a++]=c.curve.list[f+l.start].py}var d=e.map((function(t){return t.curve.shaped_sprite.sprite.setXYWH({w:t.curve.shaped_sprite.sp_w,len:t.list.map((function(t){return t.len})).filter((function(t){return t>1})),tx:0,ty:0,tw:0,th:0},t.curve.time)})).filter((function(t){return t.len.length>0}));i.drawSnake(o,d,this.img)}},t.INS={},t}()}},i={};function r(t){if(i[t])return i[t].exports;var n=i[t]={exports:{}};return e[t](n,n.exports,r),n.exports}r.d=(t,n)=>{for(var e in n)r.o(n,e)&&!r.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:n[e]})},r.o=(t,n)=>Object.prototype.hasOwnProperty.call(t,n),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},t=r(684),n=r(506),window.onload=async function(){n.wW();const e=n.a(),i=t.S();await e,await i,document.getElementById("loading").hidden=!0,r(81),n.dB()}})();