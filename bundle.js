(()=>{var __webpack_modules__={349:(t,e,n)=>{"use strict";n.d(e,{SH:()=>r,ZP:()=>i,Fy:()=>o,bE:()=>a,OK:()=>s,ZA:()=>u,io:()=>p,ax:()=>h});var r=192,i=224,o=360,a=240;function s(t){return t/o}function u(t){return t/a}var c=1/64;function p(t){t.rect([-r,-i,2*r,2*i],c)}function h(t){var e=function(e){return t.rect(e,c)};e([-r,a-16,2*r,16]),e([-r,-a,2*r,16]),e([-o,-a,o-r,2*a]),e([r,-a,o-r,2*a])}},780:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{l:()=>GLHelper});var _gl__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(924),_Screen__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(349),GLHelper=function(){function GLHelper(){this.ver=[],this.tex=[],this.alp=[],this.n=0}return GLHelper.prototype.bind=function(t){this.img=t},GLHelper.prototype.rect=function(t,e){var n,r,i=t[0],o=t[1],a=t[2],s=t[3],u=[i,o,i,o+s,i+a,o,i,o+s,i+a,o,i+a,o+s];(n=this.ver).push.apply(n,u),(r=this.tex).push.apply(r,u.map((function(t){return t*e}))),this.alp.push(1,1,1,1,1,1),this.n+=6},GLHelper.prototype.fan=function(_a,n){for(var da=_a[0],oa=_a[1],ox=_a[2],oy=_a[3],or=_a[4],ta=_a[5],tx=_a[6],ty=_a[7],trw=_a[8],trh=_a[9],alpha=_a[10],num=Math.ceil(Math.abs(da)/(2*Math.PI)*n),f1=function(t,e,n,r,i,o,a){return t.push(e,n,e+r*Math.cos(o),n+i*Math.sin(o),e+r*Math.cos(a),n+i*Math.sin(a))},i=0;i<num;i++)f1(this.ver,ox,oy,or,or,oa+da/num*i,oa+da/num*(i+1)),f1(this.tex,tx,ty,trw,trh,ta+da/num*i,ta+da/num*(i+1)),this.alp.push(alpha,alpha,alpha);this.n+=3*num,eval("window.debug_info.fver = this.ver")},GLHelper.prototype.flush=function(){for(var t=new Float32Array(this.ver),e=0;e<t.length;e+=2)t[e]=(0,_Screen__WEBPACK_IMPORTED_MODULE_1__.OK)(t[e]),t[e+1]=(0,_Screen__WEBPACK_IMPORTED_MODULE_1__.ZA)(t[e+1]);_gl__WEBPACK_IMPORTED_MODULE_0__.draw(t,new Float32Array(this.tex),new Float32Array(this.alp),this.img,this.n),this.ver=[],this.tex=[],this.alp=[],this.n=0},GLHelper}()},195:(t,e,n)=>{"use strict";n.d(e,{p:()=>dt,K:()=>yt});var r={};n.r(r),n.d(r,{ability_invinc:()=>E,ability_slow:()=>m,ability_small:()=>I,ability_stop:()=>b});var i={};n.r(i),n.d(i,{stage_000:()=>z,stage_001:()=>X,stage_002:()=>V,stage_003:()=>et,stage_004:()=>nt,stage_005:()=>rt,stage_006:()=>ot,test_000:()=>at,test_001:()=>st,test_002:()=>ft});var o,a=n(822),s=n(924),u=n(780),c=n(940),p=n(583),h=n(68),l=n(869),_=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r},f=p.xg(c.cI,1),d=function(){function t(t){this.special_duration=t,this.special_remain=0}return t.prototype.updateEnable=function(t,e){return this.special_remain>0&&(this.special_remain--,this.update(t)),this.special_remain>0?0:e&&t.ability_count>0&&this.onActivate(t)?(t.ability_count--,this.special_remain=this.special_duration,0):0},t.prototype.render=function(t,e){if(t==l.t4+50){var n=new u.l;s.setMode(0);var r=f.sprite,i=[(r.tx+r.tw/2)/r.sprite.w,(r.ty+r.th/2)/r.sprite.h,r.tw/2/r.sprite.w,r.th/2/r.sprite.h];if(n.bind(h.Z.get(r.sprite.path).img),0==this.special_remain){var o=2*Math.PI*e.ability_count/(e.ability.max_ability+1),a=2*Math.PI*(e.graze_current/e.ability.max_graze)/(e.ability.max_ability+1),c=e.post_grazed?.7:.5,p=e.graze_current==e.ability.max_graze?c:e.post_grazed?.7:.2;n.fan(_([o,Math.PI/2,e.px,e.py,f.w/2,Math.PI/6],i,[c]),32),n.fan(_([a,Math.PI/2+o,e.px,e.py,f.w/2,Math.PI/6+o],i,[p]),32)}else o=2*Math.PI*this.special_remain/this.special_duration,n.fan(_([o,-o+Math.PI/2,e.px,e.py,f.w/2,-o+Math.PI/6],i,[1]),32);n.flush()}},t.prototype.layers=function(){return[l.t4+50]},t}(),y=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),v=function(t){function e(){return t.call(this,240)||this}return y(e,t),e.prototype.update=function(){},e.prototype.onActivate=function(){return a.n.INSTANCE.special_effects.time_slowdown(.5,240),!0},e}(d),m={name:"slow",init:function(){return new v}},w=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),g=function(t){function e(){return t.call(this,120)||this}return w(e,t),e.prototype.update=function(){},e.prototype.onActivate=function(){return a.n.INSTANCE.special_effects.time_slowdown(0,120),!0},e}(d),b={name:"stop",init:function(){return new g}},x=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),M=function(t){function e(){return t.call(this,30)||this}return x(e,t),e.prototype.update=function(t){t.magn=this.special_remain>0?-1/0:1},e.prototype.onActivate=function(){return!0},e}(d),E={name:"invincibility",init:function(){return new M}},A=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),T=function(t){function e(){return t.call(this,300)||this}return A(e,t),e.prototype.update=function(t){t.magn=this.special_remain>0?0:1},e.prototype.onActivate=function(){return!0},e}(d),I={name:"small hitbox",init:function(){return new T}},P=n(349),S=n(566),R=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),O={render_layer:l.bm,collide_group:l.A4,collide_mask:l.A4,kill_on_exit:!0,kill_by:function(t){return t==l.t_||t==l.T},auto_direction:!0,life:0,listener:null},k=function(t,e){return!0},N=function(t){function e(e,n){var r=t.call(this,e)||this;return r.state=0,r.motion=k,r.custom_fields={},r.config=n,r.time=0,r}return R(e,t),e.prototype.setMotion=function(t){return this.motion=t,this.simpleInit(0,0,0,0)},e.prototype.simpleInit=function(t,e,n,r){return this.px=t,this.py=e,this.vx=n*Math.cos(r),this.vy=n*Math.sin(r),this.dir=r,this.motion(this,0)&&this.config.auto_direction&&(this.dir=Math.atan2(this.vy,this.vx)),this},e.prototype.init=function(t){return t(this),this},e.prototype.update=function(t){var e,n,r,i,o,s,u,c,p=this;0==this.state&&(this.state=1,null===(n=null===(e=this.config.listener)||void 0===e?void 0:e.onInit)||void 0===n||n.forEach((function(t){return t(p)})));var h=a.n.INSTANCE.special_effects.time_rate;this.time+=h,null===(i=null===(r=this.config.listener)||void 0===r?void 0:r.onUpdate)||void 0===i||i.forEach((function(t){return t(p,h)})),this.motion(this,h)&&(this.px+=this.vx*h,this.py+=this.vy*h,this.config.auto_direction&&(this.dir=Math.atan2(this.vy,this.vx))),(null===(s=null===(o=this.shaped_sprite)||void 0===o?void 0:o.sprite)||void 0===s?void 0:s.omega)&&(this.dir=this.time*this.shaped_sprite.sprite.omega),null===(c=null===(u=this.config.listener)||void 0===u?void 0:u.onPostMotion)||void 0===c||c.forEach((function(t){return t(p,h)}))},e.prototype.postUpdate=function(t){var e,n,r,i,o,a,s,u,c=this,p=null===(n=null===(e=this.shaped_sprite)||void 0===e?void 0:e.shape)||void 0===n?void 0:n.exitScreen(this),h=this.px>P.SH+p,l=-this.px>P.SH+p,_=this.py>P.ZP+p,f=-this.py>P.ZP+p;this.motion||(h&&(h=this.vx>0),l&&(l=this.vx<0),_&&(_=this.vy>0),f&&(f=this.vy<0)),(h||l||_||f)&&this.config.kill_on_exit&&(this.state=2,null===(i=null===(r=this.config.listener)||void 0===r?void 0:r.onExitScreen)||void 0===i||i.forEach((function(t){return t(c)}))),this.config.life&&this.time>=this.config.life&&(this.state=2),null===(a=null===(o=this.config.listener)||void 0===o?void 0:o.onPostUpdate)||void 0===a||a.forEach((function(t){return t(c)})),2==this.state&&(null===(u=null===(s=this.config.listener)||void 0===s?void 0:s.onDestroy)||void 0===u||u.forEach((function(t){return t(c)})),this.state=3)},e.prototype.attack=function(t,e){var n,r,i=this;null===(r=null===(n=this.config.listener)||void 0===n?void 0:n.onAttack)||void 0===r||r.forEach((function(t){return t(i,e)})),e.damaged(e,this)},e.prototype.damaged=function(t,e){var n,r,i=this;return!!this.config.kill_by(e.config.collide_group)&&(this.state=2,null===(r=null===(n=this.config.listener)||void 0===n?void 0:n.onKill)||void 0===r||r.forEach((function(t){return t(i,e)})),!0)},e}(S.eY),D=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),C=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r},U=function(){},F=function(t){function e(e){var n=t.call(this)||this;return n.remain=e,n}return D(e,t),e.prototype.update=function(t){return this.remain-=t,this.remain<0?-this.remain:0},e}(U),B=function(t){function e(e){var n=t.call(this)||this;return n.time=0,n.init=e,n}return D(e,t),e.random=function(t,n){return function(){return new e((function(e){var r=Math.max(n.px0-t.px,-n.dx1),i=Math.min(n.px1-t.px,n.dx1),o=Math.max(n.py0-t.py,-n.dy1),a=Math.min(n.py1-t.py,n.dy1),s=r+Math.random()*(i-r),u=o+Math.random()*(a-o);e.target=t,e.duration=n.duration,e.dx=s,e.dy=u,e.x0=t.px,e.y0=t.py,e.ease=n.ease}))}},e.prototype.update=function(t){0==this.time&&this.init(this),this.time+=t;var e=Math.min(1,this.time/this.duration),n=this.ease(e);return this.target.px=this.x0+this.dx*n,this.target.py=this.y0+this.dy*n,this.time>this.duration?this.time-this.duration:0},e}(U),L=function(t){function e(e){var n=t.call(this)||this;return n.todo=e,n}return D(e,t),e.prototype.update=function(t,e){var n=this.todo();return void 0===n?t:"number"==typeof n?(e.list[0]=new F(n),e.list[0].update(t,e)):(e.list.unshift(e.list[0]),e.list[1]=n,t)},e}(U),q=function(){};function H(t){return t.map((function(t){return"number"==typeof t?new F(t):"function"==typeof t?new L(t):t}))}var j,W=function(t){function e(e,n){var r=t.call(this)||this;return r.index=0,r.todo=e,r.total=n,r}return D(e,t),e.prototype.supply=function(){return this.index>=this.total?null:(t="function"==typeof this.todo?this.todo(this.index):this.todo,this.index++,H(t));var t},e}(q),K={render_layer:l.NH,collide_group:l.T7,collide_mask:l.Io},Y=function(t){function e(e){var n=t.call(this)||this;return n.custom_fields={},n.config=K,n.state=0,n.time=0,n.list=H("object"==typeof e?e:e(n)),n}return D(e,t),e.prototype.init=function(t){return t(this),this},e.prototype.update=function(t){0==this.state&&(this.state=1);var e=a.n.INSTANCE.special_effects.time_rate;for(this.time+=e;this.list.length>0&&e;){var n=this.list[0];if(n instanceof q){var r=n.supply();r&&r.length?this.list=C(r,this.list):this.list.shift()}else(e=n.update(e,this))>0&&this.list.shift()}0==this.list.length&&(this.state=2)},e.prototype.postUpdate=function(t){2==this.state&&(this.state=3)},e.prototype.attack=function(t){},e.prototype.damaged=function(t,e){return!1},e}(S.u5),G=function(t,e){return void 0===e&&(e=1/0),function(){return new W(t,e)}},Z=function(t){return function(){return a.n.INSTANCE.add(new Y(t))}},z={name:"波与粒的境界",default_scale:3,init:function(t){var e=c.hZ(5,1,0),n=p.xg(e,1);return new Y([30*t,G((function(e){return[G((function(r){return[function(){return a.n.INSTANCE.add(new N(n,O).simpleInit(0,0,8/t,.003/t*e*e+2*Math.PI/5*r))}]}),5),1*t]}),1/0)])}},X={name:"龙纹弹",default_scale:3,init:function(t){var e=function(t){return p.xg(c.e8(1,t,0),1)},n=(0,l.d9)(O);n.life=180*t,n.kill_on_exit=!1;var r={duration:100*t,px0:-96,px1:96,py0:32,py1:112,dx1:64,dy1:64,ease:function(t){return(1-Math.cos(Math.PI*t))/2}},i=1*t,o=3/t,s=-o/70,u=.06/t,h=new N(p.xg(c.cI,2),O).setMotion((function(t){return t.dir=t.time*Math.PI*2/600,!1})).simpleInit(0,64,0,0),_=null,f=function(t,e,r,c){return a.n.INSTANCE.add(new Y([G((function(p){return[function(){return a.n.INSTANCE.add(_=new N(null,n).simpleInit(h.px,h.py,o,2*Math.PI/47*p*e*t))},G((function(e){return[function(){return a.n.INSTANCE.add(new N(p%2==0?r:c,O).setMotion((n=_,i=2*Math.PI/30*e,o=u*t,70,h=s,function(t,e){var r=i+o*t.time,a=70*Math.sin(h*t.time);return t.px=n.px+a*Math.cos(r),t.py=n.py+a*Math.sin(r),t.dir=Math.atan2(a*o,70*h*Math.cos(h*t.time))+r,!1})));var n,i,o,h}]}),30),i]}),47)]))};return new Y([function(){return a.n.INSTANCE.add(h)},30*t,G((function(n){return[function(){return f(n%2*2-1,7,e(2),e(10))},50*t,function(){return f(n%2*2-1,5,e(13),e(6))},50*t,function(){return f(n%2*2-1,1,e(8),e(4))},B.random(h,r)]}))])}},V={name:"rotating long bullet",default_scale:3,init:function(t){var e=p.p3(2,0,64),n=(0,l.d9)(O);n.auto_direction=!1;var r={duration:50*t,px0:-96,px1:96,py0:32,py1:112,dx1:64,dy1:64,ease:function(t){return(1-Math.cos(Math.PI*t))/2}},i=new N(p.xg(c.cI,2),O).setMotion((function(t){return t.dir=t.time*Math.PI*2/600,!1})).simpleInit(0,64,0,0),o=function(t){return G((function(r){return[function(){return a.n.INSTANCE.add(new N(e,n).setMotion((function(e,n){return e.dir+=n*t,!0})).simpleInit(i.px,i.py,_,f+2*Math.PI/s*r).init((function(t){return t.dir+=2*Math.PI*u/s*r})))}]}),s)},s=50,u=2.5,h=2*Math.PI/60/t,_=6/t,f=0;return new Y([function(){return a.n.INSTANCE.add(i)},30*t,G((function(e){return[function(){return f=Math.random()*Math.PI*2},o(h),20*t,o(-h),B.random(i,r)]}))])}},$=n(296),J={w0:-P.SH,w1:P.SH,h0:-P.ZP,h1:P.ZP,max:1/0,inner_bound:!0,outer_bound:!1},Q=function(t){return function(e){e.onInit.push((function(e){var n=e.custom_fields;n.in_screen=e.px>t.w0&&e.px<t.w1&&e.py>t.h0&&e.py<t.h1,n.ref_count=0})),e.onPostMotion.push((function(e,n){var r=e.custom_fields,i=r.in_screen;r.in_screen=e.px>t.w0&&e.px<t.w1&&e.py>t.h0&&e.py<t.h1,i&&!r.in_screen&&t.inner_bound&&(r.ref_count<t.max&&e.px<=t.w0&&(r.ref_count++,e.vx=-e.vx,e.px=2*t.w0-e.px),r.ref_count<t.max&&e.px>=t.w1&&(r.ref_count++,e.vx=-e.vx,e.px=2*t.w1-e.px),r.ref_count<t.max&&e.py<=t.h0&&(r.ref_count++,e.vy=-e.vy,e.py=2*t.h0-e.py),r.ref_count<t.max&&e.py>=t.h1&&(r.ref_count++,e.vy=-e.vy,e.py=2*t.h1-e.py),e.dir=Math.atan2(e.vy,e.vx),r.in_screen=!0),!i&&r.in_screen&&t.outer_bound&&(r.ref_count<t.max&&e.px>=t.w0&&(r.ref_count++,e.vx=-e.vx,e.px=2*t.w0-e.px),r.ref_count<t.max&&e.px<=t.w1&&(r.ref_count++,e.vx=-e.vx,e.px=2*t.w1-e.px),r.ref_count<t.max&&e.py>=t.h0&&(r.ref_count++,e.vy=-e.vy,e.py=2*t.h0-e.py),r.ref_count<t.max&&e.py<=t.h1&&(r.ref_count++,e.vy=-e.vy,e.py=2*t.h1-e.py),e.dir=Math.atan2(e.vy,e.vx),r.in_screen=!1)}))}},tt={name:"",w0:-P.SH,w1:P.SH,h0:-P.ZP,h1:P.ZP,max:1/0,maxlen:NaN,v:NaN,body:null,cf:null},et={name:"reflect and delayed altering",default_scale:3,init:function(t){var e=p.xg(c.e8(4,2,0),1),n=(0,l.d9)(O);n.listener={onInit:[],onUpdate:[],onPostMotion:[],onPostUpdate:[],onAttack:[],onDestroy:[],onExitScreen:[],onKill:[]};var r=(0,l.d9)(J);r.max=100,Q(r)(n.listener);var i=Math.PI/24,o=6/t,s=100*t,u=1*t,h=1*t,_={duration:s-40*h-20*u,px0:-96,px1:96,py0:32,py1:112,dx1:64,dy1:64,ease:function(t){return(1-Math.cos(Math.PI*t))/2}},f=new N(p.xg(c.cI,2),O).setMotion((function(t){return t.dir=t.time*Math.PI*2/600,!1})).simpleInit(0,64,0,0),d=0;return new Y([function(){return a.n.INSTANCE.add(f)},30*t,G((function(t){return[function(){return d=Math.random()*Math.PI*2},G((function(t){return[Z([G((function(){return[function(){return a.n.INSTANCE.add(new N(e,n).setMotion((function(e,n){var a,u=s-t*h;return e.time-n<u&&e.time>=u&&((a=r,function(t){return t.custom_fields.ref_count=a.max})(e),e.simpleInit(e.px,e.py,o,e.dir+(2*Math.random()-1)*i)),!0})).simpleInit(f.px,f.py,o,d+2*Math.PI/40*t))},u]}),20)]),h]}),40),20*u,B.random(f,_)]}))])}},nt={name:"finite reflect",default_scale:3,init:function(t){var e=[p.xg(c.e8(4,2,0),1),p.xg(c.e8(4,6,0),1)],n=(0,l.d9)(O),r=(0,l.d9)(O);n.listener={onInit:[],onUpdate:[],onPostMotion:[],onPostUpdate:[],onAttack:[],onDestroy:[],onExitScreen:[],onKill:[]},r.listener={onInit:[],onUpdate:[],onPostMotion:[],onPostUpdate:[],onAttack:[],onDestroy:[],onExitScreen:[],onKill:[]};var i=(0,l.d9)(J),o=(0,l.d9)(J);i.max=2,i.h0=-1/0,o.max=1,o.h0=-1/0,Q(i)(n.listener),Q(o)(r.listener);var s=6/t,u=1*t,h=3*t,_={duration:40*t,px0:-96,px1:96,py0:32,py1:112,dx1:64,dy1:64,ease:function(t){return(1-Math.cos(Math.PI*t))/2}},f=new N(p.xg(c.cI,2),O).setMotion((function(t){return t.dir=t.time*Math.PI*2/600,!1})).simpleInit(0,64,0,0),d=0,y=function(t,e,n,r){return G((function(i){return[Z([G((function(o){return[G((function(u){return[function(){return a.n.INSTANCE.add(new N(t,r).simpleInit(f.px,f.py,s,d+n*Math.PI*2*(i/8/4+u/4+o/4/8/e*.5)))}]}),8),u]}),e)]),h]}),8)};return new Y([function(){return a.n.INSTANCE.add(f)},30*t,G((function(t){return[function(){return d=Math.random()*Math.PI*2},y(e[0],10,1,n),10*u,B.random(f,_),y(e[1],15,-1,r),20*u,B.random(f,_)]}))])}},rt={name:"reflect laser",default_scale:3,init:function(t){var e=function(e,n){var r=p.iW(4,e,n,1,1,1,.75),i={render_layer:O.render_layer,collide_group:O.collide_group,collide_mask:O.collide_mask,warning_time:0,open_time:0,alive_time:1/0,close_time:0,listener:null},o=(0,l.d9)(i);i.listener={onInit:[],onUpdate:[],onPostMotion:[],onStateChange:[],onPostUpdate:[],onAttack:[],onContact:[],onDestroy:[]};var s,u=(0,l.d9)(tt);return u.max=2,u.v=8/t,u.maxlen=128,u.body=r,u.cf=o,u.name=e+"-"+n,(s=u,function(t){var e=function(t,e){var n=t.custom_fields;if(n.togrow>0){var r=Math.min(n.togrow,s.v*e);e-=r/s.v,t.len+=r,n.togrow-=r}e>0&&(t.px+=e*n.vx,t.py+=e*n.vy),t.shaped_sprite.end.shape.rawExitScreen(t.px+t.len*Math.cos(t.dir),t.py+t.len*Math.sin(t.dir),t.shaped_sprite.base,P.SH,P.ZP)&&t.shaped_sprite.base.shape.rawExitScreen(t.px,t.py,t.shaped_sprite.base,P.SH,P.ZP)&&(t.state=3)},n=function(t,e){return t>s.w0&&t<s.w1&&e>s.h0&&e<s.h1},r=function(t,e){var n=t.custom_fields;if(n.toshrink>0){var r=Math.min(n.toshrink,s.v*e);t.len-=r,n.toshrink-=r,n.toshrink<=0&&(t.state=3)}n.togrow>0&&(e-=(r=Math.min(n.togrow,s.v*e))/s.v,t.len+=r,n.togrow-=r),e>0&&(t.px+=e*n.vx,t.py+=e*n.vy),t.shaped_sprite.base.shape.rawExitScreen(t.px,t.py,t.shaped_sprite.base,P.SH,P.ZP)&&(t.state=3)};t.onInit.push((function(t){var n=t.custom_fields;n.ref_count=0,n.vx=s.v*Math.cos(t.dir),n.vy=s.v*Math.sin(t.dir),n.togrow=s.maxlen,n.toshrink=0,t.motion=e})),t.onPostMotion.push((function(t,e){var i=t.custom_fields,o=(n(t.px,t.py),t.px+t.len*Math.cos(t.dir)),u=t.py+t.len*Math.sin(t.dir);if(!n(o,u)&&i.ref_count<s.max){var c=new $.Fu(s.body,s.cf,r);c.init(t.px,t.py,t.dir,t.len);var p=c.custom_fields;p.vx=i.vx,p.vy=i.vy,p.togrow=i.togrow,a.n.INSTANCE.add(c);var h=0,l=0;i.ref_count<s.max&&o<=s.w0&&(h=s.w0,l=t.py+(s.w0-t.px)*i.vy/i.vx,i.ref_count++,i.vx=-i.vx,t.px=2*s.w0-t.px),i.ref_count<s.max&&o>=s.w1&&(h=s.w1,l=t.py+(s.w1-t.px)*i.vy/i.vx,i.ref_count++,i.vx=-i.vx,t.px=2*s.w1-t.px),i.ref_count<s.max&&u<=s.h0&&(l=s.h0,h=t.px+(s.h0-t.py)*i.vx/i.vy,i.ref_count++,i.vy=-i.vy,t.py=2*s.h0-t.py),i.ref_count<s.max&&u>=s.h1&&(l=s.h1,h=t.px+(s.h1-t.py)*i.vx/i.vy,i.ref_count++,i.vy=-i.vy,t.py=2*s.h1-t.py);var _=Math.sqrt(Math.pow(t.px-h,2)+Math.pow(t.py-l,2));t.len-=_,t.px=h,t.py=l,i.togrow+=_,c.len=_,p.toshrink=_+p.togrow,t.dir=Math.atan2(i.vy,i.vx)}}))})(i.listener),[r,i,u]},n=[e(6,3),e(2,1)],r=2*Math.PI/t,i=t,o=function(t,e,r,i,o,s){return G((function(t){return[G((function(o){return[function(){return a.n.INSTANCE.add(new $.Fu(n[e][0],n[e][1],null).init(0,0,s+2*Math.PI/r*o+i*t,0))}]}),r),o]}),t)};return new Y([30*t,G((function(e){return[o(20,0,3,(e%2*2-1)*r*.0678,6*i,2*Math.random()*Math.PI),100*t,o(120,1,1,(e%2*2-1)*r*.0234,i,2*Math.random()*Math.PI),100*t]}))])}},it=n(533),ot={name:"Test Special Effect",default_scale:1,init:function(t){var e=p.xg(c.e8(1,2,0),1),n=p.xg(c.e8(1,1,0),1),r=p.xg(c.OE(0,0,1),1),i=O,o=(0,l.d9)(O);o.life=160*t,o.kill_on_exit=!1,o.kill_by=function(){return!1};var s=6/t,u=.4*s,h=2*t,_=6*t,f=Math.PI/3;return new Y([30*t,G((function(c){return[function(){return a.n.INSTANCE.special_effects.time_slowdown(1/4,4*(8*_+160/s))},(p=c%2*2-1,l=f,void 0===d&&(d=Math.PI/2),G((function(t){return[Z((function(c,_){return void 0===_&&(_=c.custom_fields),[function(){_.a1=d+2*Math.PI*t/8*p;var e=_.a1+Math.PI/2*p;a.n.INSTANCE.add(_.host=new N(r,o).simpleInit(160*Math.cos(_.a1)-240*Math.cos(e),160*Math.sin(_.a1)-240*Math.sin(e),s,e))},Z([G((function(){return[G((function(t){return[G((function(e){return[function(){return a.n.INSTANCE.add(new N(n,i).simpleInit(_.host.px,_.host.py,u*(2+t)/4,_.a1+(e-1)*Math.PI/3))}]}),3)]}),3),h]}),Math.round(480/s/h))]),Math.round(80/s),function(){_.plx=it.U.INSTANCE.px,_.ply=it.U.INSTANCE.py},G((function(){return[function(){_.dir=Math.atan2(_.ply-_.host.py,_.plx-_.host.px)},G((function(t){return[G((function(n){return[function(){return a.n.INSTANCE.add(new N(e,i).simpleInit(_.host.px,_.host.py,u*(2+t)/4,_.dir+(n-1)*l))}]}),3)]}),3),h]}),Math.round(320/s/h))]})),_]}),8)),240*t];var p,l,d}))])}},at={name:"RayLaser Hitbox Test",default_scale:3,init:function(t){var e=function(t,e,n){return p.iW(t,2,1,1,e,n,1)},n=[e(0,0,0),e(0,1,1),e(0,0,1),e(0,1,0),e(4,0,0),e(4,1,1),e(4,0,1),e(4,1,0),e(1,0,0),e(1,1,0)],r={render_layer:O.render_layer,collide_group:O.collide_group,collide_mask:O.collide_mask,warning_time:30*t,open_time:10*t,alive_time:6e3*t,close_time:10*t,listener:null},i=0*Math.PI*2/240/t;return new Y([30*t,G((function(e){return[G((function(t){return[function(){return a.n.INSTANCE.add(new $.Fu(n[t],r,(o=i*(e%2*2-1),function(t,e){return t.dir+=e*o})).init(50*Math.cos(2*Math.PI/10*t),50*Math.sin(2*Math.PI/10*t),2*Math.PI/10*t,100));var o}]}),10),6e3*t]}))])}},st={name:"Local Variable Test",default_scale:1,init:function(t){var e=(0,l.d9)(O);e.listener={onInit:[],onUpdate:[],onPostMotion:[],onPostUpdate:[],onAttack:[],onDestroy:[],onExitScreen:[],onKill:[]},e.listener.onAttack.push((function(t){return t.custom_fields.callback()}));var n=[[p.xg(c.e8(3,6,0),1),p.xg(c.OE(0,1,1),1)],[p.xg(c.e8(3,2,0),1),p.xg(c.OE(0,0,1),1)],[p.xg(c.e8(3,13,0),1),p.xg(c.OE(0,3,1),1)],[p.xg(c.e8(3,10,0),1),p.xg(c.OE(0,2,1),1)]],r={duration:40*t,px0:-96,px1:96,py0:32,py1:112,dx1:64,dy1:64,ease:function(t){return(1-Math.cos(Math.PI*t))/2}},i=2.5/t;return new Y([60*t,G((function(o){return[Z((s=o,function(t,o){return void 0===o&&(o=t.custom_fields),[function(){var t=Math.random()*Math.PI*2;o.px=50*Math.cos(t),o.py=64+50*Math.sin(t),o.count=0},G([G((function(t){return[function(){return a.n.INSTANCE.add(new N(0==o.count?n[s][0]:n[s][1],e).simpleInit(o.px,o.py,i,2*Math.PI/40*t).init((function(t,e){void 0===e&&(e=t.custom_fields),e.callback=function(){return o.count++}})))}]}),40),function(){return o.count=0},B.random(o,r)])]})),150*t];var s}),4)])}},ut=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ct=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}ut(e,t),e.prototype.distanceTo=function(t,e,n){var r=this;return t.getStat().list.reduce((function(i,o){return Math.min(i,r._distanceTo(t,o.start,o.len,e,n))}),1/0)}}(S.bn),j=S.Yw,ut((function(){return null!==j&&j.apply(this,arguments)||this}),j),function(){function t(){this.exist=!1,this.list=[],this.start=-1,this.count=0}return t.prototype.reduce=function(t,e){return t&&1==t.state?(this.exist||(this.start=e),this.exist=!0,this.count++):this.exist&&(this.exist=!1,this.list.push({start:this.start,len:this.count}),this.count=0),this},t}()),pt=function(t){function e(e){var n=t.call(this,1,e)||this;return n.list=[],n}return ut(e,t),e.prototype.getStat=function(){return this.list.reduce((function(t,e,n){return t.reduce(e,n)}),new ct).reduce(null,0)},e.prototype.render=function(){for(var t=this.getStat(),e=new Array(t.list.length),n=0;n<e.length;n++){e[n]=new Float32Array(2*t.list[n].len);for(var r=0;r<t.list[n].len;r++)e[n][2*r+0]=this.list[t.list[n].start+r].px,e[n][2*r+1]=this.list[t.list[n].start+r].py}return e},e.prototype.getSprite=function(){return this.shaped_sprite},e}(S.hE),ht=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),lt={collide_group:l.T7,collide_mask:l.Io,render_layer:l.bm,kill_on_empty:!0,protect:0,life:0},_t=function(t){function e(e,n){var r=t.call(this,e)||this;return r.state=0,r.time=0,r.config=n,r}return ht(e,t),e.prototype.add=function(t){return this.list.push(t),t},e.prototype.update=function(t){0==this.state&&(this.state=1);var e=a.n.INSTANCE.special_effects.time_rate;this.time+=e;for(var n=0,r=this.getStat().list;n<r.length;n++)for(var i=r[n],o=0;o<i.len;o++)this.list[o+i.start].magn=this.shaped_sprite.radius(i.start,i.len,o)},e.prototype.attack=function(t,e){},e.prototype.postUpdate=function(t){for(;this.list.length&&3==this.list[0].state;)this.list.shift();this.time>this.config.protect&&this.config.kill_on_empty&&!this.list.length&&(this.state=3)},e.prototype.damaged=function(t,e){return!1},e.prototype.distanceTo=function(t,e){return 1/0},e}(pt),ft={name:"curve test",default_scale:1,init:function(t){var e=p.xg(c.e8(9,2,0),1),n=p.dC(2,1,null),r=(0,l.d9)(O),i=(0,l.d9)(lt);r.kill_on_exit=!0,e.sprite=null;var o,s=2/t,u=2*Math.PI/4,h=2*Math.PI/180/t;return new Y([60*t,G((function(c){return[function(){o=2*Math.PI*Math.random()},G((function(c){return[Z((function(p,l){return void 0===l&&(l=p.custom_fields),[function(){l.curve=new _t(n,i),a.n.INSTANCE.add(l.curve),l.a0=o+2*Math.PI/32*5*c},G((function(n){return[function(){var t=new N(e,r);t.setMotion(function(t,e,n){return function(r,i){var o=t+e*Math.sin(r.time*n);return r.vx=s*Math.cos(o),r.vy=s*Math.sin(o),!0}}(l.a0,u,h)),t.simpleInit(0,0,s,l.a0),l.curve.add(t),a.n.INSTANCE.add(t)},5*t]}),32)]})),4*t]}),32),240*t]}))])}},dt=Object.values(r),yt=Object.values(i)},869:(t,e,n)=>{"use strict";n.d(e,{T:()=>r,ZE:()=>i,yR:()=>o,A4:()=>a,t_:()=>s,T7:()=>u,KZ:()=>c,DV:()=>p,P4:()=>h,k8:()=>l,Gs:()=>_,Io:()=>f,NH:()=>d,t4:()=>y,bm:()=>v,$7:()=>m,d9:()=>w,S:()=>g});var r=0,i=1,o=2,a=3,s=4,u=5,c=0,p=1,h=1,l=1,_=14,f=0,d=0,y=100,v=500,m=700;function w(t){return Object.assign({},t)}var g={render_layer:m,collide_group:r,collide_mask:c}},296:(t,e,n)=>{"use strict";n.d(e,{cE:()=>u,Fu:()=>c});var r,i,o=n(566),a=n(822),s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u=function(t){function e(e){var n=t.call(this)||this;return n.func=e,n}return s(e,t),e.prototype.distanceTo=function(t,e,n){return Math.min(this.func(t,e,n),t.shaped_sprite.base.shape.rawDistanceTo(t.px,t.py,1,e,n),t.shaped_sprite.end.shape.rawDistanceTo(t.px+t.len*Math.cos(t.dir),t.py+t.len*Math.sin(t.dir),1,e,n))},e.line_circle=function(t,e,n){var r=t.px+t.shaped_sprite.hitbox_width*Math.cos(t.dir),i=t.py+t.shaped_sprite.hitbox_width*Math.sin(t.dir),o=t.px+(t.len-t.shaped_sprite.hitbox_width)*Math.cos(t.dir),a=t.py+(t.len-t.shaped_sprite.hitbox_width)*Math.sin(t.dir),s=Math.sqrt(Math.pow(r-o,2)+Math.pow(i-a,2)),u=Math.abs((o-r)*(i-n)-(r-e)*(a-i)),c=Math.sqrt(Math.pow(r-e,2)+Math.pow(i-n,2)),p=Math.sqrt(Math.pow(o-e,2)+Math.pow(a-n,2));return Math.pow(Math.max(c,p),2)>Math.pow(Math.min(c,p),2)+Math.pow(s,2)?Math.min(c,p)-t.shaped_sprite.hitbox_width*t.w:Math.min(u/s,c,p)-t.shaped_sprite.hitbox_width*t.w},e.double_arc=function(t,e,n){var r=e-t.px,i=n-t.py,a=r*Math.cos(-t.dir)-i*Math.sin(-t.dir),s=r*Math.sin(-t.dir)+i*Math.cos(-t.dir);return o.HC.orthDis(a-t.len/2,s,t.len/2,t.w*t.shaped_sprite.hitbox_width)},e.half_arc=function(t,e,n){var r=e-t.px,i=n-t.py,a=r*Math.cos(-t.dir)-i*Math.sin(-t.dir),s=r*Math.sin(-t.dir)+i*Math.cos(-t.dir);return a<0?Math.sqrt(Math.pow(a,2)+Math.pow(s,2)):o.HC.orthDis(a,s,t.len,t.w*t.shaped_sprite.hitbox_width)},e}(o.bn),c=(i=o.Yw,s((function(){return null!==i&&i.apply(this,arguments)||this}),i),function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.state=0,i.rstate=0,i.time=0,i.custom_fields={},i.config=n,i.motion=r,i}return s(e,t),e.prototype.init=function(t,e,n,r){return this.len=r,this.dir=n,this.px=t,this.py=e,this.checkState(),this},e.prototype.checkState=function(){var t,e,n,r,i,o,a,s,u,c,p=this;0==this.state&&(this.state=2,null===(e=null===(t=this.config.listener)||void 0===t?void 0:t.onInit)||void 0===e||e.forEach((function(t){return t(p)})));var h=this.config.warning_time,l=this.config.open_time+h,_=this.config.alive_time+l,f=this.config.close_time+_;0==this.rstate&&this.time>=h&&(this.rstate=1,null===(r=null===(n=this.config.listener)||void 0===n?void 0:n.onStateChange)||void 0===r||r.forEach((function(t){return t(p)}))),1==this.rstate&&(this.w=Math.min(1,(this.time-h)/(l-h)),this.time>=l&&(this.rstate=2,this.state=1,this.w=1,null===(o=null===(i=this.config.listener)||void 0===i?void 0:i.onStateChange)||void 0===o||o.forEach((function(t){return t(p)})))),2==this.rstate&&this.time>=_&&(this.rstate=3,this.state=2,null===(s=null===(a=this.config.listener)||void 0===a?void 0:a.onStateChange)||void 0===s||s.forEach((function(t){return t(p)}))),3==this.rstate&&(this.w=Math.max(0,1-(this.time-_)/(f-_)),this.time>=f&&(this.state=3,null===(c=null===(u=this.config.listener)||void 0===u?void 0:u.onDestroy)||void 0===c||c.forEach((function(t){return t(p)}))))},e.prototype.update=function(t){var e,n,r,i,o,s,u=this;0==this.state&&(this.state=2,null===(n=null===(e=this.config.listener)||void 0===e?void 0:e.onInit)||void 0===n||n.forEach((function(t){return t(u)})));var c=a.n.INSTANCE.special_effects.time_rate;this.time+=c,this.checkState(),null===(i=null===(r=this.config.listener)||void 0===r?void 0:r.onUpdate)||void 0===i||i.forEach((function(t){return t(u,c)})),this.motion(this,c),null===(s=null===(o=this.config.listener)||void 0===o?void 0:o.onPostMotion)||void 0===s||s.forEach((function(t){return t(u,c)}))},e.prototype.postUpdate=function(t){var e,n,r=this;null===(n=null===(e=this.config.listener)||void 0===e?void 0:e.onPostUpdate)||void 0===n||n.forEach((function(t){return t(r)}))},e.prototype.attack=function(t,e){var n,r,i=this;null===(r=null===(n=this.config.listener)||void 0===n?void 0:n.onAttack)||void 0===r||r.forEach((function(t){return t(i,e)})),e.damaged(e,this)},e.prototype.damaged=function(t,e){var n,r,i=this;return null===(r=null===(n=this.config.listener)||void 0===n?void 0:n.onContact)||void 0===r||r.forEach((function(t){return t(i,e)})),!1},e}(function(t){function e(e){var n=t.call(this,0,e)||this;return n.w=0,n}return s(e,t),e.prototype.rectCount=function(){return 3},e.prototype.render=function(t,e){var n=this.shaped_sprite.l_ratio*this.len/2;t[10*e+0]=this.px+n*Math.cos(this.dir),t[10*e+1]=this.py+n*Math.sin(this.dir),t[10*e+2]=this.dir+Math.PI/2,t[10*e+3]=Math.max(1,this.shaped_sprite.sprite_width*this.w),t[10*e+4]=n;var r=this.shaped_sprite.sprite;t[10*e+5]=r.tx/r.sprite.w,t[10*e+6]=r.ty/r.sprite.h,t[10*e+7]=r.tw/r.sprite.w,t[10*e+8]=r.th/r.sprite.h,t[10*e+9]=1,e++;var i=this.shaped_sprite.base;t[10*e+0]=this.px,t[10*e+1]=this.py,t[10*e+2]=this.dir+Math.PI/2,t[10*e+3]=i.w/2,t[10*e+4]=i.h/2,r=i.sprite,t[10*e+5]=r.tx/r.sprite.w,t[10*e+6]=r.ty/r.sprite.h,t[10*e+7]=r.tw/r.sprite.w,t[10*e+8]=r.th/r.sprite.h,t[10*e+9]=1,e++,i=this.shaped_sprite.end,t[10*e+0]=this.px+this.len*Math.cos(this.dir),t[10*e+1]=this.py+this.len*Math.sin(this.dir),t[10*e+2]=this.dir+Math.PI/2,t[10*e+3]=i.w/2,t[10*e+4]=i.h/2,r=i.sprite,t[10*e+5]=r.tx/r.sprite.w,t[10*e+6]=r.ty/r.sprite.h,t[10*e+7]=r.tw/r.sprite.w,t[10*e+8]=r.th/r.sprite.h,t[10*e+9]=1},e}(o.hE)))},533:(t,e,n)=>{"use strict";n.d(e,{f:()=>h,U:()=>l});var r,i=n(566),o=n(68),a=n(349),s=n(869),u=n(822),c=n(924),p=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),h=function(){function t(t,e,n){this.shoot=t,this.bomb=e,this.ability=n}return t.prototype.updateShoot=function(t,e){var n;null===(n=this.shoot)||void 0===n||n.updateEnable(t,e)},t.prototype.updateBomb=function(t,e){var n;return null===(n=this.bomb)||void 0===n?void 0:n.updateEnable(t,e)},t.prototype.updateAbility=function(t,e){var n;return null===(n=this.ability)||void 0===n?void 0:n.updateEnable(t,e)},t.prototype.render=function(t,e){var n,r,i;null===(n=this.shoot)||void 0===n||n.render(t,e),null===(r=this.bomb)||void 0===r||r.render(t,e),null===(i=this.ability)||void 0===i||i.render(t,e)},t.prototype.layers=function(){var t=[];return this.shoot&&(t=t.concat(this.shoot.layers())),this.bomb&&(t=t.concat(this.bomb.layers())),this.ability&&(t=t.concat(this.ability.layers())),t},t}(),l=function(t){function e(n,r,i,o,a){var u=t.call(this,2,null)||this;return u.config=s.S,u.state=1,u.time=0,u.missed=!1,u.bombed=0,u.grazed=!1,u.post_grazed=!1,u.pre_miss=0,u.miss_time=0,u.invince_time=0,u.px=0,u.py=0,u.dir=0,u.prex=0,u.prey=0,u.graze_total=0,u.graze_current=0,u.magn=1,u.collideCheck=function(t){for(var e=Math.sqrt(Math.pow(u.px-u.prex,2)+Math.pow(u.py-u.prey,2)),n=Math.max(1,Math.ceil(e/2)),r=1/0,i=0;i<n;i++){var o=u.px+(u.prex-u.px)*i/n,a=u.py+(u.prey-u.py)*i/n;r=Math.min(r,t.distanceTo(o,a))}var s=u.sprite.shape.radius*u.ability.radius*u.magn;return r-s<u.ability.graze_radius&&(u.grazed=!0),r<s},e.INSTANCE=u,u.proto=r,u.ability=i,u.sprite=n,u.px=o,u.py=a,u.dir=0,u.bomb_count=i.init_bomb,u.life_count=i.init_life,u.ability_count=i.init_ability,u.renderType=2,u}return p(e,t),e.updateState=function(t){e.action=t},e.prototype.update=function(t){if(e.action){this.prex=this.px,this.prey=this.py;var n=u.n.INSTANCE.special_effects.time_rate;this.time+=n,this.px+=e.action.pos_x,this.py+=e.action.pos_y,this.px<-a.SH&&(this.px=-a.SH),this.px>a.SH&&(this.px=a.SH),this.py<-a.ZP&&(this.py=-a.ZP),this.py>a.ZP&&(this.py=a.ZP),this.dir=this.time*this.sprite.sprite.omega,this.proto.updateShoot(this,e.action.key_z),this.bombed=this.proto.updateBomb(this,e.action.key_x),this.bombed||(this.bombed=this.proto.updateAbility(this,e.action.key_c))}},e.prototype.postUpdate=function(t){this.post_grazed=this.grazed,this.grazed&&(this.graze_current<this.ability.max_graze&&(this.graze_current+=u.n.INSTANCE.special_effects.time_rate),this.graze_total++,this.graze_current>=this.ability.max_graze&&this.ability_count<this.ability.max_ability&&(this.ability_count++,this.graze_current=0),this.grazed=!1),this.miss_time>0&&this.miss_time--,this.pre_miss>0&&(this.pre_miss--,0==this.pre_miss&&(console.log("missed"),this.miss_time=this.ability.miss_time)),this.missed&&(this.missed=!1,this.pre_miss=this.ability.pre_miss),this.bombed&&(this.miss_time=this.bombed,this.bombed=0,this.pre_miss>0&&(console.log("bomb after miss"),this.pre_miss=0)),this.miss_time>0||this.pre_miss>0?(this.state=2,this.invince_time++,Math.floor(this.invince_time/6)%2==0?this.shaped_sprite=null:this.shaped_sprite=this.sprite):(this.state=1,this.invince_time=0,this.shaped_sprite=this.sprite)},e.prototype.attack=function(t,e){},e.prototype.damaged=function(t,e){return 0==this.pre_miss&&0==this.miss_time&&(this.missed=!0),e.damaged(e,this)},e.prototype.layers=function(){return function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}(this.proto.layers(),[s.$7])},e.prototype.render=function(t){var e,n=[],r=0,i=null;this.proto.render(t,this),t==s.$7&&(null===(e=this.shaped_sprite)||void 0===e?void 0:e.sprite)&&(function(t,e,a,s,u){n.push(t),n.push(e),n.push(a+Math.PI/2),n.push(u.w/2),n.push(u.h/2);var c=u.sprite;n.push(c.tx/c.sprite.w),n.push(c.ty/c.sprite.h),n.push(c.tw/c.sprite.w),n.push(c.th/c.sprite.h),n.push(1),r++,i=o.Z.get(c.sprite.path).img}(this.px,this.py,this.dir,0,this.shaped_sprite),c.setMode(0),c.drawRects(new Float32Array(n),r,i))},e.INSTANCE=null,e.action=null,e}(i.hE)},822:(t,e,n)=>{"use strict";n.d(e,{n:()=>s});var r=n(869),i=n(566),o=n(68),a=function(){function t(){this.time_rate=1,this.list=[]}return t.prototype.process=function(){this.time_rate=this.list.reduce((function(t,e){return t*e.rate}),1),this.list=this.list.filter((function(t){return--t.duration>0}))},t.prototype.time_slowdown=function(t,e){this.list.push({rate:t,duration:e})},t}(),s=function(){function t(){this.groups=[],this.pending=[],this.update_stage=0,this.time=0,this.special_effects=new a,t.INSTANCE=this,this.groups.push({id:r.T,mask:r.KZ,list:[]}),this.groups.push({id:r.ZE,mask:r.DV,list:[]}),this.groups.push({id:r.yR,mask:r.P4,list:[]}),this.groups.push({id:r.A4,mask:r.k8,list:[]}),this.groups.push({id:r.t_,mask:r.Gs,list:[]}),this.groups.push({id:r.T7,mask:r.Io,list:[]})}return t.prototype.registerGroup=function(t){var e=this.groups.length;return this.groups.push({id:e,mask:t,list:[]}),e},t.prototype.add=function(t){3!=this.update_stage&&0!=this.update_stage?this.pending.push(t):this.groups[t.config.collide_group].list.push(t)},t.prototype.update=function(){var t=this;this.update_stage=1,this.groups.forEach((function(t){return t.list.forEach((function(t){return t.update(t)}))}));for(var e=0;e<this.groups.length;e++)for(var n=0;n<this.groups.length;n++)if(this.groups[e].mask&1<<n)for(var r=0,o=this.groups[e].list;r<o.length;r++){var a=o[r];if(1==a.state&&a.shaped_sprite&&a.shaped_sprite.shape)for(var s=0,u=this.groups[n].list;s<u.length;s++){var c=u[s];1==c.state&&c.shaped_sprite&&c.shaped_sprite.shape&&(0,i._R)(a,c)&&a.attack(a,c)}}this.update_stage=2,this.groups.forEach((function(t){return t.list.forEach((function(t){return t.postUpdate(t)}))})),this.groups.forEach((function(t){return t.list=t.list.filter((function(t){return 3!=t.state}))})),this.update_stage=3,this.special_effects.process(),this.pending.forEach((function(e){return t.add(e)})),this.pending=[],this.time++},t.prototype.render=function(){var t,e,n,r,i,a,s,u;return i=this,a=void 0,u=function(){var i,a,s,u,c,p,h,l,_,f,d,y;return function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(v){for(i=new Map,a=[],s=0,u=this.groups;s<u.length;s++)for(c=u[s],p=0,h=c.list;p<h.length;p++)2!=(l=h[p]).renderType?l.config.render_layer&&(null===(t=l.shaped_sprite)||void 0===t?void 0:t.sprite)&&(i.has(l.config.render_layer)||i.set(l.config.render_layer,new Map),f=i.get(l.config.render_layer),d=null===(r=null===(n=null===(e=l.shaped_sprite)||void 0===e?void 0:e.sprite)||void 0===n?void 0:n.sprite)||void 0===r?void 0:r.path,f.has(d)||f.set(d,[]),f.get(d).push(l)):(_=l,a.push(_),_.layers().forEach((function(t){return i.set(t,new Map)})));return y=[],i.forEach((function(t,e){return y.push({rl:e,v:t})})),y.sort((function(t,e){return t.rl-e.rl})),y.forEach((function(t){a.forEach((function(e){return e.render(t.rl)})),t.v.forEach((function(t,e){return o.Z.get(e).draw(t)}))})),[2]}))},new((s=void 0)||(s=Promise))((function(t,e){function n(t){try{o(u.next(t))}catch(t){e(t)}}function r(t){try{o(u.throw(t))}catch(t){e(t)}}function o(e){var i;e.done?t(e.value):(i=e.value,i instanceof s?i:new s((function(t){t(i)}))).then(n,r)}o((u=u.apply(i,a||[])).next())}))},t}()},176:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{S:()=>init});var _entity_SelfMachine__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(533),_stage_EntityPool__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(822),_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(583),_util_sprites__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(940),_util_SpriteManager__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(68),_data_index__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(195),__awaiter=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},__generator=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},sm_abi={radius:1,pre_miss:30,miss_time:60,graze_radius:24,max_graze:600,init_bomb:3,init_life:3,init_ability:5,max_bomb:10,max_life:10,max_ability:5},stage_settings={init,stage:6,scale:1,ability:1,stage_list:_data_index__WEBPACK_IMPORTED_MODULE_5__.K,ability_list:_data_index__WEBPACK_IMPORTED_MODULE_5__.p},sinit={load_sprite:function(){return _util_SpriteManager__WEBPACK_IMPORTED_MODULE_4__.Z.get(_util_sprites__WEBPACK_IMPORTED_MODULE_3__.Xp.path).load()},add_player:function(){return new _entity_SelfMachine__WEBPACK_IMPORTED_MODULE_0__.U(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_2__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_3__.a_,1),new _entity_SelfMachine__WEBPACK_IMPORTED_MODULE_0__.f(null,null,_data_index__WEBPACK_IMPORTED_MODULE_5__.p[stage_settings.ability].init()),sm_abi,0,-192)},add_schedule:null};function init(){return __awaiter(this,void 0,void 0,(function(){var pool;return __generator(this,(function(_a){switch(_a.label){case 0:return[4,sinit.load_sprite()];case 1:return _a.sent(),eval("window.debug_info.load_sprites();"),pool=new _stage_EntityPool__WEBPACK_IMPORTED_MODULE_1__.n,pool.add(sinit.add_player()),pool.add(_data_index__WEBPACK_IMPORTED_MODULE_5__.K[stage_settings.stage].init(stage_settings.scale)),eval("window.debug_info.pool = pool"),eval("window.debug_info.stage = stage_settings"),[2]}}))}))}},566:(t,e,n)=>{"use strict";n.d(e,{bn:()=>a,D8:()=>u,HC:()=>c,Yw:()=>p,hE:()=>h,eY:()=>l,u5:()=>_,_R:()=>f});var r,i,o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(){},s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(a),u=function(t){function e(e){var n=t.call(this)||this;return n.radius=e,n}return o(e,t),e.prototype.exitScreen=function(t){var e=Math.sqrt(Math.pow(t.shaped_sprite.w,2)+Math.pow(t.shaped_sprite.h,2));return Math.max(0,e*t.magn)},e.prototype.distanceTo=function(t,e,n){return Math.sqrt(Math.pow(e-t.px,2)+Math.pow(n-t.py,2))-this.radius*t.magn},e.prototype.rawDistanceTo=function(t,e,n,r,i){return Math.sqrt(Math.pow(r-t,2)+Math.pow(i-e,2))-this.radius*n},e.prototype.rawExitScreen=function(t,e,n,r,i){var o=Math.sqrt(Math.pow(n.w,2)+Math.pow(n.h,2));return Math.abs(t)>r+o||Math.abs(e)>i+o},e}(s),c=function(t){function e(e,n){var r=t.call(this)||this;return r.len=e,r.rad=n,r}return o(e,t),e.orthDis=function(t,e,n,r){var i=r/2;t=Math.abs(t);var o=n*n/i/2+i/2-i;return(e=Math.abs(e))>=0&&n*(e+o)>t*o?Math.sqrt(Math.pow(t,2)+Math.pow(e+o,2))-o-i:Math.sqrt(Math.pow(t-n,2)+Math.pow(e,2))-i},e.prototype.exitScreen=function(t){return Math.sqrt(Math.pow(t.shaped_sprite.w,2)+Math.pow(t.shaped_sprite.h,2))*t.magn},e.prototype.distanceTo=function(t,n,r){var i=n-t.px,o=r-t.py,a=i*Math.cos(-t.dir)-o*Math.sin(-t.dir),s=i*Math.sin(-t.dir)+o*Math.cos(-t.dir);return e.orthDis(a,s,this.len/2*t.magn,this.rad*t.magn)},e}(s),p=function(){},h=(o((function(){return null!==i&&i.apply(this,arguments)||this}),i=p),function(){function t(t,e){this.collideCheck=null,this.renderType=t,this.shaped_sprite=e}return t.prototype.distanceTo=function(t,e){var n;return(null===(n=this.shaped_sprite)||void 0===n?void 0:n.shape)?this.shaped_sprite.shape.distanceTo(this,t,e):1/0},t}()),l=function(t){function e(e){var n=t.call(this,0,e)||this;return n.magn=1,n.alpha=1,n}return o(e,t),e.prototype.rectCount=function(){return 1},e.prototype.render=function(t,e){t[10*e+0]=this.px,t[10*e+1]=this.py,t[10*e+2]=this.dir+Math.PI/2,t[10*e+3]=this.shaped_sprite.w/2*this.magn,t[10*e+4]=this.shaped_sprite.h/2*this.magn;var n=this.shaped_sprite.sprite;t[10*e+5]=n.tx/n.sprite.w,t[10*e+6]=n.ty/n.sprite.h,t[10*e+7]=n.tw/n.sprite.w,t[10*e+8]=n.th/n.sprite.h,t[10*e+9]=this.alpha},e}(h),_=function(t){function e(){return t.call(this,null,null)||this}return o(e,t),e}(h);function f(t,e){if(t.collideCheck)return t.collideCheck(e);if(e.collideCheck)return e.collideCheck(t);if(t instanceof l&&t.shaped_sprite.shape instanceof u)return e.distanceTo(t.px,t.py)<t.shaped_sprite.shape.radius;if(e instanceof l&&e.shaped_sprite.shape instanceof u)return f(e,t);throw new Error("non-circle non-circle collision not found")}},68:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});var r=n(924),i=function(){function t(t){this.img=null,this.path=t}return t.prototype.loaded=function(){return this.img},t.prototype.load=function(){return t=this,e=void 0,i=function(){var t;return function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(e){switch(e.label){case 0:return[4,r.loadImage(this.path)];case 1:return t=e.sent(),this.img=r.loadTexture(t),[2]}}))},new((n=void 0)||(n=Promise))((function(r,o){function a(t){try{u(i.next(t))}catch(t){o(t)}}function s(t){try{u(i.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((i=i.apply(t,e||[])).next())}));var t,e,n,i},t.get=function(e){return t.INS[e]?t.INS[e]:t.INS[e]=new t(e)},t.prototype.draw=function(t){this.drawRect(t,0),this.drawRect(t,1);for(var e=0,n=t;e<n.length;e++){var i=n[e];if(1==i.renderType){var o=i,a=o.getSprite(),s=a.sprite;r.setMode(s.mode);for(var u=0,c=o.render();u<c.length;u++){var p=c[u];r.drawSnake(p,a.sp_w,p.length/2,s.tx/s.sprite.w,s.ty/s.sprite.h,s.tw/s.sprite.w,s.th/s.sprite.h,this.img)}}}},t.prototype.drawRect=function(t,e){var n=t.reduce((function(t,n){return 0==n.renderType&&n.shaped_sprite.sprite.mode==e?t+n.rectCount():t}),0);if(n){r.setMode(e);for(var i=new Float32Array(10*n),o=0,a=0,s=t;a<s.length;a++){var u=s[a];if(0==u.renderType&&u.shaped_sprite.sprite.mode==e){var c=u;c.render(i,o),o+=c.rectCount()}}r.drawRects(i,n,this.img)}},t.INS={},t}()},583:(t,e,n)=>{"use strict";n.d(e,{xg:()=>c,p3:()=>p,iW:()=>h,dC:()=>l});var r=n(296),i=n(566),o=n(940),a=[[Math.sqrt(27),0],[2.4,2.4,4,4,2.4,2.4,2.4,2.8,2.4,2.4,4,2.4,2.4,2.4,2.4,2.4],[6,7,8.5,7,6,7,0,10],[14,14]],s=.75;function u(t){return Math.sqrt(Math.pow(t,2)+Math.pow(3,2))-3}function c(t,e){return e*=s,{sprite:t,shape:new i.D8(u(a[t.category][t.type])*e),w:t.tw*e,h:t.th*e,renderType:0}}function p(t,e,n){var r=(0,o.e8)(4,t,e);return{sprite:r,shape:new i.HC(n,u(a[1][4])*s),renderType:0,w:r.tw*s,h:1.25*n}}function h(t,e,n,i,a,p,h){var l=(0,o.e8)(t,e,i);return l.ty+=0==t?4:4==t||1==t?1:NaN,l.th-=0==t?8:4==t?2:1==t?1:NaN,{sprite:l,shape:new r.cE(0==t?r.cE.line_circle:1==t?r.cE.half_arc:4==t?r.cE.double_arc:null),renderType:0,sprite_width:l.tw*s/2*h,hitbox_width:u(2.4)*s*h,l_ratio:0==t||p>0?1:4==t?1.15:1==t?1.2:NaN,base:c((0,o.hZ)(0,n,i),a*h),end:c((0,o.hZ)(0,n,i),p*h)}}function l(t,e,n){var r=(0,o.e8)(14,t,e),i=u(a[1][14])*s;return{sprite:r,shape:n,renderType:1,w:i,sp_w:r.th*s,radius:function(t,e,n){if(e<=2||n/(e-1)*16<.5||n/(e-1)*16>15.5)return-1/0;var r=((n+.5)/e-.5)*i*16,o=255*i/2;return(Math.sqrt(Math.pow(o+i,2)-Math.pow(r,2))-o)/i}}}},940:(t,e,n)=>{"use strict";n.d(e,{Xp:()=>a,e8:()=>u,hZ:()=>c,OE:()=>p,a_:()=>h,cI:()=>l});var r=[0,0,1,1,0,0,0,0,0,1,1,1,1,0,0],i=[1,1,1,0,0,0,1,0],o=2*Math.PI/600,a={path:"assets/bullet_000.png",w:516,h:772};function s(t){return t.tx+=.5,t.ty+=.5,t.tw-=1,t.th-=1,t}function u(t,e,n){return s({sprite:a,tx:t<12?1+16*e:t<14?1+e%8*8:t<15?1:258+16*e,ty:t<12?1+16*t:t<14?(t<13?193:241)+8*(e>>3):e<15?515+16*e:449,tw:t<12?16:t<14?8:t<15?256:16,th:t<12?16:t<14?8:16,mode:n,category:1,type:t,color:e,omega:r[t]*o})}function c(t,e,n){return s({sprite:a,tx:(t<7?1:258)+32*e,ty:0==t?209:t<7?226+32*t:257,tw:32,th:32,mode:n,category:2,type:t,color:e,omega:i[t]*o})}function p(t,e,n){return s({sprite:a,tx:(0==t?1:258)+64*e,ty:0==t?449:290,tw:64,th:64,mode:n,category:3,type:t,color:e,omega:o})}var h=s({sprite:a,tx:258,ty:17,tw:64,th:64,mode:0,category:0,type:0,color:0,omega:o}),l=(s({sprite:a,tx:322,ty:17,tw:64,th:64,mode:0,category:0,type:1,color:0,omega:o}),s({sprite:a,tx:386,ty:81,tw:128,th:128,mode:0,category:0,type:2,color:0,omega:o}))},235:()=>{const t=document.getElementById("stage_start"),e=document.getElementById("stage_dec"),n=document.getElementById("stage_inc"),r=document.getElementById("ability_set"),i=document.getElementById("ability_dec"),o=document.getElementById("ability_inc"),a=debug_info.stage,s=()=>{e.disabled=0==a.stage,n.disabled=a.stage==a.stage_list.length-1,t.value=`${a.stage_list[a.stage].name}`,i.disabled=0==a.ability,o.disabled=a.ability==a.ability_list.length-1,r.value=`${a.ability_list[a.ability].name}`,a.scale=a.stage_list[a.stage].default_scale};e.onclick=()=>{a.stage--,s()},n.onclick=()=>{a.stage++,s()},i.onclick=()=>{a.ability--,s()},o.onclick=()=>{a.ability++,s()},s()},924:(t,e,n)=>{"use strict";n.r(e),n.d(e,{global_gl:()=>i,setup:()=>o,setMode:()=>a,loadImage:()=>s,draw:()=>u,drawStrip:()=>c,loadTexture:()=>p,clear:()=>h,drawRects:()=>v,drawSnake:()=>m});var r=n(349);const i={gl:null,shader:{program:0,attribute:{coord:0,tex:0,alpha:0},uniform:{uSampler:0}}};function o(){var t=document.getElementById("glcanvas"),e=t.getContext("webgl");if(null===e)return void alert("Unable to initialize WebGL. Your browser or machine may not support it.");i.gl=e;var n=e.createShader(e.VERTEX_SHADER),r=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(n,"\nattribute vec2 coord;\nattribute vec2 tex;\nattribute float alpha;\nvarying highp vec2 vTexCoord;\nvarying highp float vTexAlpha;\nvoid main() {\n    gl_Position = vec4(coord, 0.0, 1.0);\n    vTexCoord = tex;\n    vTexAlpha = alpha;\n}\n"),e.shaderSource(r,"\nprecision highp float;\nvarying highp vec2 vTexCoord;\nvarying highp float vTexAlpha;\nuniform sampler2D uSampler;\nvoid main() {\n    vec4 col = texture2D(uSampler, vTexCoord);\n    col.a *= vTexAlpha;\n    col.rgb *= col.a;\n    gl_FragColor = col;\n}\n"),e.compileShader(n),e.compileShader(r);var o=e.createProgram();e.attachShader(o,n),e.attachShader(o,r),e.linkProgram(o),e.useProgram(o);const a=i.shader;a.program=o,a.attribute.coord=e.getAttribLocation(o,"coord"),a.attribute.tex=e.getAttribLocation(o,"tex"),a.attribute.alpha=e.getAttribLocation(o,"alpha"),a.uniform.uSampler=e.getUniformLocation(o,"uSampler"),e.enable(e.BLEND),e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA),e.disable(e.DEPTH_TEST),e.viewport(0,0,t.width,t.height)}function a(t){const e=i.gl;0==t?e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA):e.blendFuncSeparate(e.ONE,e.ONE,e.ONE,e.ONE_MINUS_SRC_ALPHA)}function s(t){return new Promise(((e,n)=>{let r=new Image;r.onload=()=>e(r),r.onerror=n,r.src=t}))}function u(t,e,n,r,o){const a=i.gl,s=a.createBuffer(),u=i.shader.attribute.coord;a.bindBuffer(a.ARRAY_BUFFER,s),a.bufferData(a.ARRAY_BUFFER,t,a.STATIC_DRAW),a.vertexAttribPointer(u,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(u);const c=a.createBuffer(),p=i.shader.attribute.tex;a.bindBuffer(a.ARRAY_BUFFER,c),a.bufferData(a.ARRAY_BUFFER,e,a.STATIC_DRAW),a.vertexAttribPointer(p,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(p);const h=a.createBuffer(),l=i.shader.attribute.alpha;a.bindBuffer(a.ARRAY_BUFFER,h),a.bufferData(a.ARRAY_BUFFER,n,a.STATIC_DRAW),a.vertexAttribPointer(l,1,a.FLOAT,!1,0,0),a.enableVertexAttribArray(l),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,r),a.uniform1i(i.shader.uniform.uSampler,0),a.drawArrays(a.TRIANGLES,0,o)}function c(t,e,n,r,o){const a=i.gl,s=a.createBuffer(),u=i.shader.attribute.coord;a.bindBuffer(a.ARRAY_BUFFER,s),a.bufferData(a.ARRAY_BUFFER,t,a.STATIC_DRAW),a.vertexAttribPointer(u,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(u);const c=a.createBuffer(),p=i.shader.attribute.tex;a.bindBuffer(a.ARRAY_BUFFER,c),a.bufferData(a.ARRAY_BUFFER,e,a.STATIC_DRAW),a.vertexAttribPointer(p,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(p);const h=a.createBuffer();a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,h),a.bufferData(a.ELEMENT_ARRAY_BUFFER,n,a.STATIC_DRAW),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,r),a.uniform1i(i.shader.uniform.uSampler,0),a.drawElements(a.TRIANGLE_STRIP,o,a.UNSIGNED_SHORT,0)}function p(t,e=!0,n=!1){const r=i.gl,o=r.createTexture();return r.bindTexture(r.TEXTURE_2D,o),r.bindTexture(r.TEXTURE_2D,o),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_SHORT_4_4_4_4,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,e?r.LINEAR:r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,e?r.LINEAR:r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,n?r.REPEAT:r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,n?r.REPEAT:r.CLAMP_TO_EDGE),o}function h(){const t=i.gl;t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT),t.clearColor(0,0,1,1)}const l=[-1,-1,1,-1,1,1],_=[-1,1,1,-1,-1,1],f=[0,0,1,0,1,1],d=[0,1,1,0,0,1];function y(t){for(var e=0;e<t.length/2;e++)t[2*e]=(0,r.OK)(t[2*e]),t[2*e+1]=(0,r.ZA)(t[2*e+1])}function v(t,e,n){const r=new Float32Array(12*e),i=new Float32Array(12*e),o=new Float32Array(6*e);for(var a=0;a<e;a++)for(var s=0;s<6;s++){const e=t[10*a+2],n=t[10*a+3]*l[s],u=t[10*a+4]*_[s];r[12*a+2*s+0]=t[10*a+0]+n*Math.cos(e)-u*Math.sin(e),r[12*a+2*s+1]=t[10*a+1]+n*Math.sin(e)+u*Math.cos(e),i[12*a+2*s+0]=t[10*a+5]+f[s]*t[10*a+7],i[12*a+2*s+1]=t[10*a+6]+d[s]*t[10*a+8],o[6*a+s]=t[10*a+9]}y(r),u(r,i,o,n,6*e)}function m(t,e,n,r,o,a,s,u){if(n<=1)return;const c=new Float32Array(6*n),p=new Float32Array(n),h=new Float32Array(6*n),l=new Float32Array(3*n),_=new Int16Array(2*(n-1));for(var f=0,d=0;d<n-1;d++){const n=t[2*d],r=t[2*d+1],i=t[2*d+2],o=t[2*d+3],a=(n+i)/2,s=(r+o)/2,u=Math.sqrt((i-n)*(i-n)+(o-r)*(o-r));p[d]=u,f+=u,c[6*d+0]=n,c[6*d+1]=r,c[6*d+2]=a-(s-r)/u*e,c[6*d+3]=s+(a-n)/u*e,c[6*d+4]=a+(s-r)/u*e,c[6*d+5]=s-(a-n)/u*e}y(c),f-=p[0]/2+p[n-2]/2;var v=-p[0]/2;for(d=0;d<n-1;d++)h[6*d+0]=r+a*v/f,h[6*d+1]=o+s/2,v+=p[d]/2,h[6*d+2]=r+a*v/f,h[6*d+3]=o,h[6*d+4]=r+a*v/f,h[6*d+5]=o+s,v+=p[d]/2;for(d=0;d<3*n;d++)l[d]=1;for(d=0;d<n-1;d++)_[2*d+0]=3*d+1,_[2*d+1]=3*d+3;_[2*n-3]--;const m=i.gl,w=m.createBuffer(),g=i.shader.attribute.coord;m.bindBuffer(m.ARRAY_BUFFER,w),m.bufferData(m.ARRAY_BUFFER,c,m.STATIC_DRAW),m.vertexAttribPointer(g,2,m.FLOAT,!1,0,0),m.enableVertexAttribArray(g);const b=m.createBuffer(),x=i.shader.attribute.alpha;m.bindBuffer(m.ARRAY_BUFFER,b),m.bufferData(m.ARRAY_BUFFER,l,m.STATIC_DRAW),m.vertexAttribPointer(x,1,m.FLOAT,!1,0,0),m.enableVertexAttribArray(x);const M=m.createBuffer(),E=i.shader.attribute.tex;m.bindBuffer(m.ARRAY_BUFFER,M),m.bufferData(m.ARRAY_BUFFER,h,m.STATIC_DRAW),m.vertexAttribPointer(E,2,m.FLOAT,!1,0,0),m.enableVertexAttribArray(E),m.activeTexture(m.TEXTURE0),m.bindTexture(m.TEXTURE_2D,u),m.uniform1i(i.shader.uniform.uSampler,0);const A=m.createBuffer();for(m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,A),m.bufferData(m.ELEMENT_ARRAY_BUFFER,_,m.STATIC_DRAW),m.drawElements(m.TRIANGLE_STRIP,2*n-2,m.UNSIGNED_SHORT,0),d=0;d<n-1;d++)_[2*d+0]=3*d,_[2*d+1]=3*d+2;_[0]++,m.bufferData(m.ELEMENT_ARRAY_BUFFER,_,m.STATIC_DRAW),m.drawElements(m.TRIANGLE_STRIP,2*n-2,m.UNSIGNED_SHORT,0)}window.debug_info={},window.debug_info.global_gl=i,window.debug_info.gl_func={setup:o,clear:h,draw:u,drawStrip:c,drawRects:v,drawSnake:m}}},__webpack_module_cache__={};function __webpack_require__(t){if(__webpack_module_cache__[t])return __webpack_module_cache__[t].exports;var e=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](e,e.exports,__webpack_require__),e.exports}__webpack_require__.d=(t,e)=>{for(var n in e)__webpack_require__.o(e,n)&&!__webpack_require__.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{"use strict";var t={};__webpack_require__.r(t),__webpack_require__.d(t,{KEY_CLICK:()=>D,KEY_PRESS:()=>N,canvas_height:()=>y,canvas_width:()=>d,devicePixelRatio:()=>g,keys:()=>A,last_update_rate:()=>b,mainloop_start:()=>R,mainloop_terminate:()=>O,mouse:()=>E,setup_canvas:()=>T,test_fps:()=>x});var e,n,r=__webpack_require__(176),i=__webpack_require__(924),o=__webpack_require__(822),a=__webpack_require__(533),s=__webpack_require__(349),u=__webpack_require__(780),c=!1,p=!1,h=0,l=0,_=0,f=0;var d,y,v=0,m=0,w=null,g=1,b=1;function x(){return v=performance.now(),m=241,M(),new Promise(((t,e)=>{w=t}))}function M(){if(--m)requestAnimationFrame(M);else{var t=(performance.now()-v)/240;b=Math.round(t/(1e3/60)),w(b)}}var E={x:0,y:0},A={};function T(){document.onmousemove=t=>{E.x=t.pageX,E.y=t.pageY},document.ontouchstart=t=>{A._touch=3,E.x=t.pageX,E.y=t.pageY,t.preventDefault()},document.ontouchend=t=>{A._touch=1,E.x=t.pageX,E.y=t.pageY,t.preventDefault()},document.ontouchmove=t=>{E.x=t.pageX,E.y=t.pageY,t.preventDefault()},document.onmousedown=t=>{A._press=3},document.onmouseup=t=>{A._press=1},document.addEventListener("keydown",(t=>{var e=t.key;1==e.length&&(e=e.toLowerCase()),A[e]=3}),!1),document.addEventListener("keyup",(t=>{var e=t.key;1==e.length&&(e=e.toLowerCase()),A[e]=1}),!1);var t=window.innerWidth,e=window.innerHeight,n=.95*Math.min(t/s.Fy,e/s.bE),r=document.getElementById("glcanvas");d=n*s.Fy,y=n*s.bE,r.style.width=d+"px",r.style.height=y+"px",g=window.devicePixelRatio||1,r.width=d*g,r.height=y*g,i.setup()}var I,P,S=!1;async function R(){S||(S=!0,await function(){return t=this,r=void 0,a=function(){var t,r,o,a;return function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(s){switch(s.label){case 0:return r=(t=i).loadTexture,[4,i.loadImage("assets/ui_bg.png")];case 1:return e=r.apply(t,[s.sent(),!1,!0]),a=(o=i).loadTexture,[4,i.loadImage("assets/scene_bg.png")];case 2:return n=a.apply(o,[s.sent(),!1,!0]),[2]}}))},new((o=void 0)||(o=Promise))((function(e,n){function i(t){try{u(a.next(t))}catch(t){n(t)}}function s(t){try{u(a.throw(t))}catch(t){n(t)}}function u(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(t){t(n)}))).then(i,s)}u((a=a.apply(t,r||[])).next())}));var t,r,o,a}(),k())}function O(){S=!1}function k(){(I=performance.now())-P>33&&console.log(`Violation: interval takes ${Math.round(100*(I-P))/100} ms`),function(){var t=o.n.INSTANCE;if(t){var r=function(){if(A.Escape==D&&(c=!c),c)return p=!1,null;var t=0,e=0;A.Shift>=N||A._touch>=N||A._press>=N?(p||(p=!0,h=E.x,l=E.y,_=0,f=0),t=E.x-h-_,e=E.y-l-f,_+=t,f+=e):p=!1,t=t/d*s.Fy*2,e=-e/y*s.bE*2;var n=A.Shift>=N?2:3;return(A.w>=N||A.ArrowUp>=N)&&(e+=n),(A.s>=N||A.ArrowDown>=N)&&(e-=n),(A.a>=N||A.ArrowLeft>=N)&&(t-=n),(A.d>=N||A.ArrowRight>=N)&&(t+=n),{pos_x:t,pos_y:e,key_z:A.z>=N,key_x:A.x==D,key_c:A.c==D}}();if(!c&&(a.U.updateState(r),!c))for(var v=0;v<b;v++)t.update();i.clear();var m=new u.l;m.bind(n),s.io(m),m.flush(),t.render(),i.setMode(0),m.bind(e),s.ax(m),m.flush()}}(),function(){for(var t in A)3==A[t]&&(A[t]=2),1==A[t]&&(A[t]=0)}(),S&&requestAnimationFrame(k),(P=performance.now())-I>16&&console.log(`Violation: loop takes ${Math.round(100*(P-I))/100} ms`)}const N=2,D=3;window.onload=async function(){T(),window.debug_info.load_sprites=()=>{document.getElementById("loading").hidden=!0},await r.S(),__webpack_require__(235),R(),window.debug_info.stg={fps:x,init:r.S,start:R,terminate:O},window.debug_info.platform=t}})()})();