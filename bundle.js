(()=>{"use strict";var __webpack_modules__={349:(t,e,n)=>{n.d(e,{SH:()=>r,ZP:()=>i,Fy:()=>o,bE:()=>a,OK:()=>_,ZA:()=>s});var r=192,i=224,o=192,a=224;function _(t){return t/o}function s(t){return t/a}},869:(t,e,n)=>{n.d(e,{T:()=>i,ZE:()=>o,yR:()=>a,A4:()=>_,t_:()=>s,T7:()=>u,KZ:()=>c,DV:()=>l,P4:()=>p,k8:()=>h,Gs:()=>f,Io:()=>d,NH:()=>E,bm:()=>y,ZM:()=>r,d9:()=>v,S:()=>A});var r,i=0,o=1,a=2,_=3,s=4,u=5,c=0,l=1,p=1,h=1,f=14,d=0,E=0,y=500;function v(t){return Object.assign({},t)}!function(t){t[t.PRE_ENTRY=0]="PRE_ENTRY",t[t.ALIVE=1]="ALIVE",t[t.LEAVING=2]="LEAVING",t[t.DEAD=3]="DEAD"}(r||(r={}));var A={render_layer:700,collide_group:i,collide_mask:c}},651:(t,e,n)=>{n.d(e,{R0:()=>u,uQ:()=>l});var r,i=n(869),o=n(822),a=n(349),_=n(566),s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u={render_layer:i.bm,collide_group:i.A4,collide_mask:i.A4,kill_on_exit:!0,kill_by:function(t){return t==i.t_||t==i.T},auto_direction:!0,life:0,listener:null},c=function(t,e){return!0},l=function(t){function e(e,n){var r=t.call(this,e)||this;return r.state=i.ZM.PRE_ENTRY,r.motion=c,r.custom_fields={},r.config=n,r.time=0,r}return s(e,t),e.prototype.setMotion=function(t){return this.motion=t,this.simpleInit(0,0,0,0)},e.prototype.simpleInit=function(t,e,n,r){return this.px=t,this.py=e,this.vx=n*Math.cos(r),this.vy=n*Math.sin(r),this.dir=r,this.motion(this,0)&&this.config.auto_direction&&(this.dir=Math.atan2(this.vy,this.vx)),this},e.prototype.update=function(t){var e,n,r,a,_,s,u=this;this.state==i.ZM.PRE_ENTRY&&(this.state=i.ZM.ALIVE,null===(n=null===(e=this.config.listener)||void 0===e?void 0:e.onInit)||void 0===n||n.forEach((function(t){return t(u)})));var c=o.n.INSTANCE.special_effects.time_rate;this.time+=c,null===(a=null===(r=this.config.listener)||void 0===r?void 0:r.onUpdate)||void 0===a||a.forEach((function(t){return t(u,c)})),this.motion(this,c)&&(this.px+=this.vx*c,this.py+=this.vy*c,this.config.auto_direction&&(this.dir=Math.atan2(this.vy,this.vx))),null===(s=null===(_=this.config.listener)||void 0===_?void 0:_.onPostMotion)||void 0===s||s.forEach((function(t){return t(u,c)}))},e.prototype.postUpdate=function(t){var e,n,r,o,_,s,u,c,l=this;(null===(n=null===(e=this.shaped_sprite)||void 0===e?void 0:e.shape)||void 0===n?void 0:n.exitScreen(this.px,this.py,this.dir,a.SH,a.ZP))&&(this.config.kill_on_exit&&(this.state=i.ZM.LEAVING),null===(o=null===(r=this.config.listener)||void 0===r?void 0:r.onExitScreen)||void 0===o||o.forEach((function(t){return t(l)}))),this.config.life&&this.time>=this.config.life&&(this.state=i.ZM.LEAVING),null===(s=null===(_=this.config.listener)||void 0===_?void 0:_.onPostUpdate)||void 0===s||s.forEach((function(t){return t(l)})),this.state==i.ZM.LEAVING&&(null===(c=null===(u=this.config.listener)||void 0===u?void 0:u.onDestroy)||void 0===c||c.forEach((function(t){return t(l)})),this.state=i.ZM.DEAD)},e.prototype.attack=function(t,e){var n,r,i=this;null===(r=null===(n=this.config.listener)||void 0===n?void 0:n.onAttack)||void 0===r||r.forEach((function(t){return t(i,e)})),e.damaged(e,this)},e.prototype.damaged=function(t,e){var n,r,o=this;return!!this.config.kill_by(e.config.collide_group)&&(this.state=i.ZM.LEAVING,null===(r=null===(n=this.config.listener)||void 0===n?void 0:n.onKill)||void 0===r||r.forEach((function(t){return t(o,e)})),!0)},e}(_.eY)},533:(t,e,n)=>{n.d(e,{U:()=>u});var r,i=n(566),o=n(349),a=n(869),_=n(822),s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u=function(t){function e(n,r,i,o,_){var s=t.call(this,(0,a.d9)(n))||this;return s.config=a.S,s.state=a.ZM.ALIVE,s.miss=!1,s.bomb=!1,s.pre_miss=0,s.miss_time=0,s.invince_time=0,s.time=0,e.INSTANCE=s,s.proto=r,s.ability=i,s.sprite=n,s.px=o,s.py=_,s.dir=0,s}return s(e,t),e.updateState=function(t){e.action=t},e.prototype.update=function(t){e.action&&(this.px+=e.action.pos_x,this.py+=e.action.pos_y,this.px<-o.SH&&(this.px=-o.SH),this.px>o.SH&&(this.px=o.SH),this.py<-o.ZP&&(this.py=-o.ZP),this.py>o.ZP&&(this.py=o.ZP),this.time+=_.n.INSTANCE.special_effects.time_rate,this.dir=this.time*Math.PI*2/600,this.proto.updateShoot(e.action.key_z),this.bomb=this.proto.updateBomb(e.action.key_x),this.proto.updateSpecial(e.action.key_c))},e.prototype.postUpdate=function(t){this.miss_time>0&&this.miss_time--,this.pre_miss>0&&(this.pre_miss--,0==this.pre_miss&&(console.log("missed"),this.miss_time=this.ability.miss_time)),this.miss&&(this.miss=!1,this.pre_miss=this.ability.pre_miss),this.bomb&&(this.bomb=!1,this.miss_time=this.ability.bomb_time,this.pre_miss>0&&(console.log("bomb after miss"),this.pre_miss=0)),this.miss_time>0||this.pre_miss>0?(this.invince_time++,Math.floor(this.invince_time/6)%2==0?this.shaped_sprite.sprite=null:this.shaped_sprite.sprite=this.sprite.sprite):(this.invince_time=0,this.shaped_sprite.sprite=this.sprite.sprite)},e.prototype.attack=function(t,e){},e.prototype.damaged=function(t,e){return 0==this.pre_miss&&0==this.miss_time&&(this.miss=!0),e.damaged(e,this)},e.INSTANCE=null,e.action=null,e}(i.eY)},822:(t,e,n)=>{n.d(e,{n:()=>s});var r,i=n(869),o=n(566),a=n(68),_=function(){this.time_rate=1};!function(t){t[t.PRE_INIT=0]="PRE_INIT",t[t.UPDATE=1]="UPDATE",t[t.POST_UPDATE=2]="POST_UPDATE",t[t.ADD_BACK=3]="ADD_BACK"}(r||(r={}));var s=function(){function t(){this.groups=[],this.pending=[],this.update_stage=r.PRE_INIT,this.time=0,this.special_effects=new _,t.INSTANCE=this,this.groups.push({id:i.T,mask:i.KZ,list:[]}),this.groups.push({id:i.ZE,mask:i.DV,list:[]}),this.groups.push({id:i.yR,mask:i.P4,list:[]}),this.groups.push({id:i.A4,mask:i.k8,list:[]}),this.groups.push({id:i.t_,mask:i.Gs,list:[]}),this.groups.push({id:i.T7,mask:i.Io,list:[]})}return t.prototype.registerGroup=function(t){var e=this.groups.length;return this.groups.push({id:e,mask:t,list:[]}),e},t.prototype.add=function(t){this.update_stage!=r.ADD_BACK&&this.update_stage!=r.PRE_INIT?this.pending.push(t):this.groups[t.config.collide_group].list.push(t)},t.prototype.update=function(){var t=this;this.update_stage=r.UPDATE,this.groups.forEach((function(t){return t.list.forEach((function(t){return t.update(t)}))}));for(var e=0;e<this.groups.length;e++)for(var n=0;n<this.groups.length;n++)if(this.groups[e].mask&1<<n)for(var a=0,_=this.groups[e].list;a<_.length;a++){var s=_[a];if(s.state==i.ZM.ALIVE&&s.shaped_sprite&&s.shaped_sprite.shape)for(var u=0,c=this.groups[n].list;u<c.length;u++){var l=c[u];l.state==i.ZM.ALIVE&&l.shaped_sprite&&l.shaped_sprite.shape&&(0,o._R)(s,l)&&s.attack(s,l)}}this.update_stage=r.POST_UPDATE,this.groups.forEach((function(t){return t.list.forEach((function(t){return t.postUpdate(t)}))})),this.groups.forEach((function(t){return t.list=t.list.filter((function(t){return t.state!=i.ZM.DEAD}))})),this.update_stage=r.ADD_BACK,this.pending.forEach((function(e){return t.add(e)})),this.pending=[],this.time++},t.prototype.render=function(){var t,e,n,r,i,o,_,s;return i=this,o=void 0,s=function(){var i,o,_,s,u,c,l,p,h,f;return function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:_(0),throw:_(1),return:_(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function _(o){return function(_){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,_])}}}(this,(function(d){for(i=new Map,o=0,_=this.groups;o<_.length;o++)for(s=_[o],u=0,c=s.list;u<c.length;u++)(l=c[u]).config.render_layer&&(null===(t=l.shaped_sprite)||void 0===t?void 0:t.sprite)&&(i.has(l.config.render_layer)||i.set(l.config.render_layer,new Map),p=i.get(l.config.render_layer),h=null===(r=null===(n=null===(e=l.shaped_sprite)||void 0===e?void 0:e.sprite)||void 0===n?void 0:n.sprite)||void 0===r?void 0:r.path,p.has(h)||p.set(h,[]),p.get(h).push(l));return f=[],i.forEach((function(t,e){return f.push({rl:e,v:t})})),f.sort((function(t,e){return t.rl-e.rl})),f.forEach((function(t){return t.v.forEach((function(t,e){return a.Z.get(e).draw(t)}))})),[2]}))},new((_=void 0)||(_=Promise))((function(t,e){function n(t){try{a(s.next(t))}catch(t){e(t)}}function r(t){try{a(s.throw(t))}catch(t){e(t)}}function a(e){var i;e.done?t(e.value):(i=e.value,i instanceof _?i:new _((function(t){t(i)}))).then(n,r)}a((s=s.apply(i,o||[])).next())}))},t}()},334:(t,e,n)=>{n.d(e,{FX:()=>l,hP:()=>d,b2:()=>y});var r,i=n(869),o=n(566),a=n(822),_=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,_=o.length;a<_;a++,i++)r[i]=o[a];return r},u=function(){},c=function(t){function e(e){var n=t.call(this)||this;return n.remain=e,n}return _(e,t),e.prototype.update=function(t){return this.remain-=t,this.remain<0?-this.remain:0},e}(u),l=function(t){function e(e,n,r,i,o){var a=t.call(this)||this;return a.time=0,a.target=e,a.duration=n,a.dx=r,a.dy=i,a.x0=e.px,a.y0=e.py,a.ease=o,a}return _(e,t),e.random=function(t,n){var r=Math.max(n.px0-t.px,-n.dx1),i=Math.min(n.px1-t.px,n.dx1),o=Math.max(n.py0-t.py,-n.dy1),a=Math.min(n.py1-t.py,n.dy1),_=r+Math.random()*(i-r),s=o+Math.random()*(a-o);return new e(t,n.duration,_,s,n.ease)},e.prototype.update=function(t){this.time+=t;var e=Math.min(1,this.time/this.duration),n=this.ease(e);return this.target.px=this.x0+this.dx*n,this.target.py=this.y0+this.dy*n,this.time>this.duration?this.time-this.duration:0},e}(u),p=function(t){function e(e){var n=t.call(this)||this;return n.todo=e,n}return _(e,t),e.prototype.update=function(t){return this.todo(),t},e}(u),h=function(){};function f(t){return t.map((function(t){return"number"==typeof t?new c(t):"function"==typeof t?new p(t):t}))}var d=function(t){function e(e,n){var r=t.call(this)||this;return r.index=0,r.todo=e,r.total=n,r}return _(e,t),e.prototype.supply=function(){return this.index>=this.total?null:(t="function"==typeof this.todo?this.todo(this.index):this.todo,this.index++,f(t));var t},e}(h),E={render_layer:i.NH,collide_group:i.T7,collide_mask:i.Io},y=function(t){function e(e){var n=t.call(this)||this;return n.config=E,n.state=i.ZM.PRE_ENTRY,n.time=0,n.list=f(e),n}return _(e,t),e.prototype.update=function(t){this.state==i.ZM.PRE_ENTRY&&(this.state=i.ZM.ALIVE);var e=a.n.INSTANCE.special_effects.time_rate;for(this.time+=e;this.list.length>0&&e;){var n=this.list[0];if(n instanceof h){var r=n.supply();r&&r.length?this.list=s(r,this.list):this.list.shift()}else(e=n.update(e))>0&&this.list.shift()}0==this.list.length&&(this.state=i.ZM.LEAVING)},e.prototype.postUpdate=function(t){this.state==i.ZM.LEAVING&&(this.state=i.ZM.DEAD)},e.prototype.attack=function(t){},e.prototype.damaged=function(t,e){return!1},e}(o.u5)},176:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{S:()=>init});var _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(651),_entity_SelfMachine__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(533),_stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(334),_util_SpriteManager__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(68),_util_sprites__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(940),_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(551),_stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(822),_entity_Entity__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(869),__awaiter=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{s(r.next(t))}catch(t){o(t)}}function _(t){try{s(r.throw(t))}catch(t){o(t)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,_)}s((r=r.apply(t,e||[])).next())}))},__generator=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:_(0),throw:_(1),return:_(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function _(o){return function(_){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,_])}}},sm_proto={updateShoot:function(t){return!1},updateBomb:function(t){return!1},updateSpecial:function(t){return!1}},sm_abi={pre_miss:30,miss_time:60,bomb_time:60},repeat=function(t,e){return void 0===e&&(e=1/0),new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.hP(t,e)},stage_000=function(t){var e=_util_sprites__WEBPACK_IMPORTED_MODULE_4__.hZ(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.Dp.Oval,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.C8.Red,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.fz.Overlay),n=_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.x(e,1);return new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([30*t,repeat((function(e){return[repeat((function(r){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(n,_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0).simpleInit(0,0,8/t,.003/t*e*e+2*Math.PI/5*r))}]}),5),1*t]}),1/0)])},stage_001=function(t){var e=function(t){return _util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.x(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.e8(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qb.Scale,t,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.fz.Overlay),1)},n=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0);n.life=180*t,n.kill_on_exit=!1;var r={duration:100*t,px0:-96,px1:96,py0:32,py1:112,dx1:64,dy1:64,ease:function(t){return(1-Math.cos(Math.PI*t))/2}},i=1*t,o=3/t,a=-o/70,_=.06/t,s=new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.x(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.cI,2),_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0).setMotion((function(t){return t.dir=t.time*Math.PI*2/600,!1})).simpleInit(0,64,0,0),u=null,c=function(t,e,r,c){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([repeat((function(l){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(u=new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(null,n).simpleInit(s.px,s.py,o,2*Math.PI/47*l*e*t))},repeat((function(e){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(l%2==0?r:c,_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0).setMotion((n=u,i=2*Math.PI/30*e,o=_*t,70,s=a,function(t,e){var r=i+o*t.time,a=70*Math.sin(s*t.time);return t.px=n.px+a*Math.cos(r),t.py=n.py+a*Math.sin(r),t.dir=Math.atan2(a*o,70*s*Math.cos(s*t.time))+r,!1})));var n,i,o,s}]}),30),i]}),47)]))};return new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(s)},30*t,repeat((function(n){return[function(){return c(n%2*2-1,7,e(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Red),e(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Green))},50*t,function(){return c(n%2*2-1,5,e(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Yellow),e(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Blue))},50*t,function(){return c(n%2*2-1,1,e(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Cyan),e(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Pink))},_stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.FX.random(s,r)]}))])},sinit={load_sprite:function(){return _util_SpriteManager__WEBPACK_IMPORTED_MODULE_3__.Z.get(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.Xp.path).load()},add_player:function(){return new _entity_SelfMachine__WEBPACK_IMPORTED_MODULE_1__.U(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.x(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.a_,1),sm_proto,sm_abi,0,-192)},add_schedule:stage_001};function init(){return __awaiter(this,void 0,void 0,(function(){var pool;return __generator(this,(function(_a){switch(_a.label){case 0:return[4,sinit.load_sprite()];case 1:return _a.sent(),pool=new _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n,pool.add(sinit.add_player()),pool.add(sinit.add_schedule(3)),eval("window.debug_info.pool = pool"),[2]}}))}))}},566:(t,e,n)=>{n.d(e,{bn:()=>_,D8:()=>s,Yw:()=>u,hE:()=>c,eY:()=>l,u5:()=>p,_R:()=>h});var r,i,o=n(68),a=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),_=function(){},s=function(t){function e(e){var n=t.call(this)||this;return n.radius=e,n}return a(e,t),e.prototype.exitScreen=function(t,e,n,r,i){return Math.abs(t)>r+this.radius||Math.abs(e)>i+this.radius},e.prototype.distanceTo=function(t,e,n){return e-=t.px,n-=t.py,Math.sqrt(e*e+n*n)-this.radius*t.magn},e}(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e}(_)),u=function(){},c=(a((function(){return null!==i&&i.apply(this,arguments)||this}),i=u),function(){function t(t,e){this.renderType=t,this.shaped_sprite=e}return t.prototype.distanceTo=function(t,e){return this.shaped_sprite.shape.distanceTo(this,t,e)},t}()),l=function(t){function e(e){var n=t.call(this,o.I.RECT,e)||this;return n.magn=1,n.alpha=1,n}return a(e,t),e.prototype.rectCount=function(){return 1},e.prototype.render=function(t,e){t[10*e+0]=this.px,t[10*e+1]=this.py,t[10*e+2]=this.dir-Math.PI/2,t[10*e+3]=this.shaped_sprite.w/2*this.magn,t[10*e+4]=this.shaped_sprite.h/2*this.magn;var n=this.shaped_sprite.sprite;t[10*e+5]=n.tx/n.sprite.w,t[10*e+6]=n.ty/n.sprite.h,t[10*e+7]=n.tw/n.sprite.w,t[10*e+8]=n.th/n.sprite.h,t[10*e+9]=this.alpha},e}(c),p=function(t){function e(){return t.call(this,null,null)||this}return a(e,t),e}(c);function h(t,e){if(t instanceof l&&t.shaped_sprite.shape instanceof s)return e.distanceTo(t.px,t.py)<t.shaped_sprite.shape.radius;if(e instanceof l&&e.shaped_sprite.shape instanceof s)return h(e,t);throw new Error("non-circle non-circle collision not found")}},68:(t,e,n)=>{n.d(e,{I:()=>r,Z:()=>a});var r,i=n(924),o=n(940);!function(t){t[t.RECT=0]="RECT",t[t.STRIP=1]="STRIP"}(r||(r={}));var a=function(){function t(t){this.img=null,this.path=t}return t.prototype.loaded=function(){return this.img},t.prototype.load=function(){return t=this,e=void 0,r=function(){var t;return function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:_(0),throw:_(1),return:_(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function _(o){return function(_){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,_])}}}(this,(function(e){switch(e.label){case 0:return[4,i.po(this.path)];case 1:return t=e.sent(),this.img=i.yG(t),[2]}}))},new((n=void 0)||(n=Promise))((function(i,o){function a(t){try{s(r.next(t))}catch(t){o(t)}}function _(t){try{s(r.throw(t))}catch(t){o(t)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,_)}s((r=r.apply(t,e||[])).next())}));var t,e,n,r},t.get=function(e){return t.INS[e]?t.INS[e]:t.INS[e]=new t(e)},t.prototype.draw=function(t){this.drawRect(t,o.fz.Overlay),this.drawRect(t,o.fz.AddBlend);for(var e=0,n=t;e<n.length;e++){var a=n[e];if(a.renderType==r.STRIP)for(var _=a,s=_.getSprite(),u=s.sprite,c=0,l=_.render();c<l.length;c++){var p=l[c];i.AJ(p,s.w,p.length/2,u.tx,u.ty,u.tw,u.th,this.img)}}},t.prototype.drawRect=function(t,e){var n=t.reduce((function(t,n){return n.renderType==r.RECT&&n.shaped_sprite.sprite.mode==e?t+n.rectCount():t}),0);if(n){i.PM(e);for(var o=new Float32Array(10*n),a=0,_=0,s=t;_<s.length;_++){var u=s[_];if(u.renderType==r.RECT&&u.shaped_sprite.sprite.mode==e){var c=u;c.render(o,a),a+=c.rectCount()}}i.bn(o,t.length,this.img)}},t.INS={},t}()},551:(t,e,n)=>{n.d(e,{x:()=>p});var r,i,o,a=n(566),_=n(68),s=n(822),u=n(869),c=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});!function(t){function e(e){var n=t.call(this)||this;return n.func=e,n}c(e,t),e.prototype.distanceTo=function(t,e,n){return this.func(t,e,n)},e.line_circle=function(t,e,n){var r=t.px,i=t.py,o=t.px+t.len*Math.cos(t.dir),a=t.py+t.len*Math.sin(t.dir),_=Math.sqrt((r-o)*(r-o)+(i-a)*(i-a)),s=Math.abs((o-r)*(i-n)-(r-e)*(a-i)),u=Math.sqrt((r-e)*(r-e)+(i-n)*(i-n)),c=Math.sqrt((o-e)*(o-e)+(a-n)*(a-n));return Math.min(s/_,u,c)-t.shaped_sprite.w_ratio*t.w}}(a.bn),function(t){t[t.WARNING=0]="WARNING",t[t.OPENING=1]="OPENING",t[t.OPENED=2]="OPENED",t[t.CLOSING=3]="CLOSING"}(i||(i={})),o=a.Yw,c((function(){return null!==o&&o.apply(this,arguments)||this}),o),function(t){function e(e,n,r){var o=t.call(this,e)||this;return o.state=u.ZM.PRE_ENTRY,o.rstate=i.WARNING,o.config=n,o.motion=r,o}c(e,t),e.prototype.update=function(t){var e,n,r,o,a,_,c,l,p,h,f,d,E=this;(this.state=u.ZM.PRE_ENTRY)&&(this.state=u.ZM.ALIVE,null===(n=null===(e=this.config.listener)||void 0===e?void 0:e.onInit)||void 0===n||n.forEach((function(t){return t(E)})));var y=s.n.INSTANCE.special_effects.time_rate;this.time+=y,this.rstate==i.WARNING&&this.time>=this.config.warning_time&&(this.rstate=i.OPENING,null===(o=null===(r=this.config.listener)||void 0===r?void 0:r.onStateChange)||void 0===o||o.forEach((function(t){return t(E)}))),this.rstate==i.OPENING&&this.time>=this.config.open_time&&(this.rstate=i.OPENED,this.w=1,null===(_=null===(a=this.config.listener)||void 0===a?void 0:a.onStateChange)||void 0===_||_.forEach((function(t){return t(E)}))),this.rstate==i.OPENED&&this.time>=this.config.alive_time&&(this.rstate=i.CLOSING,this.w=-1/0,null===(l=null===(c=this.config.listener)||void 0===c?void 0:c.onStateChange)||void 0===l||l.forEach((function(t){return t(E)}))),this.rstate==i.CLOSING&&this.time>=this.config.close_time&&(this.state=u.ZM.LEAVING),null===(h=null===(p=this.config.listener)||void 0===p?void 0:p.onUpdate)||void 0===h||h.forEach((function(t){return t(E,y)})),this.motion(this,y),null===(d=null===(f=this.config.listener)||void 0===f?void 0:f.onPostMotion)||void 0===d||d.forEach((function(t){return t(E,y)}))},e.prototype.postUpdate=function(t){var e,n,r,i,o=this;null===(n=null===(e=this.config.listener)||void 0===e?void 0:e.onPostUpdate)||void 0===n||n.forEach((function(t){return t(o)})),this.state==u.ZM.LEAVING&&(null===(i=null===(r=this.config.listener)||void 0===r?void 0:r.onDestroy)||void 0===i||i.forEach((function(t){return t(o)})),this.state=u.ZM.DEAD)},e.prototype.attack=function(t,e){var n,r,i=this;null===(r=null===(n=this.config.listener)||void 0===n?void 0:n.onAttack)||void 0===r||r.forEach((function(t){return t(i,e)})),e.damaged(e,this)},e.prototype.damaged=function(t,e){var n,r,i=this;return null===(r=null===(n=this.config.listener)||void 0===n?void 0:n.onContact)||void 0===r||r.forEach((function(t){return t(i,e)})),!1}}(function(t){function e(e){var n=t.call(this,_.I.RECT,e)||this;return n.w=-1/0,n}return c(e,t),e.prototype.rectCount=function(){return 1},e.prototype.render=function(t,e){t[10*e+0]=this.px+this.len*Math.cos(this.dir),t[10*e+1]=this.py+this.len*Math.sin(this.dir),t[10*e+2]=this.dir,t[10*e+3]=Math.max(1,this.shaped_sprite.w_ratio*this.w),t[10*e+4]=this.shaped_sprite.l_ratio/2*this.len;var n=this.shaped_sprite.sprite;t[10*e+5]=n.tx/n.sprite.w,t[10*e+6]=n.ty/n.sprite.h,t[10*e+7]=n.tw/n.sprite.w,t[10*e+8]=n.th/n.sprite.h,t[10*e+9]=1},e}(a.hE));var l=[[1.4,0],[2.4,2.4,4,4,2.4,2.4,2.4,2.8,2.4,2.4,4,2.4,2.4,2.4,2.4,2.4],[6,7,8.5,7,6,7,0,10],[14,14]];function p(t,e){return e*=.75,{sprite:t,shape:new a.D8(l[t.category][t.type]*e),w:t.tw*e,h:t.th*e,renderType:_.I.RECT}}},940:(t,e,n)=>{var r,i,o,a,_,s,u,c;n.d(e,{fz:()=>r,qO:()=>o,qb:()=>a,C8:()=>_,Dp:()=>s,Xp:()=>l,e8:()=>p,hZ:()=>h,a_:()=>f,cI:()=>d}),function(t){t[t.Overlay=0]="Overlay",t[t.AddBlend=1]="AddBlend"}(r||(r={})),function(t){t[t.Special=0]="Special",t[t.Small=1]="Small",t[t.Medium=2]="Medium",t[t.Large=3]="Large"}(i||(i={})),function(t){t[t.Grey=0]="Grey",t[t.RedX=1]="RedX",t[t.Red=2]="Red",t[t.PinkX=3]="PinkX",t[t.Pink=4]="Pink",t[t.BlueX=5]="BlueX",t[t.Blue=6]="Blue",t[t.CyanX=7]="CyanX",t[t.Cyan=8]="Cyan",t[t.GreenX=9]="GreenX",t[t.Green=10]="Green",t[t.Lemon=11]="Lemon",t[t.YellowX=12]="YellowX",t[t.Yellow=13]="Yellow",t[t.Orange=14]="Orange",t[t.White=15]="White"}(o||(o={})),function(t){t[t.Laser=0]="Laser",t[t.Scale=1]="Scale",t[t.Ring=2]="Ring",t[t.Ball=3]="Ball",t[t.Grain=4]="Grain",t[t.Niddle=5]="Niddle",t[t.Knife=6]="Knife",t[t.Spell=7]="Spell",t[t.Bullet=8]="Bullet",t[t.Germ=9]="Germ",t[t.Star=10]="Star",t[t.Planet=11]="Planet",t[t.S_Cross=12]="S_Cross",t[t.S_Ball=13]="S_Ball",t[t.Curve=14]="Curve",t[t.Drop=15]="Drop"}(a||(a={})),function(t){t[t.Grey=0]="Grey",t[t.Red=1]="Red",t[t.Pink=2]="Pink",t[t.Blue=3]="Blue",t[t.Cyan=4]="Cyan",t[t.Green=5]="Green",t[t.Yellow=6]="Yellow",t[t.White=7]="White"}(_||(_={})),function(t){t[t.Light=0]="Light",t[t.Star=1]="Star",t[t.Ball=2]="Ball",t[t.Butterfly=3]="Butterfly",t[t.Knife=4]="Knife",t[t.Oval=5]="Oval",t[t.LightX=6]="LightX",t[t.Heart=7]="Heart"}(s||(s={})),function(t){t[t.Red=0]="Red",t[t.Blue=1]="Blue",t[t.Green=2]="Green",t[t.Yellow=3]="Yellow"}(u||(u={})),function(t){t[t.Ball=0]="Ball",t[t.Rose=1]="Rose"}(c||(c={}));var l={path:"assets/bullet_000.png",w:516,h:772};function p(t,e,n){return{sprite:l,tx:t<12?1+16*e:t<14?1+e%8*8:t<15?1:258+16*e,ty:t<12?1+16*t:t<14?(t<13?193:241)+8*(e>>3):e<15?515+16*e:449,tw:t<12?16:t<14?8:t<15?256:16,th:t<12?16:t<14?8:16,mode:n,category:i.Small,type:t,color:e}}function h(t,e,n){return{sprite:l,tx:(t<7?1:258)+32*e,ty:0==t?209:t<7?226+32*t:257,tw:32,th:32,mode:n,category:i.Medium,type:t,color:e}}var f={sprite:l,tx:258,ty:17,tw:64,th:64,mode:r.Overlay,category:i.Special,type:0,color:0},d=(r.Overlay,i.Special,{sprite:l,tx:386,ty:81,tw:128,th:128,mode:r.Overlay,category:i.Special,type:2,color:0})},924:(t,e,n)=>{n.d(e,{cY:()=>a,PM:()=>_,po:()=>s,yG:()=>c,ZH:()=>l,bn:()=>E,AJ:()=>y});var r=n(349),i=n(940);const o={gl:null,shader:{program:0,attribute:{coord:0,tex:0,alpha:0},uniform:{uSampler:0}}};function a(){var t=document.getElementById("glcanvas"),e=t.getContext("webgl");if(null===e)return void alert("Unable to initialize WebGL. Your browser or machine may not support it.");o.gl=e;var n=e.createShader(e.VERTEX_SHADER),r=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(n,"\nattribute vec2 coord;\nattribute vec2 tex;\nattribute float alpha;\nvarying highp vec2 vTexCoord;\nvarying highp float vTexAlpha;\nvoid main() {\n    gl_Position = vec4(coord, 0.0, 1.0);\n    vTexCoord = tex;\n    vTexAlpha = alpha;\n}\n"),e.shaderSource(r,"\nprecision highp float;\nvarying highp vec2 vTexCoord;\nvarying highp float vTexAlpha;\nuniform sampler2D uSampler;\nvoid main() {\n    vec4 col = texture2D(uSampler, vTexCoord);\n    col.a *= vTexAlpha;\n    gl_FragColor = col;\n}\n"),e.compileShader(n),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS)){var i=e.getShaderInfoLog(r);return void console.log(i)}var a=e.createProgram();e.attachShader(a,n),e.attachShader(a,r),e.linkProgram(a),e.useProgram(a);const _=o.shader;_.program=a,_.attribute.coord=e.getAttribLocation(a,"coord"),_.attribute.tex=e.getAttribLocation(a,"tex"),_.attribute.alpha=e.getAttribLocation(a,"alpha"),_.uniform.uSampler=e.getUniformLocation(a,"uSampler"),e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.disable(e.DEPTH_TEST),e.viewport(0,0,t.width,t.height)}function _(t){const e=o.gl;t==i.fz.Overlay?e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA):t==i.fz.AddBlend&&e.blendFunc(e.SRC_ALPHA,e.SRC_ALPHA)}function s(t){return new Promise(((e,n)=>{let r=new Image;r.onload=()=>e(r),r.onerror=n,r.src=t}))}function u(t,e,n,r,i){const a=o.gl,_=a.createBuffer(),s=o.shader.attribute.coord;a.bindBuffer(a.ARRAY_BUFFER,_),a.bufferData(a.ARRAY_BUFFER,t,a.STATIC_DRAW),a.vertexAttribPointer(s,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(s);const u=a.createBuffer(),c=o.shader.attribute.tex;a.bindBuffer(a.ARRAY_BUFFER,u),a.bufferData(a.ARRAY_BUFFER,e,a.STATIC_DRAW),a.vertexAttribPointer(c,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(c);const l=a.createBuffer(),p=o.shader.attribute.alpha;a.bindBuffer(a.ARRAY_BUFFER,l),a.bufferData(a.ARRAY_BUFFER,n,a.STATIC_DRAW),a.vertexAttribPointer(p,1,a.FLOAT,!1,0,0),a.enableVertexAttribArray(p),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,r),a.uniform1i(o.shader.uniform.uSampler,0),a.drawArrays(a.TRIANGLES,0,i)}function c(t){const e=o.gl,n=e.createTexture();return e.bindTexture(e.TEXTURE_2D,n),e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_SHORT_4_4_4_4,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),n}function l(){const t=o.gl;t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT),t.clearColor(0,0,1,1)}const p=[1,-2,-1,1,0,-1],h=[0,0,1,0,1,1],f=[0,1,1,0,0,1];function d(t){for(var e=0;e<t.length/2;e++)t[2*e]=(0,r.OK)(t[2*e]),t[2*e+1]=(0,r.ZA)(t[2*e+1])}function E(t,e,n){const r=new Float32Array(12*e),i=new Float32Array(12*e),o=new Float32Array(6*e),a=Math.PI/2;for(var _=0;_<e;_++)for(var s=0;s<6;s++){const e=t[10*_+2]+p[s]*a;r[12*_+2*s+0]=t[10*_+0]+t[10*_+3]*Math.cos(e)-t[10*_+4]*Math.sin(e),r[12*_+2*s+1]=t[10*_+1]+t[10*_+3]*Math.sin(e)+t[10*_+4]*Math.cos(e),i[12*_+2*s+0]=t[10*_+5]+h[s]*t[10*_+7],i[12*_+2*s+1]=t[10*_+6]+f[s]*t[10*_+8],o[6*_+s]=t[10*_+9]}d(r),u(r,i,o,n,6*e)}function y(t,e,n,r,i,a,_,s){const u=new Float32Array(6*n),c=new Float32Array(n),l=new Float32Array(6*n),p=new Int16Array(2*(n-1));for(var h=0,f=0;f<n-1;f++){const n=t[2*f],r=t[2*f+1],i=t[2*f+2],o=t[2*f+3],a=(n+i)/2,_=(r+o)/2,s=Math.sqrt((i-n)*(i-n)+(o-r)*(o-r));c[f]=s,h+=s,u[6*f+0]=n,u[6*f+1]=r,u[6*f+2]=a-(_-r)/s*e,u[6*f+3]=_+(a-n)/s*e,u[6*f+4]=a+(_-r)/s*e,u[6*f+5]=_-(a-n)/s*e}d(u),h-=c[0]/2+c[n-1]/2;var E=-c[0]/2;for(f=1;f<n;f++)l[6*f+0]=r+a*E/h,l[6*f+1]=i+_/2,E+=c[f]/2,l[6*f+2]=r+a*E/h,l[6*f+3]=i,l[6*f+4]=r+a*E/h,l[6*f+5]=i+_,E+=c[f]/2;for(f=0;f<n-1;f++)p[2*f+0]=3*f+1,p[2*f+1]=3*f+3;p[2*n-3]--;const y=o.gl,v=y.createBuffer(),A=o.shader.attribute.coord;y.bindBuffer(y.ARRAY_BUFFER,v),y.bufferData(y.ARRAY_BUFFER,u,y.STATIC_DRAW),y.vertexAttribPointer(A,2,y.FLOAT,!1,0,0),y.enableVertexAttribArray(A);const m=y.createBuffer(),g=o.shader.attribute.tex;y.bindBuffer(y.ARRAY_BUFFER,m),y.bufferData(y.ARRAY_BUFFER,l,y.STATIC_DRAW),y.vertexAttribPointer(g,2,y.FLOAT,!1,0,0),y.enableVertexAttribArray(g),y.activeTexture(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,s),y.uniform1i(o.shader.uniform.uSampler,0);const P=y.createBuffer();for(y.bindBuffer(y.ELEMENT_ARRAY_BUFFER,P),y.bufferData(y.ELEMENT_ARRAY_BUFFER,p,y.STATIC_DRAW),y.drawElements(y.TRIANGLE_STRIP,2*n-2,y.UNSIGNED_SHORT,0),f=0;f<n-1;f++)p[2*f+0]=3*f,p[2*f+1]=3*f+2;p[0]++,y.bufferData(y.ELEMENT_ARRAY_BUFFER,p,y.STATIC_DRAW),y.drawElements(y.TRIANGLE_STRIP,2*n-2,y.UNSIGNED_SHORT,0)}window.debug_info={},window.debug_info.global_gl=o,window.debug_info.gl_func={setup:a,clear:l,draw:u,drawStrip:function(t,e,n,r,i){const a=o.gl,_=a.createBuffer(),s=o.shader.attribute.coord;a.bindBuffer(a.ARRAY_BUFFER,_),a.bufferData(a.ARRAY_BUFFER,t,a.STATIC_DRAW),a.vertexAttribPointer(s,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(s);const u=a.createBuffer(),c=o.shader.attribute.tex;a.bindBuffer(a.ARRAY_BUFFER,u),a.bufferData(a.ARRAY_BUFFER,e,a.STATIC_DRAW),a.vertexAttribPointer(c,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(c);const l=a.createBuffer();a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,l),a.bufferData(a.ELEMENT_ARRAY_BUFFER,n,a.STATIC_DRAW),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,r),a.uniform1i(o.shader.uniform.uSampler,0),a.drawElements(a.TRIANGLE_STRIP,i,a.UNSIGNED_SHORT,0)},drawRects:E,drawSnake:y}}},__webpack_module_cache__={};function __webpack_require__(t){if(__webpack_module_cache__[t])return __webpack_module_cache__[t].exports;var e=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](e,e.exports,__webpack_require__),e.exports}__webpack_require__.d=(t,e)=>{for(var n in e)__webpack_require__.o(e,n)&&!__webpack_require__.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t={};__webpack_require__.r(t),__webpack_require__.d(t,{KEY_CLICK:()=>O,KEY_PRESS:()=>D,canvas_height:()=>h,canvas_width:()=>p,devicePixelRatio:()=>y,keys:()=>P,last_update_rate:()=>v,mainloop_start:()=>T,mainloop_terminate:()=>M,mouse:()=>g,setup_canvas:()=>R,test_fps:()=>A});var e=__webpack_require__(176),n=__webpack_require__(924),r=__webpack_require__(822),i=__webpack_require__(533),o=__webpack_require__(349),a=!1,_=!1,s=0,u=0,c=0,l=0;var p,h,f=0,d=0,E=null,y=1,v=1;function A(){return f=performance.now(),d=241,m(),new Promise(((t,e)=>{E=t}))}function m(){if(--d)requestAnimationFrame(m);else{var t=(performance.now()-f)/240;v=Math.round(t/(1e3/60)),E(v)}}var g={x:0,y:0},P={};function R(){document.onmousemove=t=>{g.x=t.pageX,g.y=t.pageY},document.ontouchstart=t=>{P._touch=3,g.x=t.pageX,g.y=t.pageY,t.preventDefault()},document.ontouchend=t=>{P._touch=1,g.x=t.pageX,g.y=t.pageY,t.preventDefault()},document.ontouchmove=t=>{g.x=t.pageX,g.y=t.pageY,t.preventDefault()},document.onmousedown=t=>{P._press=3},document.onmouseup=t=>{P._press=1},document.addEventListener("keydown",(t=>{var e=t.key;1==e.length&&(e=e.toLowerCase()),P[e]=3}),!1),document.addEventListener("keyup",(t=>{var e=t.key;1==e.length&&(e=e.toLowerCase()),P[e]=1}),!1);var t=window.innerWidth,e=window.innerHeight,r=.95*Math.min(t/o.Fy,e/o.bE),i=document.getElementById("glcanvas");p=r*o.Fy,h=r*o.bE,i.style.width=p+"px",i.style.height=h+"px",y=window.devicePixelRatio||1,i.width=p*y,i.height=h*y,n.cY()}var b=!1;function T(){b||(b=!0,w())}function M(){b=!1}function w(){!function(){var t=r.n.INSTANCE;if(t){var e=function(){if(P.Escape==O&&(a=!a),a)return _=!1,null;var t=0,e=0;P.Shift>=D||P._touch>=D||P._press>=D?(_||(_=!0,s=g.x,u=g.y,c=0,l=0),t=g.x-s-c,e=g.y-u-l,c+=t,l+=e):_=!1,t=t/p*o.Fy*2,e=-e/h*o.bE*2;var n=P.Shift>=D?2:3;return(P.w>=D||P.ArrowUp>=D)&&(e+=n),(P.s>=D||P.ArrowDown>=D)&&(e-=n),(P.a>=D||P.ArrowLeft>=D)&&(t-=n),(P.d>=D||P.ArrowRight>=D)&&(t+=n),{pos_x:t,pos_y:e,key_z:P.z>=D,key_x:P.x==O,key_c:P.c==O}}();if(!a&&(i.U.updateState(e),!a))for(var f=0;f<v;f++)t.update();n.ZH(),t.render()}}(),function(){for(var t in P)3==P[t]&&(P[t]=2),1==P[t]&&(P[t]=0)}(),b&&requestAnimationFrame(w)}const D=2,O=3;window.onload=async function(){A(),R(),await e.S(),T(),window.debug_info.stg={fps:A,init:e.S,start:T,terminate:M},window.debug_info.platform=t}})()})();