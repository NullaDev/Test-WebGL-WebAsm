(()=>{"use strict";var __webpack_modules__={349:(t,e,n)=>{n.d(e,{SH:()=>_,ZP:()=>i,Fy:()=>r,bE:()=>o,OK:()=>a,ZA:()=>s});var _=192,i=224,r=192,o=224;function a(t){return t/r}function s(t){return t/o}},799:(t,e,n)=>{n.d(e,{Fe:()=>i,wv:()=>r,cf:()=>o,DP:()=>a});var _=n(349),i={onInit:[],onUpdate:[],onPostMotion:[],onPostUpdate:[],onAttack:[],onDestroy:[],onExitScreen:[],onKill:[]},r={w0:-_.SH,w1:_.SH,h0:-_.ZP,h1:_.ZP,max:1/0,inner_bound:!0,outer_bound:!1},o=function(t){return function(e){e.onInit.push((function(e){var n=e.custom_fields;n.in_screen=e.px>t.w0&&e.px<t.w1&&e.py>t.h0&&e.py<t.h1,n.ref_count=0})),e.onPostMotion.push((function(e,n){var _=e.custom_fields,i=_.in_screen;_.in_screen=e.px>t.w0&&e.px<t.w1&&e.py>t.h0&&e.py<t.h1,i&&!_.in_screen&&t.inner_bound&&(_.ref_count<t.max&&e.px<=t.w0&&(_.ref_count++,e.vx=-e.vx,e.px=2*t.w0-e.px),_.ref_count<t.max&&e.px>=t.w1&&(_.ref_count++,e.vx=-e.vx,e.px=2*t.w1-e.px),_.ref_count<t.max&&e.py<=t.h0&&(_.ref_count++,e.vy=-e.vy,e.py=2*t.h0-e.py),_.ref_count<t.max&&e.py>=t.h1&&(_.ref_count++,e.vy=-e.vy,e.py=2*t.h1-e.py),e.dir=Math.atan2(e.vy,e.vx)),!i&&_.in_screen&&t.outer_bound&&(_.ref_count<t.max&&e.px>=t.w0&&(_.ref_count++,e.vx=-e.vx,e.px=2*t.w0-e.px),_.ref_count<t.max&&e.px<=t.w1&&(_.ref_count++,e.vx=-e.vx,e.px=2*t.w1-e.px),_.ref_count<t.max&&e.py>=t.h0&&(_.ref_count++,e.vy=-e.vy,e.py=2*t.h0-e.py),_.ref_count<t.max&&e.py<=t.h1&&(_.ref_count++,e.vy=-e.vy,e.py=2*t.h1-e.py),e.dir=Math.atan2(e.vy,e.vx))}))}},a=function(t){return function(e){return e.custom_fields.ref_count=t.max}}},869:(t,e,n)=>{n.d(e,{T:()=>i,ZE:()=>r,yR:()=>o,A4:()=>a,t_:()=>s,T7:()=>u,KZ:()=>c,DV:()=>p,P4:()=>l,k8:()=>h,Gs:()=>E,Io:()=>f,NH:()=>d,bm:()=>M,ZM:()=>_,d9:()=>P,S:()=>y});var _,i=0,r=1,o=2,a=3,s=4,u=5,c=0,p=1,l=1,h=1,E=14,f=0,d=0,M=500;function P(t){return Object.assign({},t)}!function(t){t[t.PRE_ENTRY=0]="PRE_ENTRY",t[t.ALIVE=1]="ALIVE",t[t.LEAVING=2]="LEAVING",t[t.DEAD=3]="DEAD"}(_||(_={}));var y={render_layer:700,collide_group:i,collide_mask:c}},651:(t,e,n)=>{n.d(e,{R0:()=>u,uQ:()=>p});var _,i=n(869),r=n(822),o=n(349),a=n(566),s=(_=function(t,e){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}_(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u={render_layer:i.bm,collide_group:i.A4,collide_mask:i.A4,kill_on_exit:!0,kill_by:function(t){return t==i.t_||t==i.T},auto_direction:!0,life:0,listener:null},c=function(t,e){return!0},p=function(t){function e(e,n){var _=t.call(this,e)||this;return _.state=i.ZM.PRE_ENTRY,_.motion=c,_.custom_fields={},_.config=n,_.time=0,_}return s(e,t),e.prototype.setMotion=function(t){return this.motion=t,this.simpleInit(0,0,0,0)},e.prototype.simpleInit=function(t,e,n,_){return this.px=t,this.py=e,this.vx=n*Math.cos(_),this.vy=n*Math.sin(_),this.dir=_,this.motion(this,0)&&this.config.auto_direction&&(this.dir=Math.atan2(this.vy,this.vx)),this},e.prototype.init=function(t){return t(this),this},e.prototype.update=function(t){var e,n,_,o,a,s,u=this;this.state==i.ZM.PRE_ENTRY&&(this.state=i.ZM.ALIVE,null===(n=null===(e=this.config.listener)||void 0===e?void 0:e.onInit)||void 0===n||n.forEach((function(t){return t(u)})));var c=r.n.INSTANCE.special_effects.time_rate;this.time+=c,null===(o=null===(_=this.config.listener)||void 0===_?void 0:_.onUpdate)||void 0===o||o.forEach((function(t){return t(u,c)})),this.motion(this,c)&&(this.px+=this.vx*c,this.py+=this.vy*c,this.config.auto_direction&&(this.dir=Math.atan2(this.vy,this.vx))),null===(s=null===(a=this.config.listener)||void 0===a?void 0:a.onPostMotion)||void 0===s||s.forEach((function(t){return t(u,c)}))},e.prototype.postUpdate=function(t){var e,n,_,r,a,s,u,c,p=this;(null===(n=null===(e=this.shaped_sprite)||void 0===e?void 0:e.shape)||void 0===n?void 0:n.exitScreen(this,o.SH,o.ZP))&&(this.config.kill_on_exit&&(this.state=i.ZM.LEAVING),null===(r=null===(_=this.config.listener)||void 0===_?void 0:_.onExitScreen)||void 0===r||r.forEach((function(t){return t(p)}))),this.config.life&&this.time>=this.config.life&&(this.state=i.ZM.LEAVING),null===(s=null===(a=this.config.listener)||void 0===a?void 0:a.onPostUpdate)||void 0===s||s.forEach((function(t){return t(p)})),this.state==i.ZM.LEAVING&&(null===(c=null===(u=this.config.listener)||void 0===u?void 0:u.onDestroy)||void 0===c||c.forEach((function(t){return t(p)})),this.state=i.ZM.DEAD)},e.prototype.attack=function(t,e){var n,_,i=this;null===(_=null===(n=this.config.listener)||void 0===n?void 0:n.onAttack)||void 0===_||_.forEach((function(t){return t(i,e)})),e.damaged(e,this)},e.prototype.damaged=function(t,e){var n,_,r=this;return!!this.config.kill_by(e.config.collide_group)&&(this.state=i.ZM.LEAVING,null===(_=null===(n=this.config.listener)||void 0===n?void 0:n.onKill)||void 0===_||_.forEach((function(t){return t(r,e)})),!0)},e}(a.eY)},296:(t,e,n)=>{n.d(e,{cE:()=>p,Fu:()=>l});var _,i,r,o=n(566),a=n(68),s=n(822),u=n(869),c=(_=function(t,e){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}_(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),p=function(t){function e(e){var n=t.call(this)||this;return n.func=e,n}return c(e,t),e.prototype.distanceTo=function(t,e,n){return this.func(t,e,n)},e.line_circle=function(t,e,n){var _=t.px,i=t.py,r=t.px+t.len*Math.cos(t.dir),o=t.py+t.len*Math.sin(t.dir),a=Math.sqrt(Math.pow(_-r,2)+Math.pow(i-o,2)),s=Math.abs((r-_)*(i-n)-(_-e)*(o-i)),u=Math.sqrt(Math.pow(_-e,2)+Math.pow(i-n,2)),c=Math.sqrt(Math.pow(r-e,2)+Math.pow(o-n,2));return Math.pow(Math.max(u,c),2)>Math.pow(Math.min(u,c),2)+Math.pow(a,2)?Math.min(u,c)-t.shaped_sprite.hitbox_width*t.w:Math.min(s/a,u,c)-t.shaped_sprite.hitbox_width*t.w},e.double_arc=function(t,e,n){var _=e-t.px,i=n-t.py,r=_*Math.cos(-t.dir)-i*Math.sin(-t.dir),a=_*Math.sin(-t.dir)+i*Math.cos(-t.dir);return o.HC.orthDis(r-t.len/2,a,t.len/2,t.w*t.shaped_sprite.hitbox_width)},e.half_arc=function(t,e,n){var _=e-t.px,i=n-t.py,r=_*Math.cos(-t.dir)-i*Math.sin(-t.dir),a=_*Math.sin(-t.dir)+i*Math.cos(-t.dir);return r<0?Math.sqrt(Math.pow(r,2)+Math.pow(a,2)):o.HC.orthDis(r,a,t.len,t.w*t.shaped_sprite.hitbox_width)},e}(o.bn);!function(t){t[t.WARNING=0]="WARNING",t[t.OPENING=1]="OPENING",t[t.OPENED=2]="OPENED",t[t.CLOSING=3]="CLOSING"}(i||(i={})),r=o.Yw,c((function(){return null!==r&&r.apply(this,arguments)||this}),r);var l=function(t){function e(e,n,_){var r=t.call(this,e)||this;return r.state=u.ZM.PRE_ENTRY,r.rstate=i.WARNING,r.time=0,r.config=n,r.motion=_,r}return c(e,t),e.prototype.init=function(t,e,n,_){return this.len=_,this.dir=n,this.px=t,this.py=e,this},e.prototype.update=function(t){var e,n,_,r,o,a,c,p,l,h,E,f,d,M,P=this;this.state==u.ZM.PRE_ENTRY&&(this.state=u.ZM.LEAVING,null===(n=null===(e=this.config.listener)||void 0===e?void 0:e.onInit)||void 0===n||n.forEach((function(t){return t(P)})));var y=s.n.INSTANCE.special_effects.time_rate;this.time+=y;var O=this.config.warning_time,D=this.config.open_time+O,v=this.config.alive_time+D,A=this.config.close_time+v;this.rstate==i.WARNING&&this.time>=O&&(this.rstate=i.OPENING,null===(r=null===(_=this.config.listener)||void 0===_?void 0:_.onStateChange)||void 0===r||r.forEach((function(t){return t(P)}))),this.rstate==i.OPENING&&(this.w=Math.min(1,(this.time-O)/(D-O)),this.time>=D&&(this.rstate=i.OPENED,this.state=u.ZM.ALIVE,this.w=1,null===(a=null===(o=this.config.listener)||void 0===o?void 0:o.onStateChange)||void 0===a||a.forEach((function(t){return t(P)})))),this.rstate==i.OPENED&&this.time>=v&&(this.rstate=i.CLOSING,this.state=u.ZM.LEAVING,null===(p=null===(c=this.config.listener)||void 0===c?void 0:c.onStateChange)||void 0===p||p.forEach((function(t){return t(P)}))),this.rstate==i.CLOSING&&(this.w=Math.max(0,1-(this.time-v)/(A-v)),this.time>=A&&(this.state=u.ZM.DEAD,null===(h=null===(l=this.config.listener)||void 0===l?void 0:l.onDestroy)||void 0===h||h.forEach((function(t){return t(P)})))),null===(f=null===(E=this.config.listener)||void 0===E?void 0:E.onUpdate)||void 0===f||f.forEach((function(t){return t(P,y)})),this.motion(this,y),null===(M=null===(d=this.config.listener)||void 0===d?void 0:d.onPostMotion)||void 0===M||M.forEach((function(t){return t(P,y)}))},e.prototype.postUpdate=function(t){var e,n,_=this;null===(n=null===(e=this.config.listener)||void 0===e?void 0:e.onPostUpdate)||void 0===n||n.forEach((function(t){return t(_)}))},e.prototype.attack=function(t,e){var n,_,i=this;null===(_=null===(n=this.config.listener)||void 0===n?void 0:n.onAttack)||void 0===_||_.forEach((function(t){return t(i,e)})),e.damaged(e,this)},e.prototype.damaged=function(t,e){var n,_,i=this;return null===(_=null===(n=this.config.listener)||void 0===n?void 0:n.onContact)||void 0===_||_.forEach((function(t){return t(i,e)})),!1},e}(function(t){function e(e){var n=t.call(this,a.I.RECT,e)||this;return n.w=0,n}return c(e,t),e.prototype.rectCount=function(){return 1},e.prototype.render=function(t,e){var n=this.shaped_sprite.l_ratio*this.len/2;t[10*e+0]=this.px+n*Math.cos(this.dir),t[10*e+1]=this.py+n*Math.sin(this.dir),t[10*e+2]=this.dir+Math.PI/2,t[10*e+3]=Math.max(1,this.shaped_sprite.sprite_width*this.w),t[10*e+4]=n;var _=this.shaped_sprite.sprite;t[10*e+5]=_.tx/_.sprite.w,t[10*e+6]=_.ty/_.sprite.h,t[10*e+7]=_.tw/_.sprite.w,t[10*e+8]=_.th/_.sprite.h,t[10*e+9]=1},e}(o.hE))},533:(t,e,n)=>{n.d(e,{U:()=>u});var _,i=n(566),r=n(349),o=n(869),a=n(822),s=(_=function(t,e){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}_(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u=function(t){function e(n,_,i,r,a){var s=t.call(this,(0,o.d9)(n))||this;return s.config=o.S,s.state=o.ZM.ALIVE,s.miss=!1,s.bomb=!1,s.pre_miss=0,s.miss_time=0,s.invince_time=0,s.time=0,e.INSTANCE=s,s.proto=_,s.ability=i,s.sprite=n,s.px=r,s.py=a,s.dir=0,s}return s(e,t),e.updateState=function(t){e.action=t},e.prototype.update=function(t){e.action&&(this.px+=e.action.pos_x,this.py+=e.action.pos_y,this.px<-r.SH&&(this.px=-r.SH),this.px>r.SH&&(this.px=r.SH),this.py<-r.ZP&&(this.py=-r.ZP),this.py>r.ZP&&(this.py=r.ZP),this.time+=a.n.INSTANCE.special_effects.time_rate,this.dir=this.time*Math.PI*2/600,this.proto.updateShoot(e.action.key_z),this.bomb=this.proto.updateBomb(e.action.key_x),this.proto.updateSpecial(e.action.key_c))},e.prototype.postUpdate=function(t){this.miss_time>0&&this.miss_time--,this.pre_miss>0&&(this.pre_miss--,0==this.pre_miss&&(console.log("missed"),this.miss_time=this.ability.miss_time)),this.miss&&(this.miss=!1,this.pre_miss=this.ability.pre_miss),this.bomb&&(this.bomb=!1,this.miss_time=this.ability.bomb_time,this.pre_miss>0&&(console.log("bomb after miss"),this.pre_miss=0)),this.miss_time>0||this.pre_miss>0?(this.invince_time++,Math.floor(this.invince_time/6)%2==0?this.shaped_sprite.sprite=null:this.shaped_sprite.sprite=this.sprite.sprite):(this.invince_time=0,this.shaped_sprite.sprite=this.sprite.sprite)},e.prototype.attack=function(t,e){},e.prototype.damaged=function(t,e){return 0==this.pre_miss&&0==this.miss_time&&(this.miss=!0),e.damaged(e,this)},e.INSTANCE=null,e.action=null,e}(i.eY)},822:(t,e,n)=>{n.d(e,{n:()=>s});var _,i=n(869),r=n(566),o=n(68),a=function(){this.time_rate=1};!function(t){t[t.PRE_INIT=0]="PRE_INIT",t[t.UPDATE=1]="UPDATE",t[t.POST_UPDATE=2]="POST_UPDATE",t[t.ADD_BACK=3]="ADD_BACK"}(_||(_={}));var s=function(){function t(){this.groups=[],this.pending=[],this.update_stage=_.PRE_INIT,this.time=0,this.special_effects=new a,t.INSTANCE=this,this.groups.push({id:i.T,mask:i.KZ,list:[]}),this.groups.push({id:i.ZE,mask:i.DV,list:[]}),this.groups.push({id:i.yR,mask:i.P4,list:[]}),this.groups.push({id:i.A4,mask:i.k8,list:[]}),this.groups.push({id:i.t_,mask:i.Gs,list:[]}),this.groups.push({id:i.T7,mask:i.Io,list:[]})}return t.prototype.registerGroup=function(t){var e=this.groups.length;return this.groups.push({id:e,mask:t,list:[]}),e},t.prototype.add=function(t){this.update_stage!=_.ADD_BACK&&this.update_stage!=_.PRE_INIT?this.pending.push(t):this.groups[t.config.collide_group].list.push(t)},t.prototype.update=function(){var t=this;this.update_stage=_.UPDATE,this.groups.forEach((function(t){return t.list.forEach((function(t){return t.update(t)}))}));for(var e=0;e<this.groups.length;e++)for(var n=0;n<this.groups.length;n++)if(this.groups[e].mask&1<<n)for(var o=0,a=this.groups[e].list;o<a.length;o++){var s=a[o];if(s.state==i.ZM.ALIVE&&s.shaped_sprite&&s.shaped_sprite.shape)for(var u=0,c=this.groups[n].list;u<c.length;u++){var p=c[u];p.state==i.ZM.ALIVE&&p.shaped_sprite&&p.shaped_sprite.shape&&(0,r._R)(s,p)&&s.attack(s,p)}}this.update_stage=_.POST_UPDATE,this.groups.forEach((function(t){return t.list.forEach((function(t){return t.postUpdate(t)}))})),this.groups.forEach((function(t){return t.list=t.list.filter((function(t){return t.state!=i.ZM.DEAD}))})),this.update_stage=_.ADD_BACK,this.pending.forEach((function(e){return t.add(e)})),this.pending=[],this.time++},t.prototype.render=function(){var t,e,n,_,i,r,a,s;return i=this,r=void 0,s=function(){var i,r,a,s,u,c,p,l,h,E;return function(t,e){var n,_,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,_&&(i=2&r[0]?_.return:r[0]?_.throw||((i=_.return)&&i.call(_),0):_.next)&&!(i=i.call(_,r[1])).done)return i;switch(_=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,_=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=e.call(t,o)}catch(t){r=[6,t],_=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}}(this,(function(f){for(i=new Map,r=0,a=this.groups;r<a.length;r++)for(s=a[r],u=0,c=s.list;u<c.length;u++)(p=c[u]).config.render_layer&&(null===(t=p.shaped_sprite)||void 0===t?void 0:t.sprite)&&(i.has(p.config.render_layer)||i.set(p.config.render_layer,new Map),l=i.get(p.config.render_layer),h=null===(_=null===(n=null===(e=p.shaped_sprite)||void 0===e?void 0:e.sprite)||void 0===n?void 0:n.sprite)||void 0===_?void 0:_.path,l.has(h)||l.set(h,[]),l.get(h).push(p));return E=[],i.forEach((function(t,e){return E.push({rl:e,v:t})})),E.sort((function(t,e){return t.rl-e.rl})),E.forEach((function(t){return t.v.forEach((function(t,e){return o.Z.get(e).draw(t)}))})),[2]}))},new((a=void 0)||(a=Promise))((function(t,e){function n(t){try{o(s.next(t))}catch(t){e(t)}}function _(t){try{o(s.throw(t))}catch(t){e(t)}}function o(e){var i;e.done?t(e.value):(i=e.value,i instanceof a?i:new a((function(t){t(i)}))).then(n,_)}o((s=s.apply(i,r||[])).next())}))},t}()},334:(t,e,n)=>{n.d(e,{FX:()=>p,hP:()=>f,b2:()=>M});var _,i=n(869),r=n(566),o=n(822),a=(_=function(t,e){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}_(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var _=Array(t),i=0;for(e=0;e<n;e++)for(var r=arguments[e],o=0,a=r.length;o<a;o++,i++)_[i]=r[o];return _},u=function(){},c=function(t){function e(e){var n=t.call(this)||this;return n.remain=e,n}return a(e,t),e.prototype.update=function(t){return this.remain-=t,this.remain<0?-this.remain:0},e}(u),p=function(t){function e(e){var n=t.call(this)||this;return n.time=0,n.init=e,n}return a(e,t),e.random=function(t,n){return new e((function(e){var _=Math.max(n.px0-t.px,-n.dx1),i=Math.min(n.px1-t.px,n.dx1),r=Math.max(n.py0-t.py,-n.dy1),o=Math.min(n.py1-t.py,n.dy1),a=_+Math.random()*(i-_),s=r+Math.random()*(o-r);e.target=t,e.duration=n.duration,e.dx=a,e.dy=s,e.x0=t.px,e.y0=t.py,e.ease=n.ease}))},e.prototype.update=function(t){0==this.time&&this.init(this),this.time+=t;var e=Math.min(1,this.time/this.duration),n=this.ease(e);return this.target.px=this.x0+this.dx*n,this.target.py=this.y0+this.dy*n,this.time>this.duration?this.time-this.duration:0},e}(u),l=function(t){function e(e){var n=t.call(this)||this;return n.todo=e,n}return a(e,t),e.prototype.update=function(t){return this.todo(),t},e}(u),h=function(){};function E(t){return t.map((function(t){return"number"==typeof t?new c(t):"function"==typeof t?new l(t):t}))}var f=function(t){function e(e,n){var _=t.call(this)||this;return _.index=0,_.todo=e,_.total=n,_}return a(e,t),e.prototype.supply=function(){return this.index>=this.total?null:(t="function"==typeof this.todo?this.todo(this.index):this.todo,this.index++,E(t));var t},e}(h),d={render_layer:i.NH,collide_group:i.T7,collide_mask:i.Io},M=function(t){function e(e){var n=t.call(this)||this;return n.config=d,n.state=i.ZM.PRE_ENTRY,n.time=0,n.list=E(e),n}return a(e,t),e.prototype.update=function(t){this.state==i.ZM.PRE_ENTRY&&(this.state=i.ZM.ALIVE);var e=o.n.INSTANCE.special_effects.time_rate;for(this.time+=e;this.list.length>0&&e;){var n=this.list[0];if(n instanceof h){var _=n.supply();_&&_.length?this.list=s(_,this.list):this.list.shift()}else(e=n.update(e))>0&&this.list.shift()}0==this.list.length&&(this.state=i.ZM.LEAVING)},e.prototype.postUpdate=function(t){this.state==i.ZM.LEAVING&&(this.state=i.ZM.DEAD)},e.prototype.attack=function(t){},e.prototype.damaged=function(t,e){return!1},e}(r.u5)},176:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{S:()=>init});var _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(651),_entity_SelfMachine__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(533),_stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(334),_util_SpriteManager__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(68),_util_sprites__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(940),_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(583),_stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(822),_entity_Entity__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(869),_entity_RayLaser__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(296),_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(799),__awaiter=function(t,e,n,_){return new(n||(n=Promise))((function(i,r){function o(t){try{s(_.next(t))}catch(t){r(t)}}function a(t){try{s(_.throw(t))}catch(t){r(t)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}s((_=_.apply(t,e||[])).next())}))},__generator=function(t,e){var n,_,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,_&&(i=2&r[0]?_.return:r[0]?_.throw||((i=_.return)&&i.call(_),0):_.next)&&!(i=i.call(_,r[1])).done)return i;switch(_=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,_=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=e.call(t,o)}catch(t){r=[6,t],_=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},sm_proto={updateShoot:function(t){return!1},updateBomb:function(t){return!1},updateSpecial:function(t){return!1}},sm_abi={pre_miss:30,miss_time:60,bomb_time:60},repeat=function(t,e){return void 0===e&&(e=1/0),new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.hP(t,e)},nonblock=function(t){return function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2(t))}},selected_stage=null,stage_000=function(t){var e=_util_sprites__WEBPACK_IMPORTED_MODULE_4__.hZ(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.Dp.Oval,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.C8.Red,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.fz.Overlay),n=_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(e,1);return new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([30*t,repeat((function(e){return[repeat((function(_){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(n,_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0).simpleInit(0,0,8/t,.003/t*e*e+2*Math.PI/5*_))}]}),5),1*t]}),1/0)])},stage_001=function(t){var e=function(t){return _util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.e8(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qb.Scale,t,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.fz.Overlay),1)},n=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0);n.life=180*t,n.kill_on_exit=!1;var _={duration:100*t,px0:-96,px1:96,py0:32,py1:112,dx1:64,dy1:64,ease:function(t){return(1-Math.cos(Math.PI*t))/2}},i=1*t,r=3/t,o=-r/70,a=.06/t,s=new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.cI,2),_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0).setMotion((function(t){return t.dir=t.time*Math.PI*2/600,!1})).simpleInit(0,64,0,0),u=null,c=function(t,e,_,c){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([repeat((function(p){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(u=new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(null,n).simpleInit(s.px,s.py,r,2*Math.PI/47*p*e*t))},repeat((function(e){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(p%2==0?_:c,_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0).setMotion((n=u,i=2*Math.PI/30*e,r=a*t,70,s=o,function(t,e){var _=i+r*t.time,o=70*Math.sin(s*t.time);return t.px=n.px+o*Math.cos(_),t.py=n.py+o*Math.sin(_),t.dir=Math.atan2(o*r,70*s*Math.cos(s*t.time))+_,!1})));var n,i,r,s}]}),30),i]}),47)]))};return new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(s)},30*t,repeat((function(n){return[function(){return c(n%2*2-1,7,e(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Red),e(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Green))},50*t,function(){return c(n%2*2-1,5,e(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Yellow),e(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Blue))},50*t,function(){return c(n%2*2-1,1,e(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Cyan),e(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Pink))},_stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.FX.random(s,_)]}))])},test_000=function(t){var e=[_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.iW(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.u3.Laser,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Red,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.fz.AddBlend),_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.iW(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.u3.Scale,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Red,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.fz.AddBlend),_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.iW(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.u3.Grain,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Red,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.fz.AddBlend)],n={render_layer:_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0.render_layer,collide_group:_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0.collide_group,collide_mask:_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0.collide_mask,warning_time:30*t,open_time:10*t,alive_time:6e3*t,close_time:10*t,listener:null},_=0*Math.PI*2/240/t;return new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([30*t,repeat((function(i){return[repeat((function(t){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _entity_RayLaser__WEBPACK_IMPORTED_MODULE_8__.Fu(e[t%3],n,(r=_*(i%2*2-1),function(t,e){return t.dir+=e*r})).init(50*Math.cos(2*Math.PI/18*t),50*Math.sin(2*Math.PI/18*t),2*Math.PI/18*t,100));var r}]}),18),6e3*t]}))])},stage_002=function(t){var e=_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.p3(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Red,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.fz.Overlay,64),n=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0);n.auto_direction=!1;var _={duration:50*t,px0:-96,px1:96,py0:32,py1:112,dx1:64,dy1:64,ease:function(t){return(1-Math.cos(Math.PI*t))/2}},i=new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.cI,2),_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0).setMotion((function(t){return t.dir=t.time*Math.PI*2/600,!1})).simpleInit(0,64,0,0),r=function(t){return repeat((function(_){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(e,n).setMotion((function(e,n){return e.dir+=n*t,!0})).simpleInit(i.px,i.py,u,c+2*Math.PI/o*_).init((function(t){return t.dir+=2*Math.PI*a/o*_})))}]}),o)},o=50,a=2.5,s=2*Math.PI/60/t,u=6/t,c=0;return new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(i)},30*t,repeat((function(e){return[function(){return c=Math.random()*Math.PI*2},r(s),20*t,r(-s),_stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.FX.random(i,_)]}))])},stage_003=function(t){var e=_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.e8(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qb.Grain,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Red,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.fz.Overlay),1),n=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0);n.listener=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.Fe);var _=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.wv);_.max=100,(0,_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.cf)(_)(n.listener);var i=Math.PI/24,r=6/t,o=100*t,a=1*t,s=1*t,u={duration:o-40*s-20*a,px0:-96,px1:96,py0:32,py1:112,dx1:64,dy1:64,ease:function(t){return(1-Math.cos(Math.PI*t))/2}},c=new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.cI,2),_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0).setMotion((function(t){return t.dir=t.time*Math.PI*2/600,!1})).simpleInit(0,64,0,0),p=0;return new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(c)},30*t,repeat((function(t){return[function(){return p=Math.random()*Math.PI*2},repeat((function(t){return[nonblock([repeat((function(u){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(e,n).setMotion((function(e,n){var a=o-t*s;return e.time-n<a&&e.time>=a&&((0,_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.DP)(_)(e),e.simpleInit(e.px,e.py,r,e.dir+(2*Math.random()-1)*i)),!0})).simpleInit(c.px,c.py,r,p+2*Math.PI/40*t))},a]}),20)]),s]}),40),20*a,_stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.FX.random(c,u)]}))])},stage_004=function(t){var e=[_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.e8(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qb.Grain,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Red,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.fz.Overlay),1),_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.e8(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qb.Grain,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Blue,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.fz.Overlay),1)],n=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0),_=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0);n.listener=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.Fe),_.listener=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.Fe);var i=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.wv),r=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.wv);i.max=2,i.h0=-1/0,r.max=1,r.h0=-1/0,(0,_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.cf)(i)(n.listener),(0,_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.cf)(r)(_.listener);var o=6/t,a=1*t,s=3*t,u={duration:40*t,px0:-96,px1:96,py0:32,py1:112,dx1:64,dy1:64,ease:function(t){return(1-Math.cos(Math.PI*t))/2}},c=new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.cI,2),_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0).setMotion((function(t){return t.dir=t.time*Math.PI*2/600,!1})).simpleInit(0,64,0,0),p=0,l=function(t,e,n,_){return repeat((function(i){return[nonblock([repeat((function(r){return[repeat((function(a){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(t,_).simpleInit(c.px,c.py,o,p+n*Math.PI*2*(i/8/4+a/4+r/4/8/e*.5)))}]}),8),a]}),e)]),s]}),8)};return new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(c)},30*t,repeat((function(t){return[function(){return p=Math.random()*Math.PI*2},l(e[0],10,1,n),10*a,_stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.FX.random(c,u),l(e[1],15,-1,_),20*a,_stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.FX.random(c,u)]}))])};selected_stage=stage_004;var sinit={load_sprite:function(){return _util_SpriteManager__WEBPACK_IMPORTED_MODULE_3__.Z.get(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.Xp.path).load()},add_player:function(){return new _entity_SelfMachine__WEBPACK_IMPORTED_MODULE_1__.U(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.a_,1),sm_proto,sm_abi,0,-192)},add_schedule:selected_stage};function init(){return __awaiter(this,void 0,void 0,(function(){var pool;return __generator(this,(function(_a){switch(_a.label){case 0:return[4,sinit.load_sprite()];case 1:return _a.sent(),pool=new _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n,pool.add(sinit.add_player()),pool.add(sinit.add_schedule(3)),eval("window.debug_info.pool = pool"),[2]}}))}))}},566:(t,e,n)=>{n.d(e,{bn:()=>a,D8:()=>u,HC:()=>c,Yw:()=>p,hE:()=>l,eY:()=>h,u5:()=>E,_R:()=>f});var _,i,r=n(68),o=(_=function(t,e){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}_(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(){},s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(a),u=function(t){function e(e){var n=t.call(this)||this;return n.radius=e,n}return o(e,t),e.prototype.exitScreen=function(t,e,n){var _=Math.sqrt(Math.pow(t.shaped_sprite.w,2)+Math.pow(t.shaped_sprite.h,2));return Math.abs(t.px)>e+_*t.magn||Math.abs(t.py)>n+_*t.magn},e.prototype.distanceTo=function(t,e,n){return Math.sqrt(Math.pow(e-t.px,2)+Math.pow(n-t.py,2))-this.radius*t.magn},e}(s),c=function(t){function e(e,n){var _=t.call(this)||this;return _.len=e,_.rad=n,_}return o(e,t),e.orthDis=function(t,e,n,_){var i=_/2;t=Math.abs(t);var r=n*n/i/2+i/2-i;return(e=Math.abs(e))>=0&&n*(e+r)>t*r?Math.sqrt(Math.pow(t,2)+Math.pow(e+r,2))-r-i:Math.sqrt(Math.pow(t-n,2)+Math.pow(e,2))-i},e.prototype.exitScreen=function(t,e,n){var _=Math.sqrt(Math.pow(t.shaped_sprite.w,2)+Math.pow(t.shaped_sprite.h,2));return Math.abs(t.px)>e+_*t.magn||Math.abs(t.py)>n+_*t.magn},e.prototype.distanceTo=function(t,n,_){var i=n-t.px,r=_-t.py,o=i*Math.cos(-t.dir)-r*Math.sin(-t.dir),a=i*Math.sin(-t.dir)+r*Math.cos(-t.dir);return e.orthDis(o,a,this.len/2*t.magn,this.rad*t.magn)},e}(s),p=function(){},l=(o((function(){return null!==i&&i.apply(this,arguments)||this}),i=p),function(){function t(t,e){this.renderType=t,this.shaped_sprite=e}return t.prototype.distanceTo=function(t,e){var n;return(null===(n=this.shaped_sprite)||void 0===n?void 0:n.shape)?this.shaped_sprite.shape.distanceTo(this,t,e):1/0},t}()),h=function(t){function e(e){var n=t.call(this,r.I.RECT,e)||this;return n.magn=1,n.alpha=1,n}return o(e,t),e.prototype.rectCount=function(){return 1},e.prototype.render=function(t,e){t[10*e+0]=this.px,t[10*e+1]=this.py,t[10*e+2]=this.dir+Math.PI/2,t[10*e+3]=this.shaped_sprite.w/2*this.magn,t[10*e+4]=this.shaped_sprite.h/2*this.magn;var n=this.shaped_sprite.sprite;t[10*e+5]=n.tx/n.sprite.w,t[10*e+6]=n.ty/n.sprite.h,t[10*e+7]=n.tw/n.sprite.w,t[10*e+8]=n.th/n.sprite.h,t[10*e+9]=this.alpha},e}(l),E=function(t){function e(){return t.call(this,null,null)||this}return o(e,t),e}(l);function f(t,e){if(t instanceof h&&t.shaped_sprite.shape instanceof u)return e.distanceTo(t.px,t.py)<t.shaped_sprite.shape.radius;if(e instanceof h&&e.shaped_sprite.shape instanceof u)return f(e,t);throw new Error("non-circle non-circle collision not found")}},68:(t,e,n)=>{n.d(e,{I:()=>_,Z:()=>o});var _,i=n(924),r=n(940);!function(t){t[t.RECT=0]="RECT",t[t.STRIP=1]="STRIP"}(_||(_={}));var o=function(){function t(t){this.img=null,this.path=t}return t.prototype.loaded=function(){return this.img},t.prototype.load=function(){return t=this,e=void 0,_=function(){var t;return function(t,e){var n,_,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,_&&(i=2&r[0]?_.return:r[0]?_.throw||((i=_.return)&&i.call(_),0):_.next)&&!(i=i.call(_,r[1])).done)return i;switch(_=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,_=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=e.call(t,o)}catch(t){r=[6,t],_=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}}(this,(function(e){switch(e.label){case 0:return[4,i.po(this.path)];case 1:return t=e.sent(),this.img=i.yG(t),[2]}}))},new((n=void 0)||(n=Promise))((function(i,r){function o(t){try{s(_.next(t))}catch(t){r(t)}}function a(t){try{s(_.throw(t))}catch(t){r(t)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}s((_=_.apply(t,e||[])).next())}));var t,e,n,_},t.get=function(e){return t.INS[e]?t.INS[e]:t.INS[e]=new t(e)},t.prototype.draw=function(t){this.drawRect(t,r.fz.Overlay),this.drawRect(t,r.fz.AddBlend);for(var e=0,n=t;e<n.length;e++){var o=n[e];if(o.renderType==_.STRIP)for(var a=o,s=a.getSprite(),u=s.sprite,c=0,p=a.render();c<p.length;c++){var l=p[c];i.AJ(l,s.w,l.length/2,u.tx,u.ty,u.tw,u.th,this.img)}}},t.prototype.drawRect=function(t,e){var n=t.reduce((function(t,n){return n.renderType==_.RECT&&n.shaped_sprite.sprite.mode==e?t+n.rectCount():t}),0);if(n){i.PM(e);for(var r=new Float32Array(10*n),o=0,a=0,s=t;a<s.length;a++){var u=s[a];if(u.renderType==_.RECT&&u.shaped_sprite.sprite.mode==e){var c=u;c.render(r,o),o+=c.rectCount()}}i.bn(r,t.length,this.img)}},t.INS={},t}()},583:(t,e,n)=>{n.d(e,{u3:()=>_,xg:()=>c,p3:()=>p,iW:()=>l});var _,i=n(296),r=n(566),o=n(68),a=n(940);!function(t){t[t.Laser=0]="Laser",t[t.Scale=1]="Scale",t[t.Grain=4]="Grain"}(_||(_={}));var s=[[1.4,0],[2.4,2.4,4,4,2.4,2.4,2.4,2.8,2.4,2.4,4,2.4,2.4,2.4,2.4,2.4],[6,7,8.5,7,6,7,0,10],[14,14]],u=.75;function c(t,e){return e*=u,{sprite:t,shape:new r.D8(s[t.category][t.type]*e),w:t.tw*e,h:t.th*e,renderType:o.I.RECT}}function p(t,e,n){var _=(0,a.e8)(a.qb.Grain,t,e);return{sprite:_,shape:new r.HC(n,s[a.WD.Small][a.qb.Grain]*u),renderType:o.I.RECT,w:_.tw*u,h:1.25*n}}function l(t,e,n){var r=(0,a.e8)(t,e,n);return r.ty+=t==_.Laser?4:t==_.Grain||t==_.Scale?1:NaN,r.th-=t==_.Laser?8:t==_.Grain?2:t==_.Scale?1:NaN,{sprite:r,shape:new i.cE(t==_.Laser?i.cE.line_circle:t==_.Scale?i.cE.half_arc:t==_.Grain?i.cE.double_arc:null),renderType:o.I.RECT,sprite_width:r.tw*u/2,hitbox_width:2.4*u,l_ratio:t==_.Laser||t==_.Grain?1:t==_.Scale?1.2:NaN}}},940:(t,e,n)=>{var _,i,r,o,a,s,u,c;n.d(e,{fz:()=>_,WD:()=>i,qO:()=>r,qb:()=>o,C8:()=>a,Dp:()=>s,Xp:()=>p,e8:()=>l,hZ:()=>h,a_:()=>E,cI:()=>f}),function(t){t[t.Overlay=0]="Overlay",t[t.AddBlend=1]="AddBlend"}(_||(_={})),function(t){t[t.Special=0]="Special",t[t.Small=1]="Small",t[t.Medium=2]="Medium",t[t.Large=3]="Large"}(i||(i={})),function(t){t[t.Grey=0]="Grey",t[t.RedX=1]="RedX",t[t.Red=2]="Red",t[t.PinkX=3]="PinkX",t[t.Pink=4]="Pink",t[t.BlueX=5]="BlueX",t[t.Blue=6]="Blue",t[t.CyanX=7]="CyanX",t[t.Cyan=8]="Cyan",t[t.GreenX=9]="GreenX",t[t.Green=10]="Green",t[t.Lemon=11]="Lemon",t[t.YellowX=12]="YellowX",t[t.Yellow=13]="Yellow",t[t.Orange=14]="Orange",t[t.White=15]="White"}(r||(r={})),function(t){t[t.Laser=0]="Laser",t[t.Scale=1]="Scale",t[t.Ring=2]="Ring",t[t.Ball=3]="Ball",t[t.Grain=4]="Grain",t[t.Niddle=5]="Niddle",t[t.Knife=6]="Knife",t[t.Spell=7]="Spell",t[t.Bullet=8]="Bullet",t[t.Germ=9]="Germ",t[t.Star=10]="Star",t[t.Planet=11]="Planet",t[t.S_Cross=12]="S_Cross",t[t.S_Ball=13]="S_Ball",t[t.Curve=14]="Curve",t[t.Drop=15]="Drop"}(o||(o={})),function(t){t[t.Grey=0]="Grey",t[t.Red=1]="Red",t[t.Pink=2]="Pink",t[t.Blue=3]="Blue",t[t.Cyan=4]="Cyan",t[t.Green=5]="Green",t[t.Yellow=6]="Yellow",t[t.White=7]="White"}(a||(a={})),function(t){t[t.Light=0]="Light",t[t.Star=1]="Star",t[t.Ball=2]="Ball",t[t.Butterfly=3]="Butterfly",t[t.Knife=4]="Knife",t[t.Oval=5]="Oval",t[t.LightX=6]="LightX",t[t.Heart=7]="Heart"}(s||(s={})),function(t){t[t.Red=0]="Red",t[t.Blue=1]="Blue",t[t.Green=2]="Green",t[t.Yellow=3]="Yellow"}(u||(u={})),function(t){t[t.Ball=0]="Ball",t[t.Rose=1]="Rose"}(c||(c={}));var p={path:"assets/bullet_000.png",w:516,h:772};function l(t,e,n){return{sprite:p,tx:t<12?1+16*e:t<14?1+e%8*8:t<15?1:258+16*e,ty:t<12?1+16*t:t<14?(t<13?193:241)+8*(e>>3):e<15?515+16*e:449,tw:t<12?16:t<14?8:t<15?256:16,th:t<12?16:t<14?8:16,mode:n,category:i.Small,type:t,color:e}}function h(t,e,n){return{sprite:p,tx:(t<7?1:258)+32*e,ty:0==t?209:t<7?226+32*t:257,tw:32,th:32,mode:n,category:i.Medium,type:t,color:e}}var E={sprite:p,tx:258,ty:17,tw:64,th:64,mode:_.Overlay,category:i.Special,type:0,color:0},f=(_.Overlay,i.Special,{sprite:p,tx:386,ty:81,tw:128,th:128,mode:_.Overlay,category:i.Special,type:2,color:0})},924:(t,e,n)=>{n.d(e,{cY:()=>o,PM:()=>a,po:()=>s,yG:()=>c,ZH:()=>p,bn:()=>M,AJ:()=>P});var _=n(349),i=n(940);const r={gl:null,shader:{program:0,attribute:{coord:0,tex:0,alpha:0},uniform:{uSampler:0}}};function o(){var t=document.getElementById("glcanvas"),e=t.getContext("webgl");if(null===e)return void alert("Unable to initialize WebGL. Your browser or machine may not support it.");r.gl=e;var n=e.createShader(e.VERTEX_SHADER),_=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(n,"\nattribute vec2 coord;\nattribute vec2 tex;\nattribute float alpha;\nvarying highp vec2 vTexCoord;\nvarying highp float vTexAlpha;\nvoid main() {\n    gl_Position = vec4(coord, 0.0, 1.0);\n    vTexCoord = tex;\n    vTexAlpha = alpha;\n}\n"),e.shaderSource(_,"\nprecision highp float;\nvarying highp vec2 vTexCoord;\nvarying highp float vTexAlpha;\nuniform sampler2D uSampler;\nvoid main() {\n    vec4 col = texture2D(uSampler, vTexCoord);\n    col.a *= vTexAlpha;\n    col.rgb *= col.a;\n    gl_FragColor = col;\n}\n"),e.compileShader(n),e.compileShader(_),!e.getShaderParameter(_,e.COMPILE_STATUS)){var i=e.getShaderInfoLog(_);return void console.log(i)}var o=e.createProgram();e.attachShader(o,n),e.attachShader(o,_),e.linkProgram(o),e.useProgram(o);const a=r.shader;a.program=o,a.attribute.coord=e.getAttribLocation(o,"coord"),a.attribute.tex=e.getAttribLocation(o,"tex"),a.attribute.alpha=e.getAttribLocation(o,"alpha"),a.uniform.uSampler=e.getUniformLocation(o,"uSampler"),e.enable(e.BLEND),e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA),e.disable(e.DEPTH_TEST),e.viewport(0,0,t.width,t.height)}function a(t){const e=r.gl;t==i.fz.Overlay?e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA):t==i.fz.AddBlend&&e.blendFuncSeparate(e.ONE,e.ONE,e.ONE,e.ONE_MINUS_SRC_ALPHA)}function s(t){return new Promise(((e,n)=>{let _=new Image;_.onload=()=>e(_),_.onerror=n,_.src=t}))}function u(t,e,n,_,i){const o=r.gl,a=o.createBuffer(),s=r.shader.attribute.coord;o.bindBuffer(o.ARRAY_BUFFER,a),o.bufferData(o.ARRAY_BUFFER,t,o.STATIC_DRAW),o.vertexAttribPointer(s,2,o.FLOAT,!1,0,0),o.enableVertexAttribArray(s);const u=o.createBuffer(),c=r.shader.attribute.tex;o.bindBuffer(o.ARRAY_BUFFER,u),o.bufferData(o.ARRAY_BUFFER,e,o.STATIC_DRAW),o.vertexAttribPointer(c,2,o.FLOAT,!1,0,0),o.enableVertexAttribArray(c);const p=o.createBuffer(),l=r.shader.attribute.alpha;o.bindBuffer(o.ARRAY_BUFFER,p),o.bufferData(o.ARRAY_BUFFER,n,o.STATIC_DRAW),o.vertexAttribPointer(l,1,o.FLOAT,!1,0,0),o.enableVertexAttribArray(l),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,_),o.uniform1i(r.shader.uniform.uSampler,0),o.drawArrays(o.TRIANGLES,0,i)}function c(t){const e=r.gl,n=e.createTexture();return e.bindTexture(e.TEXTURE_2D,n),e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_SHORT_4_4_4_4,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),n}function p(){const t=r.gl;t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT),t.clearColor(0,0,1,1)}const l=[-1,-1,1,-1,1,1],h=[-1,1,1,-1,-1,1],E=[0,0,1,0,1,1],f=[0,1,1,0,0,1];function d(t){for(var e=0;e<t.length/2;e++)t[2*e]=(0,_.OK)(t[2*e]),t[2*e+1]=(0,_.ZA)(t[2*e+1])}function M(t,e,n){const _=new Float32Array(12*e),i=new Float32Array(12*e),r=new Float32Array(6*e);Math.PI;for(var o=0;o<e;o++)for(var a=0;a<6;a++){const e=t[10*o+2],n=t[10*o+3]*l[a],s=t[10*o+4]*h[a];_[12*o+2*a+0]=t[10*o+0]+n*Math.cos(e)-s*Math.sin(e),_[12*o+2*a+1]=t[10*o+1]+n*Math.sin(e)+s*Math.cos(e),i[12*o+2*a+0]=t[10*o+5]+E[a]*t[10*o+7],i[12*o+2*a+1]=t[10*o+6]+f[a]*t[10*o+8],r[6*o+a]=t[10*o+9]}d(_),u(_,i,r,n,6*e)}function P(t,e,n,_,i,o,a,s){const u=new Float32Array(6*n),c=new Float32Array(n),p=new Float32Array(6*n),l=new Int16Array(2*(n-1));for(var h=0,E=0;E<n-1;E++){const n=t[2*E],_=t[2*E+1],i=t[2*E+2],r=t[2*E+3],o=(n+i)/2,a=(_+r)/2,s=Math.sqrt((i-n)*(i-n)+(r-_)*(r-_));c[E]=s,h+=s,u[6*E+0]=n,u[6*E+1]=_,u[6*E+2]=o-(a-_)/s*e,u[6*E+3]=a+(o-n)/s*e,u[6*E+4]=o+(a-_)/s*e,u[6*E+5]=a-(o-n)/s*e}d(u),h-=c[0]/2+c[n-1]/2;var f=-c[0]/2;for(E=1;E<n;E++)p[6*E+0]=_+o*f/h,p[6*E+1]=i+a/2,f+=c[E]/2,p[6*E+2]=_+o*f/h,p[6*E+3]=i,p[6*E+4]=_+o*f/h,p[6*E+5]=i+a,f+=c[E]/2;for(E=0;E<n-1;E++)l[2*E+0]=3*E+1,l[2*E+1]=3*E+3;l[2*n-3]--;const M=r.gl,P=M.createBuffer(),y=r.shader.attribute.coord;M.bindBuffer(M.ARRAY_BUFFER,P),M.bufferData(M.ARRAY_BUFFER,u,M.STATIC_DRAW),M.vertexAttribPointer(y,2,M.FLOAT,!1,0,0),M.enableVertexAttribArray(y);const O=M.createBuffer(),D=r.shader.attribute.tex;M.bindBuffer(M.ARRAY_BUFFER,O),M.bufferData(M.ARRAY_BUFFER,p,M.STATIC_DRAW),M.vertexAttribPointer(D,2,M.FLOAT,!1,0,0),M.enableVertexAttribArray(D),M.activeTexture(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,s),M.uniform1i(r.shader.uniform.uSampler,0);const v=M.createBuffer();for(M.bindBuffer(M.ELEMENT_ARRAY_BUFFER,v),M.bufferData(M.ELEMENT_ARRAY_BUFFER,l,M.STATIC_DRAW),M.drawElements(M.TRIANGLE_STRIP,2*n-2,M.UNSIGNED_SHORT,0),E=0;E<n-1;E++)l[2*E+0]=3*E,l[2*E+1]=3*E+2;l[0]++,M.bufferData(M.ELEMENT_ARRAY_BUFFER,l,M.STATIC_DRAW),M.drawElements(M.TRIANGLE_STRIP,2*n-2,M.UNSIGNED_SHORT,0)}window.debug_info={},window.debug_info.global_gl=r,window.debug_info.gl_func={setup:o,clear:p,draw:u,drawStrip:function(t,e,n,_,i){const o=r.gl,a=o.createBuffer(),s=r.shader.attribute.coord;o.bindBuffer(o.ARRAY_BUFFER,a),o.bufferData(o.ARRAY_BUFFER,t,o.STATIC_DRAW),o.vertexAttribPointer(s,2,o.FLOAT,!1,0,0),o.enableVertexAttribArray(s);const u=o.createBuffer(),c=r.shader.attribute.tex;o.bindBuffer(o.ARRAY_BUFFER,u),o.bufferData(o.ARRAY_BUFFER,e,o.STATIC_DRAW),o.vertexAttribPointer(c,2,o.FLOAT,!1,0,0),o.enableVertexAttribArray(c);const p=o.createBuffer();o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,p),o.bufferData(o.ELEMENT_ARRAY_BUFFER,n,o.STATIC_DRAW),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,_),o.uniform1i(r.shader.uniform.uSampler,0),o.drawElements(o.TRIANGLE_STRIP,i,o.UNSIGNED_SHORT,0)},drawRects:M,drawSnake:P}}},__webpack_module_cache__={};function __webpack_require__(t){if(__webpack_module_cache__[t])return __webpack_module_cache__[t].exports;var e=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](e,e.exports,__webpack_require__),e.exports}__webpack_require__.d=(t,e)=>{for(var n in e)__webpack_require__.o(e,n)&&!__webpack_require__.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t={};__webpack_require__.r(t),__webpack_require__.d(t,{KEY_CLICK:()=>w,KEY_PRESS:()=>g,canvas_height:()=>h,canvas_width:()=>l,devicePixelRatio:()=>M,keys:()=>v,last_update_rate:()=>P,mainloop_start:()=>T,mainloop_terminate:()=>m,mouse:()=>D,setup_canvas:()=>A,test_fps:()=>y});var e=__webpack_require__(176),n=__webpack_require__(924),_=__webpack_require__(822),i=__webpack_require__(533),r=__webpack_require__(349),o=!1,a=!1,s=0,u=0,c=0,p=0;var l,h,E=0,f=0,d=null,M=1,P=1;function y(){return E=performance.now(),f=241,O(),new Promise(((t,e)=>{d=t}))}function O(){if(--f)requestAnimationFrame(O);else{var t=(performance.now()-E)/240;P=Math.round(t/(1e3/60)),d(P)}}var D={x:0,y:0},v={};function A(){document.onmousemove=t=>{D.x=t.pageX,D.y=t.pageY},document.ontouchstart=t=>{v._touch=3,D.x=t.pageX,D.y=t.pageY,t.preventDefault()},document.ontouchend=t=>{v._touch=1,D.x=t.pageX,D.y=t.pageY,t.preventDefault()},document.ontouchmove=t=>{D.x=t.pageX,D.y=t.pageY,t.preventDefault()},document.onmousedown=t=>{v._press=3},document.onmouseup=t=>{v._press=1},document.addEventListener("keydown",(t=>{var e=t.key;1==e.length&&(e=e.toLowerCase()),v[e]=3}),!1),document.addEventListener("keyup",(t=>{var e=t.key;1==e.length&&(e=e.toLowerCase()),v[e]=1}),!1);var t=window.innerWidth,e=window.innerHeight,_=.95*Math.min(t/r.Fy,e/r.bE),i=document.getElementById("glcanvas");l=_*r.Fy,h=_*r.bE,i.style.width=l+"px",i.style.height=h+"px",M=window.devicePixelRatio||1,i.width=l*M,i.height=h*M,n.cY()}var R=!1;function T(){R||(R=!0,I())}function m(){R=!1}function I(){!function(){var t=_.n.INSTANCE;if(t){var e=function(){if(v.Escape==w&&(o=!o),o)return a=!1,null;var t=0,e=0;v.Shift>=g||v._touch>=g||v._press>=g?(a||(a=!0,s=D.x,u=D.y,c=0,p=0),t=D.x-s-c,e=D.y-u-p,c+=t,p+=e):a=!1,t=t/l*r.Fy*2,e=-e/h*r.bE*2;var n=v.Shift>=g?2:3;return(v.w>=g||v.ArrowUp>=g)&&(e+=n),(v.s>=g||v.ArrowDown>=g)&&(e-=n),(v.a>=g||v.ArrowLeft>=g)&&(t-=n),(v.d>=g||v.ArrowRight>=g)&&(t+=n),{pos_x:t,pos_y:e,key_z:v.z>=g,key_x:v.x==w,key_c:v.c==w}}();if(!o&&(i.U.updateState(e),!o))for(var E=0;E<P;E++)t.update();n.ZH(),t.render()}}(),function(){for(var t in v)3==v[t]&&(v[t]=2),1==v[t]&&(v[t]=0)}(),R&&requestAnimationFrame(I)}const g=2,w=3;window.onload=async function(){y(),A(),await e.S(),T(),window.debug_info.stg={fps:y,init:e.S,start:T,terminate:m},window.debug_info.platform=t}})()})();