(()=>{"use strict";var __webpack_modules__={349:(t,e,n)=>{n.d(e,{SH:()=>i,ZP:()=>r,Fy:()=>o,bE:()=>_,OK:()=>a,ZA:()=>s});var i=192,r=224,o=192,_=224;function a(t){return t/o}function s(t){return t/_}},869:(t,e,n)=>{n.d(e,{T:()=>r,ZE:()=>o,yR:()=>_,A4:()=>a,t_:()=>s,T7:()=>u,KZ:()=>c,DV:()=>l,P4:()=>p,k8:()=>h,Gs:()=>f,Io:()=>d,NH:()=>E,bm:()=>y,ZM:()=>i,d9:()=>v,S:()=>A});var i,r=0,o=1,_=2,a=3,s=4,u=5,c=0,l=1,p=1,h=1,f=14,d=0,E=0,y=500;function v(t){return Object.assign({},t)}!function(t){t[t.PRE_ENTRY=0]="PRE_ENTRY",t[t.ALIVE=1]="ALIVE",t[t.LEAVING=2]="LEAVING",t[t.DEAD=3]="DEAD"}(i||(i={}));var A={render_layer:700,collide_group:r,collide_mask:c}},651:(t,e,n)=>{n.d(e,{R0:()=>u,uQ:()=>l});var i,r=n(869),o=n(822),_=n(349),a=n(566),s=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u={render_layer:r.bm,collide_group:r.A4,collide_mask:r.A4,kill_on_exit:!0,kill_by:function(t){return t==r.t_||t==r.T},auto_direction:!0,life:0,listener:null},c=function(t,e){return!0},l=function(t){function e(e,n){var i=t.call(this,e)||this;return i.state=r.ZM.PRE_ENTRY,i.motion=c,i.custom_fields={},i.config=n,i.time=0,i}return s(e,t),e.prototype.setMotion=function(t){return this.motion=t,this.simpleInit(0,0,0,0)},e.prototype.simpleInit=function(t,e,n,i){return this.px=t,this.py=e,this.vx=n*Math.cos(i),this.vy=n*Math.sin(i),this.dir=i,this.motion(this,0)&&this.config.auto_direction&&(this.dir=Math.atan2(this.vy,this.vx)),this},e.prototype.update=function(t){var e,n,i,_,a,s,u=this;this.state==r.ZM.PRE_ENTRY&&(this.state=r.ZM.ALIVE,null===(n=null===(e=this.config.listener)||void 0===e?void 0:e.onInit)||void 0===n||n.forEach((function(t){return t(u)})));var c=o.n.INSTANCE.special_effects.time_rate;this.time+=c,null===(_=null===(i=this.config.listener)||void 0===i?void 0:i.onUpdate)||void 0===_||_.forEach((function(t){return t(u,c)})),this.motion(this,c)&&(this.px+=this.vx*c,this.py+=this.vy*c,this.config.auto_direction&&(this.dir=Math.atan2(this.vy,this.vx))),null===(s=null===(a=this.config.listener)||void 0===a?void 0:a.onPostMotion)||void 0===s||s.forEach((function(t){return t(u,c)}))},e.prototype.postUpdate=function(t){var e,n,i,o,a,s,u,c,l=this;(null===(n=null===(e=this.shaped_sprite)||void 0===e?void 0:e.shape)||void 0===n?void 0:n.exitScreen(this.px,this.py,this.dir,_.SH,_.ZP))&&(this.config.kill_on_exit&&(this.state=r.ZM.LEAVING),null===(o=null===(i=this.config.listener)||void 0===i?void 0:i.onExitScreen)||void 0===o||o.forEach((function(t){return t(l)}))),this.config.life&&this.time>=this.config.life&&(this.state=r.ZM.LEAVING),null===(s=null===(a=this.config.listener)||void 0===a?void 0:a.onPostUpdate)||void 0===s||s.forEach((function(t){return t(l)})),this.state==r.ZM.LEAVING&&(null===(c=null===(u=this.config.listener)||void 0===u?void 0:u.onDestroy)||void 0===c||c.forEach((function(t){return t(l)})),this.state=r.ZM.DEAD)},e.prototype.attack=function(t,e){var n,i,r=this;null===(i=null===(n=this.config.listener)||void 0===n?void 0:n.onAttack)||void 0===i||i.forEach((function(t){return t(r,e)})),e.damaged(e,this)},e.prototype.damaged=function(t,e){var n,i,o=this;return!!this.config.kill_by(e.config.collide_group)&&(this.state=r.ZM.LEAVING,null===(i=null===(n=this.config.listener)||void 0===n?void 0:n.onKill)||void 0===i||i.forEach((function(t){return t(o,e)})),!0)},e}(a.eY)},296:(t,e,n)=>{n.d(e,{cE:()=>l,Fu:()=>p});var i,r,o,_=n(566),a=n(68),s=n(822),u=n(869),c=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(t){function e(e){var n=t.call(this)||this;return n.func=e,n}return c(e,t),e.prototype.distanceTo=function(t,e,n){return this.func(t,e,n)},e.line_circle=function(t,e,n){var i=t.px,r=t.py,o=t.px+t.len*Math.cos(t.dir),_=t.py+t.len*Math.sin(t.dir),a=Math.sqrt(Math.pow(i-o,2)+Math.pow(r-_,2)),s=Math.abs((o-i)*(r-n)-(i-e)*(_-r)),u=Math.sqrt(Math.pow(i-e,2)+Math.pow(r-n,2)),c=Math.sqrt(Math.pow(o-e,2)+Math.pow(_-n,2));return Math.pow(Math.max(u,c),2)>Math.pow(Math.min(u,c),2)+Math.pow(a,2)?Math.min(u,c)-t.shaped_sprite.hitbox_width*t.w:Math.min(s/a,u,c)-t.shaped_sprite.hitbox_width*t.w},e}(_.bn);!function(t){t[t.WARNING=0]="WARNING",t[t.OPENING=1]="OPENING",t[t.OPENED=2]="OPENED",t[t.CLOSING=3]="CLOSING"}(r||(r={})),o=_.Yw,c((function(){return null!==o&&o.apply(this,arguments)||this}),o);var p=function(t){function e(e,n,i){var o=t.call(this,e)||this;return o.state=u.ZM.PRE_ENTRY,o.rstate=r.WARNING,o.time=0,o.config=n,o.motion=i,o}return c(e,t),e.prototype.init=function(t,e,n,i){return this.len=i,this.dir=n,this.px=t,this.py=e,this},e.prototype.update=function(t){var e,n,i,o,_,a,c,l,p,h,f,d,E,y,v=this;this.state==u.ZM.PRE_ENTRY&&(this.state=u.ZM.LEAVING,null===(n=null===(e=this.config.listener)||void 0===e?void 0:e.onInit)||void 0===n||n.forEach((function(t){return t(v)})));var A=s.n.INSTANCE.special_effects.time_rate;this.time+=A;var m=this.config.warning_time,P=this.config.open_time+m,M=this.config.alive_time+P,g=this.config.close_time+M;this.rstate==r.WARNING&&this.time>=m&&(this.rstate=r.OPENING,null===(o=null===(i=this.config.listener)||void 0===i?void 0:i.onStateChange)||void 0===o||o.forEach((function(t){return t(v)}))),this.rstate==r.OPENING&&(this.w=Math.min(1,(this.time-m)/(P-m)),this.time>=P&&(this.rstate=r.OPENED,this.state=u.ZM.ALIVE,this.w=1,null===(a=null===(_=this.config.listener)||void 0===_?void 0:_.onStateChange)||void 0===a||a.forEach((function(t){return t(v)})))),this.rstate==r.OPENED&&this.time>=M&&(this.rstate=r.CLOSING,this.state=u.ZM.LEAVING,null===(l=null===(c=this.config.listener)||void 0===c?void 0:c.onStateChange)||void 0===l||l.forEach((function(t){return t(v)}))),this.rstate==r.CLOSING&&(this.w=Math.max(0,1-(this.time-M)/(g-M)),this.time>=g&&(this.state=u.ZM.DEAD,null===(h=null===(p=this.config.listener)||void 0===p?void 0:p.onDestroy)||void 0===h||h.forEach((function(t){return t(v)})))),null===(d=null===(f=this.config.listener)||void 0===f?void 0:f.onUpdate)||void 0===d||d.forEach((function(t){return t(v,A)})),this.motion(this,A),null===(y=null===(E=this.config.listener)||void 0===E?void 0:E.onPostMotion)||void 0===y||y.forEach((function(t){return t(v,A)}))},e.prototype.postUpdate=function(t){var e,n,i=this;null===(n=null===(e=this.config.listener)||void 0===e?void 0:e.onPostUpdate)||void 0===n||n.forEach((function(t){return t(i)}))},e.prototype.attack=function(t,e){var n,i,r=this;null===(i=null===(n=this.config.listener)||void 0===n?void 0:n.onAttack)||void 0===i||i.forEach((function(t){return t(r,e)})),e.damaged(e,this)},e.prototype.damaged=function(t,e){var n,i,r=this;return null===(i=null===(n=this.config.listener)||void 0===n?void 0:n.onContact)||void 0===i||i.forEach((function(t){return t(r,e)})),!1},e}(function(t){function e(e){var n=t.call(this,a.I.RECT,e)||this;return n.w=0,n}return c(e,t),e.prototype.rectCount=function(){return 1},e.prototype.render=function(t,e){t[10*e+0]=this.px+this.len/2*Math.cos(this.dir),t[10*e+1]=this.py+this.len/2*Math.sin(this.dir),t[10*e+2]=this.dir+Math.PI/2,t[10*e+3]=Math.max(1,this.shaped_sprite.sprite_width*this.w),t[10*e+4]=this.shaped_sprite.l_ratio/2*this.len;var n=this.shaped_sprite.sprite;t[10*e+5]=n.tx/n.sprite.w,t[10*e+6]=n.ty/n.sprite.h,t[10*e+7]=n.tw/n.sprite.w,t[10*e+8]=n.th/n.sprite.h,t[10*e+9]=1},e}(_.hE))},533:(t,e,n)=>{n.d(e,{U:()=>u});var i,r=n(566),o=n(349),_=n(869),a=n(822),s=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u=function(t){function e(n,i,r,o,a){var s=t.call(this,(0,_.d9)(n))||this;return s.config=_.S,s.state=_.ZM.ALIVE,s.miss=!1,s.bomb=!1,s.pre_miss=0,s.miss_time=0,s.invince_time=0,s.time=0,e.INSTANCE=s,s.proto=i,s.ability=r,s.sprite=n,s.px=o,s.py=a,s.dir=0,s}return s(e,t),e.updateState=function(t){e.action=t},e.prototype.update=function(t){e.action&&(this.px+=e.action.pos_x,this.py+=e.action.pos_y,this.px<-o.SH&&(this.px=-o.SH),this.px>o.SH&&(this.px=o.SH),this.py<-o.ZP&&(this.py=-o.ZP),this.py>o.ZP&&(this.py=o.ZP),this.time+=a.n.INSTANCE.special_effects.time_rate,this.dir=this.time*Math.PI*2/600,this.proto.updateShoot(e.action.key_z),this.bomb=this.proto.updateBomb(e.action.key_x),this.proto.updateSpecial(e.action.key_c))},e.prototype.postUpdate=function(t){this.miss_time>0&&this.miss_time--,this.pre_miss>0&&(this.pre_miss--,0==this.pre_miss&&(console.log("missed"),this.miss_time=this.ability.miss_time)),this.miss&&(this.miss=!1,this.pre_miss=this.ability.pre_miss),this.bomb&&(this.bomb=!1,this.miss_time=this.ability.bomb_time,this.pre_miss>0&&(console.log("bomb after miss"),this.pre_miss=0)),this.miss_time>0||this.pre_miss>0?(this.invince_time++,Math.floor(this.invince_time/6)%2==0?this.shaped_sprite.sprite=null:this.shaped_sprite.sprite=this.sprite.sprite):(this.invince_time=0,this.shaped_sprite.sprite=this.sprite.sprite)},e.prototype.attack=function(t,e){},e.prototype.damaged=function(t,e){return 0==this.pre_miss&&0==this.miss_time&&(this.miss=!0),e.damaged(e,this)},e.INSTANCE=null,e.action=null,e}(r.eY)},822:(t,e,n)=>{n.d(e,{n:()=>s});var i,r=n(869),o=n(566),_=n(68),a=function(){this.time_rate=1};!function(t){t[t.PRE_INIT=0]="PRE_INIT",t[t.UPDATE=1]="UPDATE",t[t.POST_UPDATE=2]="POST_UPDATE",t[t.ADD_BACK=3]="ADD_BACK"}(i||(i={}));var s=function(){function t(){this.groups=[],this.pending=[],this.update_stage=i.PRE_INIT,this.time=0,this.special_effects=new a,t.INSTANCE=this,this.groups.push({id:r.T,mask:r.KZ,list:[]}),this.groups.push({id:r.ZE,mask:r.DV,list:[]}),this.groups.push({id:r.yR,mask:r.P4,list:[]}),this.groups.push({id:r.A4,mask:r.k8,list:[]}),this.groups.push({id:r.t_,mask:r.Gs,list:[]}),this.groups.push({id:r.T7,mask:r.Io,list:[]})}return t.prototype.registerGroup=function(t){var e=this.groups.length;return this.groups.push({id:e,mask:t,list:[]}),e},t.prototype.add=function(t){this.update_stage!=i.ADD_BACK&&this.update_stage!=i.PRE_INIT?this.pending.push(t):this.groups[t.config.collide_group].list.push(t)},t.prototype.update=function(){var t=this;this.update_stage=i.UPDATE,this.groups.forEach((function(t){return t.list.forEach((function(t){return t.update(t)}))}));for(var e=0;e<this.groups.length;e++)for(var n=0;n<this.groups.length;n++)if(this.groups[e].mask&1<<n)for(var _=0,a=this.groups[e].list;_<a.length;_++){var s=a[_];if(s.state==r.ZM.ALIVE&&s.shaped_sprite&&s.shaped_sprite.shape)for(var u=0,c=this.groups[n].list;u<c.length;u++){var l=c[u];l.state==r.ZM.ALIVE&&l.shaped_sprite&&l.shaped_sprite.shape&&(0,o._R)(s,l)&&s.attack(s,l)}}this.update_stage=i.POST_UPDATE,this.groups.forEach((function(t){return t.list.forEach((function(t){return t.postUpdate(t)}))})),this.groups.forEach((function(t){return t.list=t.list.filter((function(t){return t.state!=r.ZM.DEAD}))})),this.update_stage=i.ADD_BACK,this.pending.forEach((function(e){return t.add(e)})),this.pending=[],this.time++},t.prototype.render=function(){var t,e,n,i,r,o,a,s;return r=this,o=void 0,s=function(){var r,o,a,s,u,c,l,p,h,f;return function(t,e){var n,i,r,o,_={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;_;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return _.label++,{value:o[1],done:!1};case 5:_.label++,i=o[1],o=[0];continue;case 7:o=_.ops.pop(),_.trys.pop();continue;default:if(!((r=(r=_.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){_=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){_.label=o[1];break}if(6===o[0]&&_.label<r[1]){_.label=r[1],r=o;break}if(r&&_.label<r[2]){_.label=r[2],_.ops.push(o);break}r[2]&&_.ops.pop(),_.trys.pop();continue}o=e.call(t,_)}catch(t){o=[6,t],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}(this,(function(d){for(r=new Map,o=0,a=this.groups;o<a.length;o++)for(s=a[o],u=0,c=s.list;u<c.length;u++)(l=c[u]).config.render_layer&&(null===(t=l.shaped_sprite)||void 0===t?void 0:t.sprite)&&(r.has(l.config.render_layer)||r.set(l.config.render_layer,new Map),p=r.get(l.config.render_layer),h=null===(i=null===(n=null===(e=l.shaped_sprite)||void 0===e?void 0:e.sprite)||void 0===n?void 0:n.sprite)||void 0===i?void 0:i.path,p.has(h)||p.set(h,[]),p.get(h).push(l));return f=[],r.forEach((function(t,e){return f.push({rl:e,v:t})})),f.sort((function(t,e){return t.rl-e.rl})),f.forEach((function(t){return t.v.forEach((function(t,e){return _.Z.get(e).draw(t)}))})),[2]}))},new((a=void 0)||(a=Promise))((function(t,e){function n(t){try{_(s.next(t))}catch(t){e(t)}}function i(t){try{_(s.throw(t))}catch(t){e(t)}}function _(e){var r;e.done?t(e.value):(r=e.value,r instanceof a?r:new a((function(t){t(r)}))).then(n,i)}_((s=s.apply(r,o||[])).next())}))},t}()},334:(t,e,n)=>{n.d(e,{FX:()=>l,hP:()=>d,b2:()=>y});var i,r=n(869),o=n(566),_=n(822),a=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var o=arguments[e],_=0,a=o.length;_<a;_++,r++)i[r]=o[_];return i},u=function(){},c=function(t){function e(e){var n=t.call(this)||this;return n.remain=e,n}return a(e,t),e.prototype.update=function(t){return this.remain-=t,this.remain<0?-this.remain:0},e}(u),l=function(t){function e(e,n,i,r,o){var _=t.call(this)||this;return _.time=0,_.target=e,_.duration=n,_.dx=i,_.dy=r,_.x0=e.px,_.y0=e.py,_.ease=o,_}return a(e,t),e.random=function(t,n){var i=Math.max(n.px0-t.px,-n.dx1),r=Math.min(n.px1-t.px,n.dx1),o=Math.max(n.py0-t.py,-n.dy1),_=Math.min(n.py1-t.py,n.dy1),a=i+Math.random()*(r-i),s=o+Math.random()*(_-o);return new e(t,n.duration,a,s,n.ease)},e.prototype.update=function(t){this.time+=t;var e=Math.min(1,this.time/this.duration),n=this.ease(e);return this.target.px=this.x0+this.dx*n,this.target.py=this.y0+this.dy*n,this.time>this.duration?this.time-this.duration:0},e}(u),p=function(t){function e(e){var n=t.call(this)||this;return n.todo=e,n}return a(e,t),e.prototype.update=function(t){return this.todo(),t},e}(u),h=function(){};function f(t){return t.map((function(t){return"number"==typeof t?new c(t):"function"==typeof t?new p(t):t}))}var d=function(t){function e(e,n){var i=t.call(this)||this;return i.index=0,i.todo=e,i.total=n,i}return a(e,t),e.prototype.supply=function(){return this.index>=this.total?null:(t="function"==typeof this.todo?this.todo(this.index):this.todo,this.index++,f(t));var t},e}(h),E={render_layer:r.NH,collide_group:r.T7,collide_mask:r.Io},y=function(t){function e(e){var n=t.call(this)||this;return n.config=E,n.state=r.ZM.PRE_ENTRY,n.time=0,n.list=f(e),n}return a(e,t),e.prototype.update=function(t){this.state==r.ZM.PRE_ENTRY&&(this.state=r.ZM.ALIVE);var e=_.n.INSTANCE.special_effects.time_rate;for(this.time+=e;this.list.length>0&&e;){var n=this.list[0];if(n instanceof h){var i=n.supply();i&&i.length?this.list=s(i,this.list):this.list.shift()}else(e=n.update(e))>0&&this.list.shift()}0==this.list.length&&(this.state=r.ZM.LEAVING)},e.prototype.postUpdate=function(t){this.state==r.ZM.LEAVING&&(this.state=r.ZM.DEAD)},e.prototype.attack=function(t){},e.prototype.damaged=function(t,e){return!1},e}(o.u5)},176:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{S:()=>init});var _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(651),_entity_SelfMachine__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(533),_stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(334),_util_SpriteManager__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(68),_util_sprites__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(940),_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(583),_stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(822),_entity_Entity__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(869),_entity_RayLaser__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(296),__awaiter=function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function _(t){try{s(i.next(t))}catch(t){o(t)}}function a(t){try{s(i.throw(t))}catch(t){o(t)}}function s(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(_,a)}s((i=i.apply(t,e||[])).next())}))},__generator=function(t,e){var n,i,r,o,_={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;_;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return _.label++,{value:o[1],done:!1};case 5:_.label++,i=o[1],o=[0];continue;case 7:o=_.ops.pop(),_.trys.pop();continue;default:if(!((r=(r=_.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){_=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){_.label=o[1];break}if(6===o[0]&&_.label<r[1]){_.label=r[1],r=o;break}if(r&&_.label<r[2]){_.label=r[2],_.ops.push(o);break}r[2]&&_.ops.pop(),_.trys.pop();continue}o=e.call(t,_)}catch(t){o=[6,t],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},sm_proto={updateShoot:function(t){return!1},updateBomb:function(t){return!1},updateSpecial:function(t){return!1}},sm_abi={pre_miss:30,miss_time:60,bomb_time:60},repeat=function(t,e){return void 0===e&&(e=1/0),new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.hP(t,e)},stage_000=function(t){var e=_util_sprites__WEBPACK_IMPORTED_MODULE_4__.hZ(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.Dp.Oval,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.C8.Red,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.fz.Overlay),n=_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.x(e,1);return new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([30*t,repeat((function(e){return[repeat((function(i){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(n,_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0).simpleInit(0,0,8/t,.003/t*e*e+2*Math.PI/5*i))}]}),5),1*t]}),1/0)])},stage_001=function(t){var e=function(t){return _util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.x(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.e8(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qb.Scale,t,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.fz.Overlay),1)},n=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0);n.life=180*t,n.kill_on_exit=!1;var i={duration:100*t,px0:-96,px1:96,py0:32,py1:112,dx1:64,dy1:64,ease:function(t){return(1-Math.cos(Math.PI*t))/2}},r=1*t,o=3/t,_=-o/70,a=.06/t,s=new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.x(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.cI,2),_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0).setMotion((function(t){return t.dir=t.time*Math.PI*2/600,!1})).simpleInit(0,64,0,0),u=null,c=function(t,e,i,c){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([repeat((function(l){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(u=new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(null,n).simpleInit(s.px,s.py,o,2*Math.PI/47*l*e*t))},repeat((function(e){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(l%2==0?i:c,_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0).setMotion((n=u,r=2*Math.PI/30*e,o=a*t,70,s=_,function(t,e){var i=r+o*t.time,_=70*Math.sin(s*t.time);return t.px=n.px+_*Math.cos(i),t.py=n.py+_*Math.sin(i),t.dir=Math.atan2(_*o,70*s*Math.cos(s*t.time))+i,!1})));var n,r,o,s}]}),30),r]}),47)]))};return new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(s)},30*t,repeat((function(n){return[function(){return c(n%2*2-1,7,e(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Red),e(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Green))},50*t,function(){return c(n%2*2-1,5,e(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Yellow),e(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Blue))},50*t,function(){return c(n%2*2-1,1,e(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Cyan),e(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Pink))},_stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.FX.random(s,i)]}))])},stage_002=function(t){var e=_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.i(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.e8(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qb.Laser,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Red,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.fz.AddBlend)),n={render_layer:_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0.render_layer,collide_group:_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0.collide_group,collide_mask:_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0.collide_mask,warning_time:30*t,open_time:10*t,alive_time:60*t,close_time:10*t,listener:null},i=2*Math.PI/120/t;return new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([30*t,repeat((function(r){return[repeat((function(t){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _entity_RayLaser__WEBPACK_IMPORTED_MODULE_8__.Fu(e,n,(o=i*(r%2*2-1),function(t,e){return t.dir+=e*o})).init(0,0,2*Math.PI/17*t,200));var o}]}),17),120*t]}))])},sinit={load_sprite:function(){return _util_SpriteManager__WEBPACK_IMPORTED_MODULE_3__.Z.get(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.Xp.path).load()},add_player:function(){return new _entity_SelfMachine__WEBPACK_IMPORTED_MODULE_1__.U(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.x(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.a_,1),sm_proto,sm_abi,0,-192)},add_schedule:stage_002};function init(){return __awaiter(this,void 0,void 0,(function(){var pool;return __generator(this,(function(_a){switch(_a.label){case 0:return[4,sinit.load_sprite()];case 1:return _a.sent(),pool=new _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n,pool.add(sinit.add_player()),pool.add(sinit.add_schedule(3)),eval("window.debug_info.pool = pool"),[2]}}))}))}},566:(t,e,n)=>{n.d(e,{bn:()=>a,D8:()=>s,Yw:()=>u,hE:()=>c,eY:()=>l,u5:()=>p,_R:()=>h});var i,r,o=n(68),_=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(){},s=function(t){function e(e){var n=t.call(this)||this;return n.radius=e,n}return _(e,t),e.prototype.exitScreen=function(t,e,n,i,r){return Math.abs(t)>i+this.radius||Math.abs(e)>r+this.radius},e.prototype.distanceTo=function(t,e,n){return e-=t.px,n-=t.py,Math.sqrt(e*e+n*n)-this.radius*t.magn},e}(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e}(a)),u=function(){},c=(_((function(){return null!==r&&r.apply(this,arguments)||this}),r=u),function(){function t(t,e){this.renderType=t,this.shaped_sprite=e}return t.prototype.distanceTo=function(t,e){return this.shaped_sprite.shape.distanceTo(this,t,e)},t}()),l=function(t){function e(e){var n=t.call(this,o.I.RECT,e)||this;return n.magn=1,n.alpha=1,n}return _(e,t),e.prototype.rectCount=function(){return 1},e.prototype.render=function(t,e){t[10*e+0]=this.px,t[10*e+1]=this.py,t[10*e+2]=this.dir+Math.PI/2,t[10*e+3]=this.shaped_sprite.w/2*this.magn,t[10*e+4]=this.shaped_sprite.h/2*this.magn;var n=this.shaped_sprite.sprite;t[10*e+5]=n.tx/n.sprite.w,t[10*e+6]=n.ty/n.sprite.h,t[10*e+7]=n.tw/n.sprite.w,t[10*e+8]=n.th/n.sprite.h,t[10*e+9]=this.alpha},e}(c),p=function(t){function e(){return t.call(this,null,null)||this}return _(e,t),e}(c);function h(t,e){if(t instanceof l&&t.shaped_sprite.shape instanceof s)return e.distanceTo(t.px,t.py)<t.shaped_sprite.shape.radius;if(e instanceof l&&e.shaped_sprite.shape instanceof s)return h(e,t);throw new Error("non-circle non-circle collision not found")}},68:(t,e,n)=>{n.d(e,{I:()=>i,Z:()=>_});var i,r=n(924),o=n(940);!function(t){t[t.RECT=0]="RECT",t[t.STRIP=1]="STRIP"}(i||(i={}));var _=function(){function t(t){this.img=null,this.path=t}return t.prototype.loaded=function(){return this.img},t.prototype.load=function(){return t=this,e=void 0,i=function(){var t;return function(t,e){var n,i,r,o,_={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;_;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return _.label++,{value:o[1],done:!1};case 5:_.label++,i=o[1],o=[0];continue;case 7:o=_.ops.pop(),_.trys.pop();continue;default:if(!((r=(r=_.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){_=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){_.label=o[1];break}if(6===o[0]&&_.label<r[1]){_.label=r[1],r=o;break}if(r&&_.label<r[2]){_.label=r[2],_.ops.push(o);break}r[2]&&_.ops.pop(),_.trys.pop();continue}o=e.call(t,_)}catch(t){o=[6,t],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}(this,(function(e){switch(e.label){case 0:return[4,r.po(this.path)];case 1:return t=e.sent(),this.img=r.yG(t),[2]}}))},new((n=void 0)||(n=Promise))((function(r,o){function _(t){try{s(i.next(t))}catch(t){o(t)}}function a(t){try{s(i.throw(t))}catch(t){o(t)}}function s(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(_,a)}s((i=i.apply(t,e||[])).next())}));var t,e,n,i},t.get=function(e){return t.INS[e]?t.INS[e]:t.INS[e]=new t(e)},t.prototype.draw=function(t){this.drawRect(t,o.fz.Overlay),this.drawRect(t,o.fz.AddBlend);for(var e=0,n=t;e<n.length;e++){var _=n[e];if(_.renderType==i.STRIP)for(var a=_,s=a.getSprite(),u=s.sprite,c=0,l=a.render();c<l.length;c++){var p=l[c];r.AJ(p,s.w,p.length/2,u.tx,u.ty,u.tw,u.th,this.img)}}},t.prototype.drawRect=function(t,e){var n=t.reduce((function(t,n){return n.renderType==i.RECT&&n.shaped_sprite.sprite.mode==e?t+n.rectCount():t}),0);if(n){r.PM(e);for(var o=new Float32Array(10*n),_=0,a=0,s=t;a<s.length;a++){var u=s[a];if(u.renderType==i.RECT&&u.shaped_sprite.sprite.mode==e){var c=u;c.render(o,_),_+=c.rectCount()}}r.bn(o,t.length,this.img)}},t.INS={},t}()},583:(t,e,n)=>{n.d(e,{x:()=>s,i:()=>u});var i=n(296),r=n(566),o=n(68),_=[[1.4,0],[2.4,2.4,4,4,2.4,2.4,2.4,2.8,2.4,2.4,4,2.4,2.4,2.4,2.4,2.4],[6,7,8.5,7,6,7,0,10],[14,14]],a=.75;function s(t,e){return e*=a,{sprite:t,shape:new r.D8(_[t.category][t.type]*e),w:t.tw*e,h:t.th*e,renderType:o.I.RECT}}function u(t){return{sprite:t,shape:new i.cE(i.cE.line_circle),renderType:o.I.RECT,sprite_width:t.tw*a/2,hitbox_width:_[t.category][t.type]*a/2,l_ratio:1}}},940:(t,e,n)=>{var i,r,o,_,a,s,u,c;n.d(e,{fz:()=>i,qO:()=>o,qb:()=>_,C8:()=>a,Dp:()=>s,Xp:()=>l,e8:()=>p,hZ:()=>h,a_:()=>f,cI:()=>d}),function(t){t[t.Overlay=0]="Overlay",t[t.AddBlend=1]="AddBlend"}(i||(i={})),function(t){t[t.Special=0]="Special",t[t.Small=1]="Small",t[t.Medium=2]="Medium",t[t.Large=3]="Large"}(r||(r={})),function(t){t[t.Grey=0]="Grey",t[t.RedX=1]="RedX",t[t.Red=2]="Red",t[t.PinkX=3]="PinkX",t[t.Pink=4]="Pink",t[t.BlueX=5]="BlueX",t[t.Blue=6]="Blue",t[t.CyanX=7]="CyanX",t[t.Cyan=8]="Cyan",t[t.GreenX=9]="GreenX",t[t.Green=10]="Green",t[t.Lemon=11]="Lemon",t[t.YellowX=12]="YellowX",t[t.Yellow=13]="Yellow",t[t.Orange=14]="Orange",t[t.White=15]="White"}(o||(o={})),function(t){t[t.Laser=0]="Laser",t[t.Scale=1]="Scale",t[t.Ring=2]="Ring",t[t.Ball=3]="Ball",t[t.Grain=4]="Grain",t[t.Niddle=5]="Niddle",t[t.Knife=6]="Knife",t[t.Spell=7]="Spell",t[t.Bullet=8]="Bullet",t[t.Germ=9]="Germ",t[t.Star=10]="Star",t[t.Planet=11]="Planet",t[t.S_Cross=12]="S_Cross",t[t.S_Ball=13]="S_Ball",t[t.Curve=14]="Curve",t[t.Drop=15]="Drop"}(_||(_={})),function(t){t[t.Grey=0]="Grey",t[t.Red=1]="Red",t[t.Pink=2]="Pink",t[t.Blue=3]="Blue",t[t.Cyan=4]="Cyan",t[t.Green=5]="Green",t[t.Yellow=6]="Yellow",t[t.White=7]="White"}(a||(a={})),function(t){t[t.Light=0]="Light",t[t.Star=1]="Star",t[t.Ball=2]="Ball",t[t.Butterfly=3]="Butterfly",t[t.Knife=4]="Knife",t[t.Oval=5]="Oval",t[t.LightX=6]="LightX",t[t.Heart=7]="Heart"}(s||(s={})),function(t){t[t.Red=0]="Red",t[t.Blue=1]="Blue",t[t.Green=2]="Green",t[t.Yellow=3]="Yellow"}(u||(u={})),function(t){t[t.Ball=0]="Ball",t[t.Rose=1]="Rose"}(c||(c={}));var l={path:"assets/bullet_000.png",w:516,h:772};function p(t,e,n){return{sprite:l,tx:t<12?1+16*e:t<14?1+e%8*8:t<15?1:258+16*e,ty:0==t?4:t<12?1+16*t:t<14?(t<13?193:241)+8*(e>>3):e<15?515+16*e:449,tw:t<12?16:t<14?8:t<15?256:16,th:0==t?8:t<12?16:t<14?8:16,mode:n,category:r.Small,type:t,color:e}}function h(t,e,n){return{sprite:l,tx:(t<7?1:258)+32*e,ty:0==t?209:t<7?226+32*t:257,tw:32,th:32,mode:n,category:r.Medium,type:t,color:e}}var f={sprite:l,tx:258,ty:17,tw:64,th:64,mode:i.Overlay,category:r.Special,type:0,color:0},d=(i.Overlay,r.Special,{sprite:l,tx:386,ty:81,tw:128,th:128,mode:i.Overlay,category:r.Special,type:2,color:0})},924:(t,e,n)=>{n.d(e,{cY:()=>_,PM:()=>a,po:()=>s,yG:()=>c,ZH:()=>l,bn:()=>y,AJ:()=>v});var i=n(349),r=n(940);const o={gl:null,shader:{program:0,attribute:{coord:0,tex:0,alpha:0},uniform:{uSampler:0}}};function _(){var t=document.getElementById("glcanvas"),e=t.getContext("webgl");if(null===e)return void alert("Unable to initialize WebGL. Your browser or machine may not support it.");o.gl=e;var n=e.createShader(e.VERTEX_SHADER),i=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(n,"\nattribute vec2 coord;\nattribute vec2 tex;\nattribute float alpha;\nvarying highp vec2 vTexCoord;\nvarying highp float vTexAlpha;\nvoid main() {\n    gl_Position = vec4(coord, 0.0, 1.0);\n    vTexCoord = tex;\n    vTexAlpha = alpha;\n}\n"),e.shaderSource(i,"\nprecision highp float;\nvarying highp vec2 vTexCoord;\nvarying highp float vTexAlpha;\nuniform sampler2D uSampler;\nvoid main() {\n    vec4 col = texture2D(uSampler, vTexCoord);\n    col.a *= vTexAlpha;\n    col.rgb *= col.a;\n    gl_FragColor = col;\n}\n"),e.compileShader(n),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS)){var r=e.getShaderInfoLog(i);return void console.log(r)}var _=e.createProgram();e.attachShader(_,n),e.attachShader(_,i),e.linkProgram(_),e.useProgram(_);const a=o.shader;a.program=_,a.attribute.coord=e.getAttribLocation(_,"coord"),a.attribute.tex=e.getAttribLocation(_,"tex"),a.attribute.alpha=e.getAttribLocation(_,"alpha"),a.uniform.uSampler=e.getUniformLocation(_,"uSampler"),e.enable(e.BLEND),e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA),e.disable(e.DEPTH_TEST),e.viewport(0,0,t.width,t.height)}function a(t){const e=o.gl;t==r.fz.Overlay?e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA):t==r.fz.AddBlend&&e.blendFuncSeparate(e.ONE,e.ONE,e.ONE,e.ONE_MINUS_SRC_ALPHA)}function s(t){return new Promise(((e,n)=>{let i=new Image;i.onload=()=>e(i),i.onerror=n,i.src=t}))}function u(t,e,n,i,r){const _=o.gl,a=_.createBuffer(),s=o.shader.attribute.coord;_.bindBuffer(_.ARRAY_BUFFER,a),_.bufferData(_.ARRAY_BUFFER,t,_.STATIC_DRAW),_.vertexAttribPointer(s,2,_.FLOAT,!1,0,0),_.enableVertexAttribArray(s);const u=_.createBuffer(),c=o.shader.attribute.tex;_.bindBuffer(_.ARRAY_BUFFER,u),_.bufferData(_.ARRAY_BUFFER,e,_.STATIC_DRAW),_.vertexAttribPointer(c,2,_.FLOAT,!1,0,0),_.enableVertexAttribArray(c);const l=_.createBuffer(),p=o.shader.attribute.alpha;_.bindBuffer(_.ARRAY_BUFFER,l),_.bufferData(_.ARRAY_BUFFER,n,_.STATIC_DRAW),_.vertexAttribPointer(p,1,_.FLOAT,!1,0,0),_.enableVertexAttribArray(p),_.activeTexture(_.TEXTURE0),_.bindTexture(_.TEXTURE_2D,i),_.uniform1i(o.shader.uniform.uSampler,0),_.drawArrays(_.TRIANGLES,0,r)}function c(t){const e=o.gl,n=e.createTexture();return e.bindTexture(e.TEXTURE_2D,n),e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_SHORT_4_4_4_4,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),n}function l(){const t=o.gl;t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT),t.clearColor(0,0,1,1)}const p=[-1,-1,1,-1,1,1],h=[-1,1,1,-1,-1,1],f=[0,0,1,0,1,1],d=[0,1,1,0,0,1];function E(t){for(var e=0;e<t.length/2;e++)t[2*e]=(0,i.OK)(t[2*e]),t[2*e+1]=(0,i.ZA)(t[2*e+1])}function y(t,e,n){const i=new Float32Array(12*e),r=new Float32Array(12*e),o=new Float32Array(6*e);Math.PI;for(var _=0;_<e;_++)for(var a=0;a<6;a++){const e=t[10*_+2],n=t[10*_+3]*p[a],s=t[10*_+4]*h[a];i[12*_+2*a+0]=t[10*_+0]+n*Math.cos(e)-s*Math.sin(e),i[12*_+2*a+1]=t[10*_+1]+n*Math.sin(e)+s*Math.cos(e),r[12*_+2*a+0]=t[10*_+5]+f[a]*t[10*_+7],r[12*_+2*a+1]=t[10*_+6]+d[a]*t[10*_+8],o[6*_+a]=t[10*_+9]}E(i),u(i,r,o,n,6*e)}function v(t,e,n,i,r,_,a,s){const u=new Float32Array(6*n),c=new Float32Array(n),l=new Float32Array(6*n),p=new Int16Array(2*(n-1));for(var h=0,f=0;f<n-1;f++){const n=t[2*f],i=t[2*f+1],r=t[2*f+2],o=t[2*f+3],_=(n+r)/2,a=(i+o)/2,s=Math.sqrt((r-n)*(r-n)+(o-i)*(o-i));c[f]=s,h+=s,u[6*f+0]=n,u[6*f+1]=i,u[6*f+2]=_-(a-i)/s*e,u[6*f+3]=a+(_-n)/s*e,u[6*f+4]=_+(a-i)/s*e,u[6*f+5]=a-(_-n)/s*e}E(u),h-=c[0]/2+c[n-1]/2;var d=-c[0]/2;for(f=1;f<n;f++)l[6*f+0]=i+_*d/h,l[6*f+1]=r+a/2,d+=c[f]/2,l[6*f+2]=i+_*d/h,l[6*f+3]=r,l[6*f+4]=i+_*d/h,l[6*f+5]=r+a,d+=c[f]/2;for(f=0;f<n-1;f++)p[2*f+0]=3*f+1,p[2*f+1]=3*f+3;p[2*n-3]--;const y=o.gl,v=y.createBuffer(),A=o.shader.attribute.coord;y.bindBuffer(y.ARRAY_BUFFER,v),y.bufferData(y.ARRAY_BUFFER,u,y.STATIC_DRAW),y.vertexAttribPointer(A,2,y.FLOAT,!1,0,0),y.enableVertexAttribArray(A);const m=y.createBuffer(),P=o.shader.attribute.tex;y.bindBuffer(y.ARRAY_BUFFER,m),y.bufferData(y.ARRAY_BUFFER,l,y.STATIC_DRAW),y.vertexAttribPointer(P,2,y.FLOAT,!1,0,0),y.enableVertexAttribArray(P),y.activeTexture(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,s),y.uniform1i(o.shader.uniform.uSampler,0);const M=y.createBuffer();for(y.bindBuffer(y.ELEMENT_ARRAY_BUFFER,M),y.bufferData(y.ELEMENT_ARRAY_BUFFER,p,y.STATIC_DRAW),y.drawElements(y.TRIANGLE_STRIP,2*n-2,y.UNSIGNED_SHORT,0),f=0;f<n-1;f++)p[2*f+0]=3*f,p[2*f+1]=3*f+2;p[0]++,y.bufferData(y.ELEMENT_ARRAY_BUFFER,p,y.STATIC_DRAW),y.drawElements(y.TRIANGLE_STRIP,2*n-2,y.UNSIGNED_SHORT,0)}window.debug_info={},window.debug_info.global_gl=o,window.debug_info.gl_func={setup:_,clear:l,draw:u,drawStrip:function(t,e,n,i,r){const _=o.gl,a=_.createBuffer(),s=o.shader.attribute.coord;_.bindBuffer(_.ARRAY_BUFFER,a),_.bufferData(_.ARRAY_BUFFER,t,_.STATIC_DRAW),_.vertexAttribPointer(s,2,_.FLOAT,!1,0,0),_.enableVertexAttribArray(s);const u=_.createBuffer(),c=o.shader.attribute.tex;_.bindBuffer(_.ARRAY_BUFFER,u),_.bufferData(_.ARRAY_BUFFER,e,_.STATIC_DRAW),_.vertexAttribPointer(c,2,_.FLOAT,!1,0,0),_.enableVertexAttribArray(c);const l=_.createBuffer();_.bindBuffer(_.ELEMENT_ARRAY_BUFFER,l),_.bufferData(_.ELEMENT_ARRAY_BUFFER,n,_.STATIC_DRAW),_.activeTexture(_.TEXTURE0),_.bindTexture(_.TEXTURE_2D,i),_.uniform1i(o.shader.uniform.uSampler,0),_.drawElements(_.TRIANGLE_STRIP,r,_.UNSIGNED_SHORT,0)},drawRects:y,drawSnake:v}}},__webpack_module_cache__={};function __webpack_require__(t){if(__webpack_module_cache__[t])return __webpack_module_cache__[t].exports;var e=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](e,e.exports,__webpack_require__),e.exports}__webpack_require__.d=(t,e)=>{for(var n in e)__webpack_require__.o(e,n)&&!__webpack_require__.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t={};__webpack_require__.r(t),__webpack_require__.d(t,{KEY_CLICK:()=>D,KEY_PRESS:()=>w,canvas_height:()=>h,canvas_width:()=>p,devicePixelRatio:()=>y,keys:()=>M,last_update_rate:()=>v,mainloop_start:()=>T,mainloop_terminate:()=>b,mouse:()=>P,setup_canvas:()=>g,test_fps:()=>A});var e=__webpack_require__(176),n=__webpack_require__(924),i=__webpack_require__(822),r=__webpack_require__(533),o=__webpack_require__(349),_=!1,a=!1,s=0,u=0,c=0,l=0;var p,h,f=0,d=0,E=null,y=1,v=1;function A(){return f=performance.now(),d=241,m(),new Promise(((t,e)=>{E=t}))}function m(){if(--d)requestAnimationFrame(m);else{var t=(performance.now()-f)/240;v=Math.round(t/(1e3/60)),E(v)}}var P={x:0,y:0},M={};function g(){document.onmousemove=t=>{P.x=t.pageX,P.y=t.pageY},document.ontouchstart=t=>{M._touch=3,P.x=t.pageX,P.y=t.pageY,t.preventDefault()},document.ontouchend=t=>{M._touch=1,P.x=t.pageX,P.y=t.pageY,t.preventDefault()},document.ontouchmove=t=>{P.x=t.pageX,P.y=t.pageY,t.preventDefault()},document.onmousedown=t=>{M._press=3},document.onmouseup=t=>{M._press=1},document.addEventListener("keydown",(t=>{var e=t.key;1==e.length&&(e=e.toLowerCase()),M[e]=3}),!1),document.addEventListener("keyup",(t=>{var e=t.key;1==e.length&&(e=e.toLowerCase()),M[e]=1}),!1);var t=window.innerWidth,e=window.innerHeight,i=.95*Math.min(t/o.Fy,e/o.bE),r=document.getElementById("glcanvas");p=i*o.Fy,h=i*o.bE,r.style.width=p+"px",r.style.height=h+"px",y=window.devicePixelRatio||1,r.width=p*y,r.height=h*y,n.cY()}var R=!1;function T(){R||(R=!0,O())}function b(){R=!1}function O(){!function(){var t=i.n.INSTANCE;if(t){var e=function(){if(M.Escape==D&&(_=!_),_)return a=!1,null;var t=0,e=0;M.Shift>=w||M._touch>=w||M._press>=w?(a||(a=!0,s=P.x,u=P.y,c=0,l=0),t=P.x-s-c,e=P.y-u-l,c+=t,l+=e):a=!1,t=t/p*o.Fy*2,e=-e/h*o.bE*2;var n=M.Shift>=w?2:3;return(M.w>=w||M.ArrowUp>=w)&&(e+=n),(M.s>=w||M.ArrowDown>=w)&&(e-=n),(M.a>=w||M.ArrowLeft>=w)&&(t-=n),(M.d>=w||M.ArrowRight>=w)&&(t+=n),{pos_x:t,pos_y:e,key_z:M.z>=w,key_x:M.x==D,key_c:M.c==D}}();if(!_&&(r.U.updateState(e),!_))for(var f=0;f<v;f++)t.update();n.ZH(),t.render()}}(),function(){for(var t in M)3==M[t]&&(M[t]=2),1==M[t]&&(M[t]=0)}(),R&&requestAnimationFrame(O)}const w=2,D=3;window.onload=async function(){A(),g(),await e.S(),T(),window.debug_info.stg={fps:A,init:e.S,start:T,terminate:b},window.debug_info.platform=t}})()})();