(()=>{"use strict";var __webpack_modules__={349:(t,e,r)=>{r.d(e,{SH:()=>i,ZP:()=>n,Fy:()=>o,bE:()=>a,OK:()=>_,ZA:()=>s});var i=192,n=224,o=192,a=224;function _(t){return t/o}function s(t){return t/a}},869:(t,e,r)=>{r.d(e,{T:()=>n,ZE:()=>o,yR:()=>a,A4:()=>_,t_:()=>s,T7:()=>u,KZ:()=>c,DV:()=>l,P4:()=>p,k8:()=>h,Gs:()=>f,Io:()=>d,NH:()=>E,bm:()=>y,ZM:()=>i,d9:()=>v,S:()=>M});var i,n=0,o=1,a=2,_=3,s=4,u=5,c=0,l=1,p=1,h=1,f=14,d=0,E=0,y=500;function v(t){return Object.assign({},t)}!function(t){t[t.PRE_ENTRY=0]="PRE_ENTRY",t[t.ALIVE=1]="ALIVE",t[t.LEAVING=2]="LEAVING",t[t.DEAD=3]="DEAD"}(i||(i={}));var M={render_layer:700,collide_group:n,collide_mask:c}},651:(t,e,r)=>{r.d(e,{R0:()=>u,uQ:()=>l});var i,n=r(869),o=r(822),a=r(349),_=r(566),s=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),u={render_layer:n.bm,collide_group:n.A4,collide_mask:n.A4,kill_on_exit:!0,kill_by:function(t){return t==n.t_||t==n.T},auto_direction:!0,life:0,listener:null},c=function(t,e){return!0},l=function(t){function e(e,r){var i=t.call(this,e)||this;return i.state=n.ZM.PRE_ENTRY,i.motion=c,i.custom_fields={},i.config=r,i.time=0,i}return s(e,t),e.prototype.setMotion=function(t){return this.motion=t,this.simpleInit(0,0,0,0)},e.prototype.simpleInit=function(t,e,r,i){return this.px=t,this.py=e,this.vx=r*Math.cos(i),this.vy=r*Math.sin(i),this.dir=i,this.motion(this,0)&&this.config.auto_direction&&(this.dir=Math.atan2(this.vy,this.vx)),this},e.prototype.update=function(t){var e,r,i,a,_,s,u=this;this.state==n.ZM.PRE_ENTRY&&(this.state=n.ZM.ALIVE,null===(r=null===(e=this.config.listener)||void 0===e?void 0:e.onInit)||void 0===r||r.forEach((function(t){return t(u)})));var c=o.n.INSTANCE.special_effects.time_rate;this.time+=c,null===(a=null===(i=this.config.listener)||void 0===i?void 0:i.onUpdate)||void 0===a||a.forEach((function(t){return t(u,c)})),this.motion(this,c)&&(this.px+=this.vx*c,this.py+=this.vy*c,this.config.auto_direction&&(this.dir=Math.atan2(this.vy,this.vx))),null===(s=null===(_=this.config.listener)||void 0===_?void 0:_.onPostMotion)||void 0===s||s.forEach((function(t){return t(u,c)}))},e.prototype.postUpdate=function(t){var e,r,i,o,_,s,u,c,l=this;(null===(r=null===(e=this.shaped_sprite)||void 0===e?void 0:e.shape)||void 0===r?void 0:r.exitScreen(this,a.SH,a.ZP))&&(this.config.kill_on_exit&&(this.state=n.ZM.LEAVING),null===(o=null===(i=this.config.listener)||void 0===i?void 0:i.onExitScreen)||void 0===o||o.forEach((function(t){return t(l)}))),this.config.life&&this.time>=this.config.life&&(this.state=n.ZM.LEAVING),null===(s=null===(_=this.config.listener)||void 0===_?void 0:_.onPostUpdate)||void 0===s||s.forEach((function(t){return t(l)})),this.state==n.ZM.LEAVING&&(null===(c=null===(u=this.config.listener)||void 0===u?void 0:u.onDestroy)||void 0===c||c.forEach((function(t){return t(l)})),this.state=n.ZM.DEAD)},e.prototype.attack=function(t,e){var r,i,n=this;null===(i=null===(r=this.config.listener)||void 0===r?void 0:r.onAttack)||void 0===i||i.forEach((function(t){return t(n,e)})),e.damaged(e,this)},e.prototype.damaged=function(t,e){var r,i,o=this;return!!this.config.kill_by(e.config.collide_group)&&(this.state=n.ZM.LEAVING,null===(i=null===(r=this.config.listener)||void 0===r?void 0:r.onKill)||void 0===i||i.forEach((function(t){return t(o,e)})),!0)},e}(_.eY)},296:(t,e,r)=>{r.d(e,{cE:()=>l,Fu:()=>p});var i,n,o,a=r(566),_=r(68),s=r(822),u=r(869),c=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),l=function(t){function e(e){var r=t.call(this)||this;return r.func=e,r}return c(e,t),e.prototype.distanceTo=function(t,e,r){return this.func(t,e,r)},e.line_circle=function(t,e,r){var i=t.px,n=t.py,o=t.px+t.len*Math.cos(t.dir),a=t.py+t.len*Math.sin(t.dir),_=Math.sqrt(Math.pow(i-o,2)+Math.pow(n-a,2)),s=Math.abs((o-i)*(n-r)-(i-e)*(a-n)),u=Math.sqrt(Math.pow(i-e,2)+Math.pow(n-r,2)),c=Math.sqrt(Math.pow(o-e,2)+Math.pow(a-r,2));return Math.pow(Math.max(u,c),2)>Math.pow(Math.min(u,c),2)+Math.pow(_,2)?Math.min(u,c)-t.shaped_sprite.hitbox_width*t.w:Math.min(s/_,u,c)-t.shaped_sprite.hitbox_width*t.w},e.double_arc=function(t,e,r){var i=e-t.px,n=r-t.py,o=i*Math.cos(-t.dir)-n*Math.sin(-t.dir),_=i*Math.sin(-t.dir)+n*Math.cos(-t.dir);return a.HC.orthDis(o-t.len/2,_,t.len/2,t.w*t.shaped_sprite.hitbox_width)},e.half_arc=function(t,e,r){var i=e-t.px,n=r-t.py,o=i*Math.cos(-t.dir)-n*Math.sin(-t.dir),_=i*Math.sin(-t.dir)+n*Math.cos(-t.dir);return o<0?Math.sqrt(Math.pow(o,2)+Math.pow(_,2)):a.HC.orthDis(o,_,t.len,t.w*t.shaped_sprite.hitbox_width)},e}(a.bn);!function(t){t[t.WARNING=0]="WARNING",t[t.OPENING=1]="OPENING",t[t.OPENED=2]="OPENED",t[t.CLOSING=3]="CLOSING"}(n||(n={})),o=a.Yw,c((function(){return null!==o&&o.apply(this,arguments)||this}),o);var p=function(t){function e(e,r,i){var o=t.call(this,e)||this;return o.state=u.ZM.PRE_ENTRY,o.rstate=n.WARNING,o.time=0,o.config=r,o.motion=i,o}return c(e,t),e.prototype.init=function(t,e,r,i){return this.len=i,this.dir=r,this.px=t,this.py=e,this},e.prototype.update=function(t){var e,r,i,o,a,_,c,l,p,h,f,d,E,y,v=this;this.state==u.ZM.PRE_ENTRY&&(this.state=u.ZM.LEAVING,null===(r=null===(e=this.config.listener)||void 0===e?void 0:e.onInit)||void 0===r||r.forEach((function(t){return t(v)})));var M=s.n.INSTANCE.special_effects.time_rate;this.time+=M;var A=this.config.warning_time,P=this.config.open_time+A,m=this.config.alive_time+P,g=this.config.close_time+m;this.rstate==n.WARNING&&this.time>=A&&(this.rstate=n.OPENING,null===(o=null===(i=this.config.listener)||void 0===i?void 0:i.onStateChange)||void 0===o||o.forEach((function(t){return t(v)}))),this.rstate==n.OPENING&&(this.w=Math.min(1,(this.time-A)/(P-A)),this.time>=P&&(this.rstate=n.OPENED,this.state=u.ZM.ALIVE,this.w=1,null===(_=null===(a=this.config.listener)||void 0===a?void 0:a.onStateChange)||void 0===_||_.forEach((function(t){return t(v)})))),this.rstate==n.OPENED&&this.time>=m&&(this.rstate=n.CLOSING,this.state=u.ZM.LEAVING,null===(l=null===(c=this.config.listener)||void 0===c?void 0:c.onStateChange)||void 0===l||l.forEach((function(t){return t(v)}))),this.rstate==n.CLOSING&&(this.w=Math.max(0,1-(this.time-m)/(g-m)),this.time>=g&&(this.state=u.ZM.DEAD,null===(h=null===(p=this.config.listener)||void 0===p?void 0:p.onDestroy)||void 0===h||h.forEach((function(t){return t(v)})))),null===(d=null===(f=this.config.listener)||void 0===f?void 0:f.onUpdate)||void 0===d||d.forEach((function(t){return t(v,M)})),this.motion(this,M),null===(y=null===(E=this.config.listener)||void 0===E?void 0:E.onPostMotion)||void 0===y||y.forEach((function(t){return t(v,M)}))},e.prototype.postUpdate=function(t){var e,r,i=this;null===(r=null===(e=this.config.listener)||void 0===e?void 0:e.onPostUpdate)||void 0===r||r.forEach((function(t){return t(i)}))},e.prototype.attack=function(t,e){var r,i,n=this;null===(i=null===(r=this.config.listener)||void 0===r?void 0:r.onAttack)||void 0===i||i.forEach((function(t){return t(n,e)})),e.damaged(e,this)},e.prototype.damaged=function(t,e){var r,i,n=this;return null===(i=null===(r=this.config.listener)||void 0===r?void 0:r.onContact)||void 0===i||i.forEach((function(t){return t(n,e)})),!1},e}(function(t){function e(e){var r=t.call(this,_.I.RECT,e)||this;return r.w=0,r}return c(e,t),e.prototype.rectCount=function(){return 1},e.prototype.render=function(t,e){var r=this.shaped_sprite.l_ratio*this.len/2;t[10*e+0]=this.px+r*Math.cos(this.dir),t[10*e+1]=this.py+r*Math.sin(this.dir),t[10*e+2]=this.dir+Math.PI/2,t[10*e+3]=Math.max(1,this.shaped_sprite.sprite_width*this.w),t[10*e+4]=r;var i=this.shaped_sprite.sprite;t[10*e+5]=i.tx/i.sprite.w,t[10*e+6]=i.ty/i.sprite.h,t[10*e+7]=i.tw/i.sprite.w,t[10*e+8]=i.th/i.sprite.h,t[10*e+9]=1},e}(a.hE))},533:(t,e,r)=>{r.d(e,{U:()=>u});var i,n=r(566),o=r(349),a=r(869),_=r(822),s=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),u=function(t){function e(r,i,n,o,_){var s=t.call(this,(0,a.d9)(r))||this;return s.config=a.S,s.state=a.ZM.ALIVE,s.miss=!1,s.bomb=!1,s.pre_miss=0,s.miss_time=0,s.invince_time=0,s.time=0,e.INSTANCE=s,s.proto=i,s.ability=n,s.sprite=r,s.px=o,s.py=_,s.dir=0,s}return s(e,t),e.updateState=function(t){e.action=t},e.prototype.update=function(t){e.action&&(this.px+=e.action.pos_x,this.py+=e.action.pos_y,this.px<-o.SH&&(this.px=-o.SH),this.px>o.SH&&(this.px=o.SH),this.py<-o.ZP&&(this.py=-o.ZP),this.py>o.ZP&&(this.py=o.ZP),this.time+=_.n.INSTANCE.special_effects.time_rate,this.dir=this.time*Math.PI*2/600,this.proto.updateShoot(e.action.key_z),this.bomb=this.proto.updateBomb(e.action.key_x),this.proto.updateSpecial(e.action.key_c))},e.prototype.postUpdate=function(t){this.miss_time>0&&this.miss_time--,this.pre_miss>0&&(this.pre_miss--,0==this.pre_miss&&(console.log("missed"),this.miss_time=this.ability.miss_time)),this.miss&&(this.miss=!1,this.pre_miss=this.ability.pre_miss),this.bomb&&(this.bomb=!1,this.miss_time=this.ability.bomb_time,this.pre_miss>0&&(console.log("bomb after miss"),this.pre_miss=0)),this.miss_time>0||this.pre_miss>0?(this.invince_time++,Math.floor(this.invince_time/6)%2==0?this.shaped_sprite.sprite=null:this.shaped_sprite.sprite=this.sprite.sprite):(this.invince_time=0,this.shaped_sprite.sprite=this.sprite.sprite)},e.prototype.attack=function(t,e){},e.prototype.damaged=function(t,e){return 0==this.pre_miss&&0==this.miss_time&&(this.miss=!0),e.damaged(e,this)},e.INSTANCE=null,e.action=null,e}(n.eY)},822:(t,e,r)=>{r.d(e,{n:()=>s});var i,n=r(869),o=r(566),a=r(68),_=function(){this.time_rate=1};!function(t){t[t.PRE_INIT=0]="PRE_INIT",t[t.UPDATE=1]="UPDATE",t[t.POST_UPDATE=2]="POST_UPDATE",t[t.ADD_BACK=3]="ADD_BACK"}(i||(i={}));var s=function(){function t(){this.groups=[],this.pending=[],this.update_stage=i.PRE_INIT,this.time=0,this.special_effects=new _,t.INSTANCE=this,this.groups.push({id:n.T,mask:n.KZ,list:[]}),this.groups.push({id:n.ZE,mask:n.DV,list:[]}),this.groups.push({id:n.yR,mask:n.P4,list:[]}),this.groups.push({id:n.A4,mask:n.k8,list:[]}),this.groups.push({id:n.t_,mask:n.Gs,list:[]}),this.groups.push({id:n.T7,mask:n.Io,list:[]})}return t.prototype.registerGroup=function(t){var e=this.groups.length;return this.groups.push({id:e,mask:t,list:[]}),e},t.prototype.add=function(t){this.update_stage!=i.ADD_BACK&&this.update_stage!=i.PRE_INIT?this.pending.push(t):this.groups[t.config.collide_group].list.push(t)},t.prototype.update=function(){var t=this;this.update_stage=i.UPDATE,this.groups.forEach((function(t){return t.list.forEach((function(t){return t.update(t)}))}));for(var e=0;e<this.groups.length;e++)for(var r=0;r<this.groups.length;r++)if(this.groups[e].mask&1<<r)for(var a=0,_=this.groups[e].list;a<_.length;a++){var s=_[a];if(s.state==n.ZM.ALIVE&&s.shaped_sprite&&s.shaped_sprite.shape)for(var u=0,c=this.groups[r].list;u<c.length;u++){var l=c[u];l.state==n.ZM.ALIVE&&l.shaped_sprite&&l.shaped_sprite.shape&&(0,o._R)(s,l)&&s.attack(s,l)}}this.update_stage=i.POST_UPDATE,this.groups.forEach((function(t){return t.list.forEach((function(t){return t.postUpdate(t)}))})),this.groups.forEach((function(t){return t.list=t.list.filter((function(t){return t.state!=n.ZM.DEAD}))})),this.update_stage=i.ADD_BACK,this.pending.forEach((function(e){return t.add(e)})),this.pending=[],this.time++},t.prototype.render=function(){var t,e,r,i,n,o,_,s;return n=this,o=void 0,s=function(){var n,o,_,s,u,c,l,p,h,f;return function(t,e){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:_(0),throw:_(1),return:_(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function _(o){return function(_){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((n=(n=a.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,_])}}}(this,(function(d){for(n=new Map,o=0,_=this.groups;o<_.length;o++)for(s=_[o],u=0,c=s.list;u<c.length;u++)(l=c[u]).config.render_layer&&(null===(t=l.shaped_sprite)||void 0===t?void 0:t.sprite)&&(n.has(l.config.render_layer)||n.set(l.config.render_layer,new Map),p=n.get(l.config.render_layer),h=null===(i=null===(r=null===(e=l.shaped_sprite)||void 0===e?void 0:e.sprite)||void 0===r?void 0:r.sprite)||void 0===i?void 0:i.path,p.has(h)||p.set(h,[]),p.get(h).push(l));return f=[],n.forEach((function(t,e){return f.push({rl:e,v:t})})),f.sort((function(t,e){return t.rl-e.rl})),f.forEach((function(t){return t.v.forEach((function(t,e){return a.Z.get(e).draw(t)}))})),[2]}))},new((_=void 0)||(_=Promise))((function(t,e){function r(t){try{a(s.next(t))}catch(t){e(t)}}function i(t){try{a(s.throw(t))}catch(t){e(t)}}function a(e){var n;e.done?t(e.value):(n=e.value,n instanceof _?n:new _((function(t){t(n)}))).then(r,i)}a((s=s.apply(n,o||[])).next())}))},t}()},334:(t,e,r)=>{r.d(e,{FX:()=>l,hP:()=>d,b2:()=>y});var i,n=r(869),o=r(566),a=r(822),_=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var i=Array(t),n=0;for(e=0;e<r;e++)for(var o=arguments[e],a=0,_=o.length;a<_;a++,n++)i[n]=o[a];return i},u=function(){},c=function(t){function e(e){var r=t.call(this)||this;return r.remain=e,r}return _(e,t),e.prototype.update=function(t){return this.remain-=t,this.remain<0?-this.remain:0},e}(u),l=function(t){function e(e,r,i,n,o){var a=t.call(this)||this;return a.time=0,a.target=e,a.duration=r,a.dx=i,a.dy=n,a.x0=e.px,a.y0=e.py,a.ease=o,a}return _(e,t),e.random=function(t,r){var i=Math.max(r.px0-t.px,-r.dx1),n=Math.min(r.px1-t.px,r.dx1),o=Math.max(r.py0-t.py,-r.dy1),a=Math.min(r.py1-t.py,r.dy1),_=i+Math.random()*(n-i),s=o+Math.random()*(a-o);return new e(t,r.duration,_,s,r.ease)},e.prototype.update=function(t){this.time+=t;var e=Math.min(1,this.time/this.duration),r=this.ease(e);return this.target.px=this.x0+this.dx*r,this.target.py=this.y0+this.dy*r,this.time>this.duration?this.time-this.duration:0},e}(u),p=function(t){function e(e){var r=t.call(this)||this;return r.todo=e,r}return _(e,t),e.prototype.update=function(t){return this.todo(),t},e}(u),h=function(){};function f(t){return t.map((function(t){return"number"==typeof t?new c(t):"function"==typeof t?new p(t):t}))}var d=function(t){function e(e,r){var i=t.call(this)||this;return i.index=0,i.todo=e,i.total=r,i}return _(e,t),e.prototype.supply=function(){return this.index>=this.total?null:(t="function"==typeof this.todo?this.todo(this.index):this.todo,this.index++,f(t));var t},e}(h),E={render_layer:n.NH,collide_group:n.T7,collide_mask:n.Io},y=function(t){function e(e){var r=t.call(this)||this;return r.config=E,r.state=n.ZM.PRE_ENTRY,r.time=0,r.list=f(e),r}return _(e,t),e.prototype.update=function(t){this.state==n.ZM.PRE_ENTRY&&(this.state=n.ZM.ALIVE);var e=a.n.INSTANCE.special_effects.time_rate;for(this.time+=e;this.list.length>0&&e;){var r=this.list[0];if(r instanceof h){var i=r.supply();i&&i.length?this.list=s(i,this.list):this.list.shift()}else(e=r.update(e))>0&&this.list.shift()}0==this.list.length&&(this.state=n.ZM.LEAVING)},e.prototype.postUpdate=function(t){this.state==n.ZM.LEAVING&&(this.state=n.ZM.DEAD)},e.prototype.attack=function(t){},e.prototype.damaged=function(t,e){return!1},e}(o.u5)},176:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{S:()=>init});var _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(651),_entity_SelfMachine__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(533),_stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(334),_util_SpriteManager__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(68),_util_sprites__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(940),_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(583),_stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(822),_entity_Entity__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(869),_entity_RayLaser__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(296),__awaiter=function(t,e,r,i){return new(r||(r=Promise))((function(n,o){function a(t){try{s(i.next(t))}catch(t){o(t)}}function _(t){try{s(i.throw(t))}catch(t){o(t)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,_)}s((i=i.apply(t,e||[])).next())}))},__generator=function(t,e){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:_(0),throw:_(1),return:_(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function _(o){return function(_){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((n=(n=a.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,_])}}},sm_proto={updateShoot:function(t){return!1},updateBomb:function(t){return!1},updateSpecial:function(t){return!1}},sm_abi={pre_miss:30,miss_time:60,bomb_time:60},repeat=function(t,e){return void 0===e&&(e=1/0),new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.hP(t,e)},stage_000=function(t){var e=_util_sprites__WEBPACK_IMPORTED_MODULE_4__.hZ(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.Dp.Oval,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.C8.Red,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.fz.Overlay),r=_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(e,1);return new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([30*t,repeat((function(e){return[repeat((function(i){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(r,_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0).simpleInit(0,0,8/t,.003/t*e*e+2*Math.PI/5*i))}]}),5),1*t]}),1/0)])},stage_001=function(t){var e=function(t){return _util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.e8(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qb.Scale,t,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.fz.Overlay),1)},r=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0);r.life=180*t,r.kill_on_exit=!1;var i={duration:100*t,px0:-96,px1:96,py0:32,py1:112,dx1:64,dy1:64,ease:function(t){return(1-Math.cos(Math.PI*t))/2}},n=1*t,o=3/t,a=-o/70,_=.06/t,s=new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.cI,2),_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0).setMotion((function(t){return t.dir=t.time*Math.PI*2/600,!1})).simpleInit(0,64,0,0),u=null,c=function(t,e,i,c){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([repeat((function(l){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(u=new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(null,r).simpleInit(s.px,s.py,o,2*Math.PI/47*l*e*t))},repeat((function(e){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(l%2==0?i:c,_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0).setMotion((r=u,n=2*Math.PI/30*e,o=_*t,70,s=a,function(t,e){var i=n+o*t.time,a=70*Math.sin(s*t.time);return t.px=r.px+a*Math.cos(i),t.py=r.py+a*Math.sin(i),t.dir=Math.atan2(a*o,70*s*Math.cos(s*t.time))+i,!1})));var r,n,o,s}]}),30),n]}),47)]))};return new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(s)},30*t,repeat((function(r){return[function(){return c(r%2*2-1,7,e(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Red),e(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Green))},50*t,function(){return c(r%2*2-1,5,e(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Yellow),e(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Blue))},50*t,function(){return c(r%2*2-1,1,e(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Cyan),e(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Pink))},_stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.FX.random(s,i)]}))])},stage_002=function(t){var e=[_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.iW(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.u3.Laser,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Red,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.fz.AddBlend),_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.iW(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.u3.Scale,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Red,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.fz.AddBlend),_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.iW(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.u3.Grain,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Red,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.fz.AddBlend)],r={render_layer:_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0.render_layer,collide_group:_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0.collide_group,collide_mask:_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0.collide_mask,warning_time:30*t,open_time:10*t,alive_time:6e3*t,close_time:10*t,listener:null},i=0*Math.PI*2/240/t;return new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([30*t,repeat((function(n){return[repeat((function(t){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _entity_RayLaser__WEBPACK_IMPORTED_MODULE_8__.Fu(e[t%3],r,(o=i*(n%2*2-1),function(t,e){return t.dir+=e*o})).init(50*Math.cos(2*Math.PI/18*t),50*Math.sin(2*Math.PI/18*t),2*Math.PI/18*t,100));var o}]}),18),6e3*t]}))])},sinit={load_sprite:function(){return _util_SpriteManager__WEBPACK_IMPORTED_MODULE_3__.Z.get(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.Xp.path).load()},add_player:function(){return new _entity_SelfMachine__WEBPACK_IMPORTED_MODULE_1__.U(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.a_,1),sm_proto,sm_abi,0,-192)},add_schedule:stage_001};function init(){return __awaiter(this,void 0,void 0,(function(){var pool;return __generator(this,(function(_a){switch(_a.label){case 0:return[4,sinit.load_sprite()];case 1:return _a.sent(),pool=new _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n,pool.add(sinit.add_player()),pool.add(sinit.add_schedule(3)),eval("window.debug_info.pool = pool"),[2]}}))}))}},566:(t,e,r)=>{r.d(e,{bn:()=>_,D8:()=>u,HC:()=>c,Yw:()=>l,hE:()=>p,eY:()=>h,u5:()=>f,_R:()=>d});var i,n,o=r(68),a=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),_=function(){},s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e}(_),u=function(t){function e(e){var r=t.call(this)||this;return r.radius=e,r}return a(e,t),e.prototype.exitScreen=function(t,e,r){var i=Math.sqrt(Math.pow(t.shaped_sprite.w,2)+Math.pow(t.shaped_sprite.h,2));return Math.abs(t.px)>e+i*t.magn||Math.abs(t.py)>r+i*t.magn},e.prototype.distanceTo=function(t,e,r){return Math.sqrt(Math.pow(e-t.px,2)+Math.pow(r-t.py,2))-this.radius*t.magn},e}(s),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.orthDis=function(t,e,r,i){t=Math.abs(t);var n=r*r/i/2+i/2-i;return(e=Math.abs(e))>=0&&r*(e+n)>t*n?Math.sqrt(Math.pow(t,2)+Math.pow(e+n,2))-n:Math.sqrt(Math.pow(t-r,2)+Math.pow(e,2))},e.prototype.exitScreen=function(t,e,r){var i=Math.sqrt(Math.pow(t.shaped_sprite.w,2)+Math.pow(t.shaped_sprite.h,2));return Math.abs(t.px)>e+i*t.magn||Math.abs(t.py)>r+i*t.magn},e.prototype.distanceTo=function(t,r,i){var n=r-t.px,o=i-t.py,a=n*Math.cos(-t.dir)-o*Math.sin(-t.dir),_=n*Math.sin(-t.dir)+o*Math.cos(-t.dir);return e.orthDis(a,_,this.len/2*t.magn,this.rad*t.magn)},e}(s),l=function(){},p=(a((function(){return null!==n&&n.apply(this,arguments)||this}),n=l),function(){function t(t,e){this.renderType=t,this.shaped_sprite=e}return t.prototype.distanceTo=function(t,e){return this.shaped_sprite.shape.distanceTo(this,t,e)},t}()),h=function(t){function e(e){var r=t.call(this,o.I.RECT,e)||this;return r.magn=1,r.alpha=1,r}return a(e,t),e.prototype.rectCount=function(){return 1},e.prototype.render=function(t,e){t[10*e+0]=this.px,t[10*e+1]=this.py,t[10*e+2]=this.dir+Math.PI/2,t[10*e+3]=this.shaped_sprite.w/2*this.magn,t[10*e+4]=this.shaped_sprite.h/2*this.magn;var r=this.shaped_sprite.sprite;t[10*e+5]=r.tx/r.sprite.w,t[10*e+6]=r.ty/r.sprite.h,t[10*e+7]=r.tw/r.sprite.w,t[10*e+8]=r.th/r.sprite.h,t[10*e+9]=this.alpha},e}(p),f=function(t){function e(){return t.call(this,null,null)||this}return a(e,t),e}(p);function d(t,e){if(t instanceof h&&t.shaped_sprite.shape instanceof u)return e.distanceTo(t.px,t.py)<t.shaped_sprite.shape.radius;if(e instanceof h&&e.shaped_sprite.shape instanceof u)return d(e,t);throw new Error("non-circle non-circle collision not found")}},68:(t,e,r)=>{r.d(e,{I:()=>i,Z:()=>a});var i,n=r(924),o=r(940);!function(t){t[t.RECT=0]="RECT",t[t.STRIP=1]="STRIP"}(i||(i={}));var a=function(){function t(t){this.img=null,this.path=t}return t.prototype.loaded=function(){return this.img},t.prototype.load=function(){return t=this,e=void 0,i=function(){var t;return function(t,e){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:_(0),throw:_(1),return:_(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function _(o){return function(_){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((n=(n=a.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,_])}}}(this,(function(e){switch(e.label){case 0:return[4,n.po(this.path)];case 1:return t=e.sent(),this.img=n.yG(t),[2]}}))},new((r=void 0)||(r=Promise))((function(n,o){function a(t){try{s(i.next(t))}catch(t){o(t)}}function _(t){try{s(i.throw(t))}catch(t){o(t)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,_)}s((i=i.apply(t,e||[])).next())}));var t,e,r,i},t.get=function(e){return t.INS[e]?t.INS[e]:t.INS[e]=new t(e)},t.prototype.draw=function(t){this.drawRect(t,o.fz.Overlay),this.drawRect(t,o.fz.AddBlend);for(var e=0,r=t;e<r.length;e++){var a=r[e];if(a.renderType==i.STRIP)for(var _=a,s=_.getSprite(),u=s.sprite,c=0,l=_.render();c<l.length;c++){var p=l[c];n.AJ(p,s.w,p.length/2,u.tx,u.ty,u.tw,u.th,this.img)}}},t.prototype.drawRect=function(t,e){var r=t.reduce((function(t,r){return r.renderType==i.RECT&&r.shaped_sprite.sprite.mode==e?t+r.rectCount():t}),0);if(r){n.PM(e);for(var o=new Float32Array(10*r),a=0,_=0,s=t;_<s.length;_++){var u=s[_];if(u.renderType==i.RECT&&u.shaped_sprite.sprite.mode==e){var c=u;c.render(o,a),a+=c.rectCount()}}n.bn(o,t.length,this.img)}},t.INS={},t}()},583:(t,e,r)=>{r.d(e,{u3:()=>i,xg:()=>c,iW:()=>l});var i,n=r(296),o=r(566),a=r(68),_=r(940);!function(t){t[t.Laser=0]="Laser",t[t.Scale=1]="Scale",t[t.Grain=4]="Grain"}(i||(i={}));var s=[[1.4,0],[2.4,2.4,4,4,2.4,2.4,2.4,2.8,2.4,2.4,4,2.4,2.4,2.4,2.4,2.4],[6,7,8.5,7,6,7,0,10],[14,14]],u=.75;function c(t,e){return e*=u,{sprite:t,shape:new o.D8(s[t.category][t.type]*e),w:t.tw*e,h:t.th*e,renderType:a.I.RECT}}function l(t,e,r){var o=(0,_.e8)(t,e,r);return o.ty+=t==i.Laser?4:t==i.Grain||t==i.Scale?1:NaN,o.th-=t==i.Laser?8:t==i.Grain?2:t==i.Scale?1:NaN,{sprite:o,shape:new n.cE(t==i.Laser?n.cE.line_circle:t==i.Scale?n.cE.half_arc:t==i.Grain?n.cE.double_arc:null),renderType:a.I.RECT,sprite_width:o.tw*u/2,hitbox_width:s[o.category][o.type]*u,l_ratio:t==i.Laser||t==i.Grain||t==i.Scale?1:NaN}}},940:(t,e,r)=>{var i,n,o,a,_,s,u,c;r.d(e,{fz:()=>i,qO:()=>o,qb:()=>a,C8:()=>_,Dp:()=>s,Xp:()=>l,e8:()=>p,hZ:()=>h,a_:()=>f,cI:()=>d}),function(t){t[t.Overlay=0]="Overlay",t[t.AddBlend=1]="AddBlend"}(i||(i={})),function(t){t[t.Special=0]="Special",t[t.Small=1]="Small",t[t.Medium=2]="Medium",t[t.Large=3]="Large"}(n||(n={})),function(t){t[t.Grey=0]="Grey",t[t.RedX=1]="RedX",t[t.Red=2]="Red",t[t.PinkX=3]="PinkX",t[t.Pink=4]="Pink",t[t.BlueX=5]="BlueX",t[t.Blue=6]="Blue",t[t.CyanX=7]="CyanX",t[t.Cyan=8]="Cyan",t[t.GreenX=9]="GreenX",t[t.Green=10]="Green",t[t.Lemon=11]="Lemon",t[t.YellowX=12]="YellowX",t[t.Yellow=13]="Yellow",t[t.Orange=14]="Orange",t[t.White=15]="White"}(o||(o={})),function(t){t[t.Laser=0]="Laser",t[t.Scale=1]="Scale",t[t.Ring=2]="Ring",t[t.Ball=3]="Ball",t[t.Grain=4]="Grain",t[t.Niddle=5]="Niddle",t[t.Knife=6]="Knife",t[t.Spell=7]="Spell",t[t.Bullet=8]="Bullet",t[t.Germ=9]="Germ",t[t.Star=10]="Star",t[t.Planet=11]="Planet",t[t.S_Cross=12]="S_Cross",t[t.S_Ball=13]="S_Ball",t[t.Curve=14]="Curve",t[t.Drop=15]="Drop"}(a||(a={})),function(t){t[t.Grey=0]="Grey",t[t.Red=1]="Red",t[t.Pink=2]="Pink",t[t.Blue=3]="Blue",t[t.Cyan=4]="Cyan",t[t.Green=5]="Green",t[t.Yellow=6]="Yellow",t[t.White=7]="White"}(_||(_={})),function(t){t[t.Light=0]="Light",t[t.Star=1]="Star",t[t.Ball=2]="Ball",t[t.Butterfly=3]="Butterfly",t[t.Knife=4]="Knife",t[t.Oval=5]="Oval",t[t.LightX=6]="LightX",t[t.Heart=7]="Heart"}(s||(s={})),function(t){t[t.Red=0]="Red",t[t.Blue=1]="Blue",t[t.Green=2]="Green",t[t.Yellow=3]="Yellow"}(u||(u={})),function(t){t[t.Ball=0]="Ball",t[t.Rose=1]="Rose"}(c||(c={}));var l={path:"assets/bullet_000.png",w:516,h:772};function p(t,e,r){return{sprite:l,tx:t<12?1+16*e:t<14?1+e%8*8:t<15?1:258+16*e,ty:t<12?1+16*t:t<14?(t<13?193:241)+8*(e>>3):e<15?515+16*e:449,tw:t<12?16:t<14?8:t<15?256:16,th:t<12?16:t<14?8:16,mode:r,category:n.Small,type:t,color:e}}function h(t,e,r){return{sprite:l,tx:(t<7?1:258)+32*e,ty:0==t?209:t<7?226+32*t:257,tw:32,th:32,mode:r,category:n.Medium,type:t,color:e}}var f={sprite:l,tx:258,ty:17,tw:64,th:64,mode:i.Overlay,category:n.Special,type:0,color:0},d=(i.Overlay,n.Special,{sprite:l,tx:386,ty:81,tw:128,th:128,mode:i.Overlay,category:n.Special,type:2,color:0})},924:(t,e,r)=>{r.d(e,{cY:()=>a,PM:()=>_,po:()=>s,yG:()=>c,ZH:()=>l,bn:()=>y,AJ:()=>v});var i=r(349),n=r(940);const o={gl:null,shader:{program:0,attribute:{coord:0,tex:0,alpha:0},uniform:{uSampler:0}}};function a(){var t=document.getElementById("glcanvas"),e=t.getContext("webgl");if(null===e)return void alert("Unable to initialize WebGL. Your browser or machine may not support it.");o.gl=e;var r=e.createShader(e.VERTEX_SHADER),i=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(r,"\nattribute vec2 coord;\nattribute vec2 tex;\nattribute float alpha;\nvarying highp vec2 vTexCoord;\nvarying highp float vTexAlpha;\nvoid main() {\n    gl_Position = vec4(coord, 0.0, 1.0);\n    vTexCoord = tex;\n    vTexAlpha = alpha;\n}\n"),e.shaderSource(i,"\nprecision highp float;\nvarying highp vec2 vTexCoord;\nvarying highp float vTexAlpha;\nuniform sampler2D uSampler;\nvoid main() {\n    vec4 col = texture2D(uSampler, vTexCoord);\n    col.a *= vTexAlpha;\n    col.rgb *= col.a;\n    gl_FragColor = col;\n}\n"),e.compileShader(r),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS)){var n=e.getShaderInfoLog(i);return void console.log(n)}var a=e.createProgram();e.attachShader(a,r),e.attachShader(a,i),e.linkProgram(a),e.useProgram(a);const _=o.shader;_.program=a,_.attribute.coord=e.getAttribLocation(a,"coord"),_.attribute.tex=e.getAttribLocation(a,"tex"),_.attribute.alpha=e.getAttribLocation(a,"alpha"),_.uniform.uSampler=e.getUniformLocation(a,"uSampler"),e.enable(e.BLEND),e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA),e.disable(e.DEPTH_TEST),e.viewport(0,0,t.width,t.height)}function _(t){const e=o.gl;t==n.fz.Overlay?e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA):t==n.fz.AddBlend&&e.blendFuncSeparate(e.ONE,e.ONE,e.ONE,e.ONE_MINUS_SRC_ALPHA)}function s(t){return new Promise(((e,r)=>{let i=new Image;i.onload=()=>e(i),i.onerror=r,i.src=t}))}function u(t,e,r,i,n){const a=o.gl,_=a.createBuffer(),s=o.shader.attribute.coord;a.bindBuffer(a.ARRAY_BUFFER,_),a.bufferData(a.ARRAY_BUFFER,t,a.STATIC_DRAW),a.vertexAttribPointer(s,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(s);const u=a.createBuffer(),c=o.shader.attribute.tex;a.bindBuffer(a.ARRAY_BUFFER,u),a.bufferData(a.ARRAY_BUFFER,e,a.STATIC_DRAW),a.vertexAttribPointer(c,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(c);const l=a.createBuffer(),p=o.shader.attribute.alpha;a.bindBuffer(a.ARRAY_BUFFER,l),a.bufferData(a.ARRAY_BUFFER,r,a.STATIC_DRAW),a.vertexAttribPointer(p,1,a.FLOAT,!1,0,0),a.enableVertexAttribArray(p),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,i),a.uniform1i(o.shader.uniform.uSampler,0),a.drawArrays(a.TRIANGLES,0,n)}function c(t){const e=o.gl,r=e.createTexture();return e.bindTexture(e.TEXTURE_2D,r),e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_SHORT_4_4_4_4,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),r}function l(){const t=o.gl;t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT),t.clearColor(0,0,1,1)}const p=[-1,-1,1,-1,1,1],h=[-1,1,1,-1,-1,1],f=[0,0,1,0,1,1],d=[0,1,1,0,0,1];function E(t){for(var e=0;e<t.length/2;e++)t[2*e]=(0,i.OK)(t[2*e]),t[2*e+1]=(0,i.ZA)(t[2*e+1])}function y(t,e,r){const i=new Float32Array(12*e),n=new Float32Array(12*e),o=new Float32Array(6*e);Math.PI;for(var a=0;a<e;a++)for(var _=0;_<6;_++){const e=t[10*a+2],r=t[10*a+3]*p[_],s=t[10*a+4]*h[_];i[12*a+2*_+0]=t[10*a+0]+r*Math.cos(e)-s*Math.sin(e),i[12*a+2*_+1]=t[10*a+1]+r*Math.sin(e)+s*Math.cos(e),n[12*a+2*_+0]=t[10*a+5]+f[_]*t[10*a+7],n[12*a+2*_+1]=t[10*a+6]+d[_]*t[10*a+8],o[6*a+_]=t[10*a+9]}E(i),u(i,n,o,r,6*e)}function v(t,e,r,i,n,a,_,s){const u=new Float32Array(6*r),c=new Float32Array(r),l=new Float32Array(6*r),p=new Int16Array(2*(r-1));for(var h=0,f=0;f<r-1;f++){const r=t[2*f],i=t[2*f+1],n=t[2*f+2],o=t[2*f+3],a=(r+n)/2,_=(i+o)/2,s=Math.sqrt((n-r)*(n-r)+(o-i)*(o-i));c[f]=s,h+=s,u[6*f+0]=r,u[6*f+1]=i,u[6*f+2]=a-(_-i)/s*e,u[6*f+3]=_+(a-r)/s*e,u[6*f+4]=a+(_-i)/s*e,u[6*f+5]=_-(a-r)/s*e}E(u),h-=c[0]/2+c[r-1]/2;var d=-c[0]/2;for(f=1;f<r;f++)l[6*f+0]=i+a*d/h,l[6*f+1]=n+_/2,d+=c[f]/2,l[6*f+2]=i+a*d/h,l[6*f+3]=n,l[6*f+4]=i+a*d/h,l[6*f+5]=n+_,d+=c[f]/2;for(f=0;f<r-1;f++)p[2*f+0]=3*f+1,p[2*f+1]=3*f+3;p[2*r-3]--;const y=o.gl,v=y.createBuffer(),M=o.shader.attribute.coord;y.bindBuffer(y.ARRAY_BUFFER,v),y.bufferData(y.ARRAY_BUFFER,u,y.STATIC_DRAW),y.vertexAttribPointer(M,2,y.FLOAT,!1,0,0),y.enableVertexAttribArray(M);const A=y.createBuffer(),P=o.shader.attribute.tex;y.bindBuffer(y.ARRAY_BUFFER,A),y.bufferData(y.ARRAY_BUFFER,l,y.STATIC_DRAW),y.vertexAttribPointer(P,2,y.FLOAT,!1,0,0),y.enableVertexAttribArray(P),y.activeTexture(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,s),y.uniform1i(o.shader.uniform.uSampler,0);const m=y.createBuffer();for(y.bindBuffer(y.ELEMENT_ARRAY_BUFFER,m),y.bufferData(y.ELEMENT_ARRAY_BUFFER,p,y.STATIC_DRAW),y.drawElements(y.TRIANGLE_STRIP,2*r-2,y.UNSIGNED_SHORT,0),f=0;f<r-1;f++)p[2*f+0]=3*f,p[2*f+1]=3*f+2;p[0]++,y.bufferData(y.ELEMENT_ARRAY_BUFFER,p,y.STATIC_DRAW),y.drawElements(y.TRIANGLE_STRIP,2*r-2,y.UNSIGNED_SHORT,0)}window.debug_info={},window.debug_info.global_gl=o,window.debug_info.gl_func={setup:a,clear:l,draw:u,drawStrip:function(t,e,r,i,n){const a=o.gl,_=a.createBuffer(),s=o.shader.attribute.coord;a.bindBuffer(a.ARRAY_BUFFER,_),a.bufferData(a.ARRAY_BUFFER,t,a.STATIC_DRAW),a.vertexAttribPointer(s,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(s);const u=a.createBuffer(),c=o.shader.attribute.tex;a.bindBuffer(a.ARRAY_BUFFER,u),a.bufferData(a.ARRAY_BUFFER,e,a.STATIC_DRAW),a.vertexAttribPointer(c,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(c);const l=a.createBuffer();a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,l),a.bufferData(a.ELEMENT_ARRAY_BUFFER,r,a.STATIC_DRAW),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,i),a.uniform1i(o.shader.uniform.uSampler,0),a.drawElements(a.TRIANGLE_STRIP,n,a.UNSIGNED_SHORT,0)},drawRects:y,drawSnake:v}}},__webpack_module_cache__={};function __webpack_require__(t){if(__webpack_module_cache__[t])return __webpack_module_cache__[t].exports;var e=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](e,e.exports,__webpack_require__),e.exports}__webpack_require__.d=(t,e)=>{for(var r in e)__webpack_require__.o(e,r)&&!__webpack_require__.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t={};__webpack_require__.r(t),__webpack_require__.d(t,{KEY_CLICK:()=>D,KEY_PRESS:()=>w,canvas_height:()=>h,canvas_width:()=>p,devicePixelRatio:()=>y,keys:()=>m,last_update_rate:()=>v,mainloop_start:()=>T,mainloop_terminate:()=>b,mouse:()=>P,setup_canvas:()=>g,test_fps:()=>M});var e=__webpack_require__(176),r=__webpack_require__(924),i=__webpack_require__(822),n=__webpack_require__(533),o=__webpack_require__(349),a=!1,_=!1,s=0,u=0,c=0,l=0;var p,h,f=0,d=0,E=null,y=1,v=1;function M(){return f=performance.now(),d=241,A(),new Promise(((t,e)=>{E=t}))}function A(){if(--d)requestAnimationFrame(A);else{var t=(performance.now()-f)/240;v=Math.round(t/(1e3/60)),E(v)}}var P={x:0,y:0},m={};function g(){document.onmousemove=t=>{P.x=t.pageX,P.y=t.pageY},document.ontouchstart=t=>{m._touch=3,P.x=t.pageX,P.y=t.pageY,t.preventDefault()},document.ontouchend=t=>{m._touch=1,P.x=t.pageX,P.y=t.pageY,t.preventDefault()},document.ontouchmove=t=>{P.x=t.pageX,P.y=t.pageY,t.preventDefault()},document.onmousedown=t=>{m._press=3},document.onmouseup=t=>{m._press=1},document.addEventListener("keydown",(t=>{var e=t.key;1==e.length&&(e=e.toLowerCase()),m[e]=3}),!1),document.addEventListener("keyup",(t=>{var e=t.key;1==e.length&&(e=e.toLowerCase()),m[e]=1}),!1);var t=window.innerWidth,e=window.innerHeight,i=.95*Math.min(t/o.Fy,e/o.bE),n=document.getElementById("glcanvas");p=i*o.Fy,h=i*o.bE,n.style.width=p+"px",n.style.height=h+"px",y=window.devicePixelRatio||1,n.width=p*y,n.height=h*y,r.cY()}var R=!1;function T(){R||(R=!0,O())}function b(){R=!1}function O(){!function(){var t=i.n.INSTANCE;if(t){var e=function(){if(m.Escape==D&&(a=!a),a)return _=!1,null;var t=0,e=0;m.Shift>=w||m._touch>=w||m._press>=w?(_||(_=!0,s=P.x,u=P.y,c=0,l=0),t=P.x-s-c,e=P.y-u-l,c+=t,l+=e):_=!1,t=t/p*o.Fy*2,e=-e/h*o.bE*2;var r=m.Shift>=w?2:3;return(m.w>=w||m.ArrowUp>=w)&&(e+=r),(m.s>=w||m.ArrowDown>=w)&&(e-=r),(m.a>=w||m.ArrowLeft>=w)&&(t-=r),(m.d>=w||m.ArrowRight>=w)&&(t+=r),{pos_x:t,pos_y:e,key_z:m.z>=w,key_x:m.x==D,key_c:m.c==D}}();if(!a&&(n.U.updateState(e),!a))for(var f=0;f<v;f++)t.update();r.ZH(),t.render()}}(),function(){for(var t in m)3==m[t]&&(m[t]=2),1==m[t]&&(m[t]=0)}(),R&&requestAnimationFrame(O)}const w=2,D=3;window.onload=async function(){M(),g(),await e.S(),T(),window.debug_info.stg={fps:M,init:e.S,start:T,terminate:b},window.debug_info.platform=t}})()})();