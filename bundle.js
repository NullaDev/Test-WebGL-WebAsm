(()=>{"use strict";var __webpack_modules__={349:(t,e,_)=>{_.d(e,{SH:()=>n,ZP:()=>i,Fy:()=>r,bE:()=>o,OK:()=>a,ZA:()=>s});var n=192,i=224,r=192,o=224;function a(t){return t/r}function s(t){return t/o}},799:(t,e,_)=>{_.d(e,{Fe:()=>a,VN:()=>s,wv:()=>u,cf:()=>p,DP:()=>c,zA:()=>h,so:()=>l});var n=_(349),i=_(822),r=_(869),o=_(296),a={onInit:[],onUpdate:[],onPostMotion:[],onPostUpdate:[],onAttack:[],onDestroy:[],onExitScreen:[],onKill:[]},s={onInit:[],onUpdate:[],onPostMotion:[],onStateChange:[],onPostUpdate:[],onAttack:[],onContact:[],onDestroy:[]},u={w0:-n.SH,w1:n.SH,h0:-n.ZP,h1:n.ZP,max:1/0,inner_bound:!0,outer_bound:!1},p=function(t){return function(e){e.onInit.push((function(e){var _=e.custom_fields;_.in_screen=e.px>t.w0&&e.px<t.w1&&e.py>t.h0&&e.py<t.h1,_.ref_count=0})),e.onPostMotion.push((function(e,_){var n=e.custom_fields,i=n.in_screen;n.in_screen=e.px>t.w0&&e.px<t.w1&&e.py>t.h0&&e.py<t.h1,i&&!n.in_screen&&t.inner_bound&&(n.ref_count<t.max&&e.px<=t.w0&&(n.ref_count++,e.vx=-e.vx,e.px=2*t.w0-e.px),n.ref_count<t.max&&e.px>=t.w1&&(n.ref_count++,e.vx=-e.vx,e.px=2*t.w1-e.px),n.ref_count<t.max&&e.py<=t.h0&&(n.ref_count++,e.vy=-e.vy,e.py=2*t.h0-e.py),n.ref_count<t.max&&e.py>=t.h1&&(n.ref_count++,e.vy=-e.vy,e.py=2*t.h1-e.py),e.dir=Math.atan2(e.vy,e.vx)),!i&&n.in_screen&&t.outer_bound&&(n.ref_count<t.max&&e.px>=t.w0&&(n.ref_count++,e.vx=-e.vx,e.px=2*t.w0-e.px),n.ref_count<t.max&&e.px<=t.w1&&(n.ref_count++,e.vx=-e.vx,e.px=2*t.w1-e.px),n.ref_count<t.max&&e.py>=t.h0&&(n.ref_count++,e.vy=-e.vy,e.py=2*t.h0-e.py),n.ref_count<t.max&&e.py<=t.h1&&(n.ref_count++,e.vy=-e.vy,e.py=2*t.h1-e.py),e.dir=Math.atan2(e.vy,e.vx))}))}},c=function(t){return function(e){return e.custom_fields.ref_count=t.max}},h={w0:-n.SH,w1:n.SH,h0:-n.ZP,h1:n.ZP,max:1/0,maxlen:NaN,v:NaN,body:null,cf:null},l=function(t){return function(e){var _=function(e,_){var i=e.custom_fields;if(i.togrow>0){var o=Math.min(i.togrow,t.v*_);_-=o/t.v,e.len+=o,i.togrow-=o}_>0&&(e.px+=_*i.vx,e.py+=_*i.vy),e.shaped_sprite.end.shape.rawExitScreen(e.px+e.len*Math.cos(e.dir),e.py+e.len*Math.sin(e.dir),e.shaped_sprite.base,n.SH,n.ZP)&&e.shaped_sprite.base.shape.rawExitScreen(e.px,e.py,e.shaped_sprite.base,n.SH,n.ZP)&&(e.state=r.ZM.DEAD)},a=function(e,_){return e>t.w0&&e<t.w1&&_>t.h0&&_<t.h1},s=function(e,_){var i=e.custom_fields;if(i.toshrink>0){var o=Math.min(i.toshrink,t.v*_);e.len-=o,i.toshrink-=o,i.toshrink<=0&&(e.state=r.ZM.DEAD)}i.togrow>0&&(_-=(o=Math.min(i.togrow,t.v*_))/t.v,e.len+=o,i.togrow-=o),_>0&&(e.px+=_*i.vx,e.py+=_*i.vy),e.shaped_sprite.base.shape.rawExitScreen(e.px,e.py,e.shaped_sprite.base,n.SH,n.ZP)&&(e.state=r.ZM.DEAD)};e.onInit.push((function(e){var n=e.custom_fields;n.ref_count=0,n.vx=t.v*Math.cos(e.dir),n.vy=t.v*Math.sin(e.dir),n.togrow=t.maxlen,n.toshrink=0,e.motion=_})),e.onPostMotion.push((function(e,_){var n=e.custom_fields,r=(a(e.px,e.py),e.px+e.len*Math.cos(e.dir)),u=e.py+e.len*Math.sin(e.dir);if(!a(r,u)&&n.ref_count<t.max){var p=new o.Fu(t.body,t.cf,s);p.init(e.px,e.py,e.dir,e.len);var c=p.custom_fields;c.vx=n.vx,c.vy=n.vy,c.togrow=n.togrow,i.n.INSTANCE.add(p);var h=0,l=0;n.ref_count<t.max&&r<=t.w0&&(h=t.w0,l=e.py+(t.w0-e.px)*n.vy/n.vx,n.ref_count++,n.vx=-n.vx,e.px=2*t.w0-e.px),n.ref_count<t.max&&r>=t.w1&&(h=t.w1,l=e.py+(t.w1-e.px)*n.vy/n.vx,n.ref_count++,n.vx=-n.vx,e.px=2*t.w1-e.px),n.ref_count<t.max&&u<=t.h0&&(l=t.h0,h=e.px+(t.h0-e.py)*n.vx/n.vy,n.ref_count++,n.vy=-n.vy,e.py=2*t.h0-e.py),n.ref_count<t.max&&u>=t.h1&&(l=t.h1,h=e.px+(t.h1-e.py)*n.vx/n.vy,n.ref_count++,n.vy=-n.vy,e.py=2*t.h1-e.py);var E=Math.sqrt(Math.pow(e.px-h,2)+Math.pow(e.py-l,2));e.len-=E,e.px=h,e.py=l,n.togrow+=E,p.len=E,c.toshrink=E+c.togrow,e.dir=Math.atan2(n.vy,n.vx)}}))}}},869:(t,e,_)=>{_.d(e,{T:()=>i,ZE:()=>r,yR:()=>o,A4:()=>a,t_:()=>s,T7:()=>u,KZ:()=>p,DV:()=>c,P4:()=>h,k8:()=>l,Gs:()=>E,Io:()=>d,NH:()=>f,bm:()=>M,ZM:()=>n,d9:()=>P,S:()=>y});var n,i=0,r=1,o=2,a=3,s=4,u=5,p=0,c=1,h=1,l=1,E=14,d=0,f=0,M=500;function P(t){return Object.assign({},t)}!function(t){t[t.PRE_ENTRY=0]="PRE_ENTRY",t[t.ALIVE=1]="ALIVE",t[t.LEAVING=2]="LEAVING",t[t.DEAD=3]="DEAD"}(n||(n={}));var y={render_layer:700,collide_group:i,collide_mask:p}},651:(t,e,_)=>{_.d(e,{R0:()=>u,uQ:()=>c});var n,i=_(869),r=_(822),o=_(349),a=_(566),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var _ in e)Object.prototype.hasOwnProperty.call(e,_)&&(t[_]=e[_])})(t,e)},function(t,e){function _(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(_.prototype=e.prototype,new _)}),u={render_layer:i.bm,collide_group:i.A4,collide_mask:i.A4,kill_on_exit:!0,kill_by:function(t){return t==i.t_||t==i.T},auto_direction:!0,life:0,listener:null},p=function(t,e){return!0},c=function(t){function e(e,_){var n=t.call(this,e)||this;return n.state=i.ZM.PRE_ENTRY,n.motion=p,n.custom_fields={},n.config=_,n.time=0,n}return s(e,t),e.prototype.setMotion=function(t){return this.motion=t,this.simpleInit(0,0,0,0)},e.prototype.simpleInit=function(t,e,_,n){return this.px=t,this.py=e,this.vx=_*Math.cos(n),this.vy=_*Math.sin(n),this.dir=n,this.motion(this,0)&&this.config.auto_direction&&(this.dir=Math.atan2(this.vy,this.vx)),this},e.prototype.init=function(t){return t(this),this},e.prototype.update=function(t){var e,_,n,o,a,s,u=this;this.state==i.ZM.PRE_ENTRY&&(this.state=i.ZM.ALIVE,null===(_=null===(e=this.config.listener)||void 0===e?void 0:e.onInit)||void 0===_||_.forEach((function(t){return t(u)})));var p=r.n.INSTANCE.special_effects.time_rate;this.time+=p,null===(o=null===(n=this.config.listener)||void 0===n?void 0:n.onUpdate)||void 0===o||o.forEach((function(t){return t(u,p)})),this.motion(this,p)&&(this.px+=this.vx*p,this.py+=this.vy*p,this.config.auto_direction&&(this.dir=Math.atan2(this.vy,this.vx))),this.shaped_sprite.sprite.omega&&(this.dir=this.time*this.shaped_sprite.sprite.omega),null===(s=null===(a=this.config.listener)||void 0===a?void 0:a.onPostMotion)||void 0===s||s.forEach((function(t){return t(u,p)}))},e.prototype.postUpdate=function(t){var e,_,n,r,a,s,u,p,c=this;(null===(_=null===(e=this.shaped_sprite)||void 0===e?void 0:e.shape)||void 0===_?void 0:_.exitScreen(this,o.SH,o.ZP))&&(this.config.kill_on_exit&&(this.state=i.ZM.LEAVING),null===(r=null===(n=this.config.listener)||void 0===n?void 0:n.onExitScreen)||void 0===r||r.forEach((function(t){return t(c)}))),this.config.life&&this.time>=this.config.life&&(this.state=i.ZM.LEAVING),null===(s=null===(a=this.config.listener)||void 0===a?void 0:a.onPostUpdate)||void 0===s||s.forEach((function(t){return t(c)})),this.state==i.ZM.LEAVING&&(null===(p=null===(u=this.config.listener)||void 0===u?void 0:u.onDestroy)||void 0===p||p.forEach((function(t){return t(c)})),this.state=i.ZM.DEAD)},e.prototype.attack=function(t,e){var _,n,i=this;null===(n=null===(_=this.config.listener)||void 0===_?void 0:_.onAttack)||void 0===n||n.forEach((function(t){return t(i,e)})),e.damaged(e,this)},e.prototype.damaged=function(t,e){var _,n,r=this;return!!this.config.kill_by(e.config.collide_group)&&(this.state=i.ZM.LEAVING,null===(n=null===(_=this.config.listener)||void 0===_?void 0:_.onKill)||void 0===n||n.forEach((function(t){return t(r,e)})),!0)},e}(a.eY)},296:(t,e,_)=>{_.d(e,{cE:()=>c,Fu:()=>h});var n,i,r,o=_(566),a=_(68),s=_(822),u=_(869),p=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var _ in e)Object.prototype.hasOwnProperty.call(e,_)&&(t[_]=e[_])})(t,e)},function(t,e){function _(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(_.prototype=e.prototype,new _)}),c=function(t){function e(e){var _=t.call(this)||this;return _.func=e,_}return p(e,t),e.prototype.distanceTo=function(t,e,_){return Math.min(this.func(t,e,_),t.shaped_sprite.base.shape.rawDistanceTo(t.px,t.py,1,e,_),t.shaped_sprite.end.shape.rawDistanceTo(t.px+t.len*Math.cos(t.dir),t.py+t.len*Math.sin(t.dir),1,e,_))},e.line_circle=function(t,e,_){var n=t.px+t.shaped_sprite.hitbox_width*Math.cos(t.dir),i=t.py+t.shaped_sprite.hitbox_width*Math.sin(t.dir),r=t.px+(t.len-t.shaped_sprite.hitbox_width)*Math.cos(t.dir),o=t.py+(t.len-t.shaped_sprite.hitbox_width)*Math.sin(t.dir),a=Math.sqrt(Math.pow(n-r,2)+Math.pow(i-o,2)),s=Math.abs((r-n)*(i-_)-(n-e)*(o-i)),u=Math.sqrt(Math.pow(n-e,2)+Math.pow(i-_,2)),p=Math.sqrt(Math.pow(r-e,2)+Math.pow(o-_,2));return Math.pow(Math.max(u,p),2)>Math.pow(Math.min(u,p),2)+Math.pow(a,2)?Math.min(u,p)-t.shaped_sprite.hitbox_width*t.w:Math.min(s/a,u,p)-t.shaped_sprite.hitbox_width*t.w},e.double_arc=function(t,e,_){var n=e-t.px,i=_-t.py,r=n*Math.cos(-t.dir)-i*Math.sin(-t.dir),a=n*Math.sin(-t.dir)+i*Math.cos(-t.dir);return o.HC.orthDis(r-t.len/2,a,t.len/2,t.w*t.shaped_sprite.hitbox_width)},e.half_arc=function(t,e,_){var n=e-t.px,i=_-t.py,r=n*Math.cos(-t.dir)-i*Math.sin(-t.dir),a=n*Math.sin(-t.dir)+i*Math.cos(-t.dir);return r<0?Math.sqrt(Math.pow(r,2)+Math.pow(a,2)):o.HC.orthDis(r,a,t.len,t.w*t.shaped_sprite.hitbox_width)},e}(o.bn);!function(t){t[t.WARNING=0]="WARNING",t[t.OPENING=1]="OPENING",t[t.OPENED=2]="OPENED",t[t.CLOSING=3]="CLOSING"}(i||(i={})),r=o.Yw,p((function(){return null!==r&&r.apply(this,arguments)||this}),r);var h=function(t){function e(e,_,n){var r=t.call(this,e)||this;return r.state=u.ZM.PRE_ENTRY,r.rstate=i.WARNING,r.time=0,r.custom_fields={},r.config=_,r.motion=n,r}return p(e,t),e.prototype.init=function(t,e,_,n){return this.len=n,this.dir=_,this.px=t,this.py=e,this.checkState(),this},e.prototype.checkState=function(){var t,e,_,n,r,o,a,s,p,c,h=this;this.state==u.ZM.PRE_ENTRY&&(this.state=u.ZM.LEAVING,null===(e=null===(t=this.config.listener)||void 0===t?void 0:t.onInit)||void 0===e||e.forEach((function(t){return t(h)})));var l=this.config.warning_time,E=this.config.open_time+l,d=this.config.alive_time+E,f=this.config.close_time+d;this.rstate==i.WARNING&&this.time>=l&&(this.rstate=i.OPENING,null===(n=null===(_=this.config.listener)||void 0===_?void 0:_.onStateChange)||void 0===n||n.forEach((function(t){return t(h)}))),this.rstate==i.OPENING&&(this.w=Math.min(1,(this.time-l)/(E-l)),this.time>=E&&(this.rstate=i.OPENED,this.state=u.ZM.ALIVE,this.w=1,null===(o=null===(r=this.config.listener)||void 0===r?void 0:r.onStateChange)||void 0===o||o.forEach((function(t){return t(h)})))),this.rstate==i.OPENED&&this.time>=d&&(this.rstate=i.CLOSING,this.state=u.ZM.LEAVING,null===(s=null===(a=this.config.listener)||void 0===a?void 0:a.onStateChange)||void 0===s||s.forEach((function(t){return t(h)}))),this.rstate==i.CLOSING&&(this.w=Math.max(0,1-(this.time-d)/(f-d)),this.time>=f&&(this.state=u.ZM.DEAD,null===(c=null===(p=this.config.listener)||void 0===p?void 0:p.onDestroy)||void 0===c||c.forEach((function(t){return t(h)}))))},e.prototype.update=function(t){var e,_,n,i,r,o,a=this;this.state==u.ZM.PRE_ENTRY&&(this.state=u.ZM.LEAVING,null===(_=null===(e=this.config.listener)||void 0===e?void 0:e.onInit)||void 0===_||_.forEach((function(t){return t(a)})));var p=s.n.INSTANCE.special_effects.time_rate;this.time+=p,this.checkState(),null===(i=null===(n=this.config.listener)||void 0===n?void 0:n.onUpdate)||void 0===i||i.forEach((function(t){return t(a,p)})),this.motion(this,p),null===(o=null===(r=this.config.listener)||void 0===r?void 0:r.onPostMotion)||void 0===o||o.forEach((function(t){return t(a,p)}))},e.prototype.postUpdate=function(t){var e,_,n=this;null===(_=null===(e=this.config.listener)||void 0===e?void 0:e.onPostUpdate)||void 0===_||_.forEach((function(t){return t(n)}))},e.prototype.attack=function(t,e){var _,n,i=this;null===(n=null===(_=this.config.listener)||void 0===_?void 0:_.onAttack)||void 0===n||n.forEach((function(t){return t(i,e)})),e.damaged(e,this)},e.prototype.damaged=function(t,e){var _,n,i=this;return null===(n=null===(_=this.config.listener)||void 0===_?void 0:_.onContact)||void 0===n||n.forEach((function(t){return t(i,e)})),!1},e}(function(t){function e(e){var _=t.call(this,a.I.RECT,e)||this;return _.w=0,_}return p(e,t),e.prototype.rectCount=function(){return 3},e.prototype.render=function(t,e){var _=this.shaped_sprite.l_ratio*this.len/2;t[10*e+0]=this.px+_*Math.cos(this.dir),t[10*e+1]=this.py+_*Math.sin(this.dir),t[10*e+2]=this.dir+Math.PI/2,t[10*e+3]=Math.max(1,this.shaped_sprite.sprite_width*this.w),t[10*e+4]=_;var n=this.shaped_sprite.sprite;t[10*e+5]=n.tx/n.sprite.w,t[10*e+6]=n.ty/n.sprite.h,t[10*e+7]=n.tw/n.sprite.w,t[10*e+8]=n.th/n.sprite.h,t[10*e+9]=1,e++;var i=this.shaped_sprite.base;t[10*e+0]=this.px,t[10*e+1]=this.py,t[10*e+2]=this.dir+Math.PI/2,t[10*e+3]=i.w/2,t[10*e+4]=i.h/2,n=i.sprite,t[10*e+5]=n.tx/n.sprite.w,t[10*e+6]=n.ty/n.sprite.h,t[10*e+7]=n.tw/n.sprite.w,t[10*e+8]=n.th/n.sprite.h,t[10*e+9]=1,e++,i=this.shaped_sprite.end,t[10*e+0]=this.px+this.len*Math.cos(this.dir),t[10*e+1]=this.py+this.len*Math.sin(this.dir),t[10*e+2]=this.dir+Math.PI/2,t[10*e+3]=i.w/2,t[10*e+4]=i.h/2,n=i.sprite,t[10*e+5]=n.tx/n.sprite.w,t[10*e+6]=n.ty/n.sprite.h,t[10*e+7]=n.tw/n.sprite.w,t[10*e+8]=n.th/n.sprite.h,t[10*e+9]=1},e}(o.hE))},533:(t,e,_)=>{_.d(e,{U:()=>u});var n,i=_(566),r=_(349),o=_(869),a=_(822),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var _ in e)Object.prototype.hasOwnProperty.call(e,_)&&(t[_]=e[_])})(t,e)},function(t,e){function _(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(_.prototype=e.prototype,new _)}),u=function(t){function e(_,n,i,r,a){var s=t.call(this,(0,o.d9)(_))||this;return s.config=o.S,s.state=o.ZM.ALIVE,s.miss=!1,s.bomb=!1,s.pre_miss=0,s.miss_time=0,s.invince_time=0,s.prex=0,s.prey=0,s.time=0,s.collideCheck=function(t){for(var e=Math.sqrt(Math.pow(s.px-s.prex,2)+Math.pow(s.py-s.prey,2)),_=Math.max(1,Math.ceil(e/2)),n=1/0,i=0;i<_;i++){var r=s.px+(s.prex-s.px)*i/_,o=s.py+(s.prey-s.py)*i/_;n=Math.min(n,t.distanceTo(r,o))}return n<s.shaped_sprite.shape.radius},e.INSTANCE=s,s.proto=n,s.ability=i,s.sprite=_,s.px=r,s.py=a,s.dir=0,s}return s(e,t),e.updateState=function(t){e.action=t},e.prototype.update=function(t){var _;if(e.action){this.prex=this.px,this.prey=this.py;var n=a.n.INSTANCE.special_effects.time_rate;this.time+=n,this.px+=e.action.pos_x*n,this.py+=e.action.pos_y*n,this.px<-r.SH&&(this.px=-r.SH),this.px>r.SH&&(this.px=r.SH),this.py<-r.ZP&&(this.py=-r.ZP),this.py>r.ZP&&(this.py=r.ZP),(null===(_=this.shaped_sprite)||void 0===_?void 0:_.sprite)&&(this.dir=this.time*this.shaped_sprite.sprite.omega),this.proto.updateShoot(e.action.key_z),this.bomb=this.proto.updateBomb(e.action.key_x),this.proto.updateSpecial(e.action.key_c)}},e.prototype.postUpdate=function(t){this.miss_time>0&&this.miss_time--,this.pre_miss>0&&(this.pre_miss--,0==this.pre_miss&&(console.log("missed"),this.miss_time=this.ability.miss_time)),this.miss&&(this.miss=!1,this.pre_miss=this.ability.pre_miss),this.bomb&&(this.bomb=!1,this.miss_time=this.ability.bomb_time,this.pre_miss>0&&(console.log("bomb after miss"),this.pre_miss=0)),this.miss_time>0||this.pre_miss>0?(this.invince_time++,Math.floor(this.invince_time/6)%2==0?this.shaped_sprite.sprite=null:this.shaped_sprite.sprite=this.sprite.sprite):(this.invince_time=0,this.shaped_sprite.sprite=this.sprite.sprite)},e.prototype.attack=function(t,e){},e.prototype.damaged=function(t,e){return 0==this.pre_miss&&0==this.miss_time&&(this.miss=!0),e.damaged(e,this)},e.INSTANCE=null,e.action=null,e}(i.eY)},822:(t,e,_)=>{_.d(e,{n:()=>s});var n,i=_(869),r=_(566),o=_(68),a=function(){this.time_rate=1};!function(t){t[t.PRE_INIT=0]="PRE_INIT",t[t.UPDATE=1]="UPDATE",t[t.POST_UPDATE=2]="POST_UPDATE",t[t.ADD_BACK=3]="ADD_BACK"}(n||(n={}));var s=function(){function t(){this.groups=[],this.pending=[],this.update_stage=n.PRE_INIT,this.time=0,this.special_effects=new a,t.INSTANCE=this,this.groups.push({id:i.T,mask:i.KZ,list:[]}),this.groups.push({id:i.ZE,mask:i.DV,list:[]}),this.groups.push({id:i.yR,mask:i.P4,list:[]}),this.groups.push({id:i.A4,mask:i.k8,list:[]}),this.groups.push({id:i.t_,mask:i.Gs,list:[]}),this.groups.push({id:i.T7,mask:i.Io,list:[]})}return t.prototype.registerGroup=function(t){var e=this.groups.length;return this.groups.push({id:e,mask:t,list:[]}),e},t.prototype.add=function(t){this.update_stage!=n.ADD_BACK&&this.update_stage!=n.PRE_INIT?this.pending.push(t):this.groups[t.config.collide_group].list.push(t)},t.prototype.update=function(){var t=this;this.update_stage=n.UPDATE,this.groups.forEach((function(t){return t.list.forEach((function(t){return t.update(t)}))}));for(var e=0;e<this.groups.length;e++)for(var _=0;_<this.groups.length;_++)if(this.groups[e].mask&1<<_)for(var o=0,a=this.groups[e].list;o<a.length;o++){var s=a[o];if(s.state==i.ZM.ALIVE&&s.shaped_sprite&&s.shaped_sprite.shape)for(var u=0,p=this.groups[_].list;u<p.length;u++){var c=p[u];c.state==i.ZM.ALIVE&&c.shaped_sprite&&c.shaped_sprite.shape&&(0,r._R)(s,c)&&s.attack(s,c)}}this.update_stage=n.POST_UPDATE,this.groups.forEach((function(t){return t.list.forEach((function(t){return t.postUpdate(t)}))})),this.groups.forEach((function(t){return t.list=t.list.filter((function(t){return t.state!=i.ZM.DEAD}))})),this.update_stage=n.ADD_BACK,this.pending.forEach((function(e){return t.add(e)})),this.pending=[],this.time++},t.prototype.render=function(){var t,e,_,n,i,r,a,s;return i=this,r=void 0,s=function(){var i,r,a,s,u,p,c,h,l,E;return function(t,e){var _,n,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(_)throw new TypeError("Generator is already executing.");for(;o;)try{if(_=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,n=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=e.call(t,o)}catch(t){r=[6,t],n=0}finally{_=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}}(this,(function(d){for(i=new Map,r=0,a=this.groups;r<a.length;r++)for(s=a[r],u=0,p=s.list;u<p.length;u++)(c=p[u]).config.render_layer&&(null===(t=c.shaped_sprite)||void 0===t?void 0:t.sprite)&&(i.has(c.config.render_layer)||i.set(c.config.render_layer,new Map),h=i.get(c.config.render_layer),l=null===(n=null===(_=null===(e=c.shaped_sprite)||void 0===e?void 0:e.sprite)||void 0===_?void 0:_.sprite)||void 0===n?void 0:n.path,h.has(l)||h.set(l,[]),h.get(l).push(c));return E=[],i.forEach((function(t,e){return E.push({rl:e,v:t})})),E.sort((function(t,e){return t.rl-e.rl})),E.forEach((function(t){return t.v.forEach((function(t,e){return o.Z.get(e).draw(t)}))})),[2]}))},new((a=void 0)||(a=Promise))((function(t,e){function _(t){try{o(s.next(t))}catch(t){e(t)}}function n(t){try{o(s.throw(t))}catch(t){e(t)}}function o(e){var i;e.done?t(e.value):(i=e.value,i instanceof a?i:new a((function(t){t(i)}))).then(_,n)}o((s=s.apply(i,r||[])).next())}))},t}()},334:(t,e,_)=>{_.d(e,{FX:()=>c,hP:()=>d,b2:()=>M});var n,i=_(869),r=_(566),o=_(822),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var _ in e)Object.prototype.hasOwnProperty.call(e,_)&&(t[_]=e[_])})(t,e)},function(t,e){function _(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(_.prototype=e.prototype,new _)}),s=function(){for(var t=0,e=0,_=arguments.length;e<_;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<_;e++)for(var r=arguments[e],o=0,a=r.length;o<a;o++,i++)n[i]=r[o];return n},u=function(){},p=function(t){function e(e){var _=t.call(this)||this;return _.remain=e,_}return a(e,t),e.prototype.update=function(t){return this.remain-=t,this.remain<0?-this.remain:0},e}(u),c=function(t){function e(e){var _=t.call(this)||this;return _.time=0,_.init=e,_}return a(e,t),e.random=function(t,_){return new e((function(e){var n=Math.max(_.px0-t.px,-_.dx1),i=Math.min(_.px1-t.px,_.dx1),r=Math.max(_.py0-t.py,-_.dy1),o=Math.min(_.py1-t.py,_.dy1),a=n+Math.random()*(i-n),s=r+Math.random()*(o-r);e.target=t,e.duration=_.duration,e.dx=a,e.dy=s,e.x0=t.px,e.y0=t.py,e.ease=_.ease}))},e.prototype.update=function(t){0==this.time&&this.init(this),this.time+=t;var e=Math.min(1,this.time/this.duration),_=this.ease(e);return this.target.px=this.x0+this.dx*_,this.target.py=this.y0+this.dy*_,this.time>this.duration?this.time-this.duration:0},e}(u),h=function(t){function e(e){var _=t.call(this)||this;return _.todo=e,_}return a(e,t),e.prototype.update=function(t){return this.todo(),t},e}(u),l=function(){};function E(t){return t.map((function(t){return"number"==typeof t?new p(t):"function"==typeof t?new h(t):t}))}var d=function(t){function e(e,_){var n=t.call(this)||this;return n.index=0,n.todo=e,n.total=_,n}return a(e,t),e.prototype.supply=function(){return this.index>=this.total?null:(t="function"==typeof this.todo?this.todo(this.index):this.todo,this.index++,E(t));var t},e}(l),f={render_layer:i.NH,collide_group:i.T7,collide_mask:i.Io},M=function(t){function e(e){var _=t.call(this)||this;return _.config=f,_.state=i.ZM.PRE_ENTRY,_.time=0,_.list=E(e),_}return a(e,t),e.prototype.update=function(t){this.state==i.ZM.PRE_ENTRY&&(this.state=i.ZM.ALIVE);var e=o.n.INSTANCE.special_effects.time_rate;for(this.time+=e;this.list.length>0&&e;){var _=this.list[0];if(_ instanceof l){var n=_.supply();n&&n.length?this.list=s(n,this.list):this.list.shift()}else(e=_.update(e))>0&&this.list.shift()}0==this.list.length&&(this.state=i.ZM.LEAVING)},e.prototype.postUpdate=function(t){this.state==i.ZM.LEAVING&&(this.state=i.ZM.DEAD)},e.prototype.attack=function(t){},e.prototype.damaged=function(t,e){return!1},e}(r.u5)},176:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{S:()=>init});var _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(651),_entity_SelfMachine__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(533),_stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(334),_util_SpriteManager__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(68),_util_sprites__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(940),_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(583),_stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(822),_entity_Entity__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(869),_entity_RayLaser__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(296),_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(799),__awaiter=function(t,e,_,n){return new(_||(_=Promise))((function(i,r){function o(t){try{s(n.next(t))}catch(t){r(t)}}function a(t){try{s(n.throw(t))}catch(t){r(t)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof _?e:new _((function(t){t(e)}))).then(o,a)}s((n=n.apply(t,e||[])).next())}))},__generator=function(t,e){var _,n,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(_)throw new TypeError("Generator is already executing.");for(;o;)try{if(_=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,n=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=e.call(t,o)}catch(t){r=[6,t],n=0}finally{_=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},sm_proto={updateShoot:function(t){return!1},updateBomb:function(t){return!1},updateSpecial:function(t){return!1}},sm_abi={pre_miss:30,miss_time:60,bomb_time:60},repeat=function(t,e){return void 0===e&&(e=1/0),new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.hP(t,e)},nonblock=function(t){return function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2(t))}},selected_stage=null,stage_000=function(t){var e=_util_sprites__WEBPACK_IMPORTED_MODULE_4__.hZ(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.Dp.Oval,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.C8.Red,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.fz.Overlay),_=_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(e,1);return new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([30*t,repeat((function(e){return[repeat((function(n){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(_,_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0).simpleInit(0,0,8/t,.003/t*e*e+2*Math.PI/5*n))}]}),5),1*t]}),1/0)])},stage_001=function(t){var e=function(t){return _util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.e8(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qb.Scale,t,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.fz.Overlay),1)},_=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0);_.life=180*t,_.kill_on_exit=!1;var n={duration:100*t,px0:-96,px1:96,py0:32,py1:112,dx1:64,dy1:64,ease:function(t){return(1-Math.cos(Math.PI*t))/2}},i=1*t,r=3/t,o=-r/70,a=.06/t,s=new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.cI,2),_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0).setMotion((function(t){return t.dir=t.time*Math.PI*2/600,!1})).simpleInit(0,64,0,0),u=null,p=function(t,e,n,p){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([repeat((function(c){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(u=new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(null,_).simpleInit(s.px,s.py,r,2*Math.PI/47*c*e*t))},repeat((function(e){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(c%2==0?n:p,_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0).setMotion((_=u,i=2*Math.PI/30*e,r=a*t,70,s=o,function(t,e){var n=i+r*t.time,o=70*Math.sin(s*t.time);return t.px=_.px+o*Math.cos(n),t.py=_.py+o*Math.sin(n),t.dir=Math.atan2(o*r,70*s*Math.cos(s*t.time))+n,!1})));var _,i,r,s}]}),30),i]}),47)]))};return new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(s)},30*t,repeat((function(_){return[function(){return p(_%2*2-1,7,e(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Red),e(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Green))},50*t,function(){return p(_%2*2-1,5,e(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Yellow),e(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Blue))},50*t,function(){return p(_%2*2-1,1,e(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Cyan),e(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Pink))},_stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.FX.random(s,n)]}))])},test_000=function(t){var e=function(t,e,_){return _util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.iW(t,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Red,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.C8.Red,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.fz.AddBlend,e,_,1)},_=[e(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.u3.Laser,0,0),e(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.u3.Laser,1,1),e(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.u3.Laser,0,1),e(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.u3.Laser,1,0),e(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.u3.Grain,0,0),e(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.u3.Grain,1,1),e(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.u3.Grain,0,1),e(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.u3.Grain,1,0),e(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.u3.Scale,0,0),e(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.u3.Scale,1,0)],n={render_layer:_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0.render_layer,collide_group:_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0.collide_group,collide_mask:_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0.collide_mask,warning_time:30*t,open_time:10*t,alive_time:6e3*t,close_time:10*t,listener:null},i=0*Math.PI*2/240/t;return new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([30*t,repeat((function(e){return[repeat((function(t){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _entity_RayLaser__WEBPACK_IMPORTED_MODULE_8__.Fu(_[t],n,(r=i*(e%2*2-1),function(t,e){return t.dir+=e*r})).init(50*Math.cos(2*Math.PI/10*t),50*Math.sin(2*Math.PI/10*t),2*Math.PI/10*t,100));var r}]}),10),6e3*t]}))])},stage_002=function(t){var e=_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.p3(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Red,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.fz.Overlay,64),_=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0);_.auto_direction=!1;var n={duration:50*t,px0:-96,px1:96,py0:32,py1:112,dx1:64,dy1:64,ease:function(t){return(1-Math.cos(Math.PI*t))/2}},i=new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.cI,2),_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0).setMotion((function(t){return t.dir=t.time*Math.PI*2/600,!1})).simpleInit(0,64,0,0),r=function(t){return repeat((function(n){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(e,_).setMotion((function(e,_){return e.dir+=_*t,!0})).simpleInit(i.px,i.py,u,p+2*Math.PI/o*n).init((function(t){return t.dir+=2*Math.PI*a/o*n})))}]}),o)},o=50,a=2.5,s=2*Math.PI/60/t,u=6/t,p=0;return new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(i)},30*t,repeat((function(e){return[function(){return p=Math.random()*Math.PI*2},r(s),20*t,r(-s),_stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.FX.random(i,n)]}))])},stage_003=function(t){var e=_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.e8(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qb.Grain,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Red,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.fz.Overlay),1),_=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0);_.listener=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.Fe);var n=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.wv);n.max=100,(0,_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.cf)(n)(_.listener);var i=Math.PI/24,r=6/t,o=100*t,a=1*t,s=1*t,u={duration:o-40*s-20*a,px0:-96,px1:96,py0:32,py1:112,dx1:64,dy1:64,ease:function(t){return(1-Math.cos(Math.PI*t))/2}},p=new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.cI,2),_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0).setMotion((function(t){return t.dir=t.time*Math.PI*2/600,!1})).simpleInit(0,64,0,0),c=0;return new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(p)},30*t,repeat((function(t){return[function(){return c=Math.random()*Math.PI*2},repeat((function(t){return[nonblock([repeat((function(u){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(e,_).setMotion((function(e,_){var a=o-t*s;return e.time-_<a&&e.time>=a&&((0,_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.DP)(n)(e),e.simpleInit(e.px,e.py,r,e.dir+(2*Math.random()-1)*i)),!0})).simpleInit(p.px,p.py,r,c+2*Math.PI/40*t))},a]}),20)]),s]}),40),20*a,_stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.FX.random(p,u)]}))])},stage_004=function(t){var e=[_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.e8(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qb.Grain,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Red,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.fz.Overlay),1),_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.e8(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qb.Grain,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Blue,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.fz.Overlay),1)],_=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0),n=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0);_.listener=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.Fe),n.listener=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.Fe);var i=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.wv),r=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.wv);i.max=2,i.h0=-1/0,r.max=1,r.h0=-1/0,(0,_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.cf)(i)(_.listener),(0,_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.cf)(r)(n.listener);var o=6/t,a=1*t,s=3*t,u={duration:40*t,px0:-96,px1:96,py0:32,py1:112,dx1:64,dy1:64,ease:function(t){return(1-Math.cos(Math.PI*t))/2}},p=new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.cI,2),_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0).setMotion((function(t){return t.dir=t.time*Math.PI*2/600,!1})).simpleInit(0,64,0,0),c=0,h=function(t,e,_,n){return repeat((function(i){return[nonblock([repeat((function(r){return[repeat((function(a){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(t,n).simpleInit(p.px,p.py,o,c+_*Math.PI*2*(i/8/4+a/4+r/4/8/e*.5)))}]}),8),a]}),e)]),s]}),8)};return new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(p)},30*t,repeat((function(t){return[function(){return c=Math.random()*Math.PI*2},h(e[0],10,1,_),10*a,_stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.FX.random(p,u),h(e[1],15,-1,n),20*a,_stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.FX.random(p,u)]}))])},stage_005=function(t){var e=_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.iW(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.u3.Grain,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Blue,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.C8.Blue,_util_sprites__WEBPACK_IMPORTED_MODULE_4__.fz.AddBlend,1,1,.75),_={render_layer:_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0.render_layer,collide_group:_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0.collide_group,collide_mask:_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0.collide_mask,warning_time:0,open_time:0,alive_time:1/0,close_time:0,listener:null},n=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_);_.listener=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.VN);var i=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.zA);i.max=2,i.v=8/t,i.maxlen=128,i.body=e,i.cf=n,(0,_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.so)(i)(_.listener);var r=2*Math.random()*Math.PI;return new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([30*t,repeat((function(n){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _entity_RayLaser__WEBPACK_IMPORTED_MODULE_8__.Fu(e,_,null).init(0,0,r+2*Math.PI*.0234*n,0))},3*t]}))])};selected_stage=stage_005;var sinit={load_sprite:function(){return _util_SpriteManager__WEBPACK_IMPORTED_MODULE_3__.Z.get(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.Xp.path).load()},add_player:function(){return new _entity_SelfMachine__WEBPACK_IMPORTED_MODULE_1__.U(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.a_,1),sm_proto,sm_abi,0,-192)},add_schedule:selected_stage};function init(){return __awaiter(this,void 0,void 0,(function(){var pool;return __generator(this,(function(_a){switch(_a.label){case 0:return[4,sinit.load_sprite()];case 1:return _a.sent(),pool=new _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n,pool.add(sinit.add_player()),pool.add(sinit.add_schedule(3)),eval("window.debug_info.pool = pool"),[2]}}))}))}},566:(t,e,_)=>{_.d(e,{bn:()=>a,D8:()=>u,HC:()=>p,Yw:()=>c,hE:()=>h,eY:()=>l,u5:()=>E,_R:()=>d});var n,i,r=_(68),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var _ in e)Object.prototype.hasOwnProperty.call(e,_)&&(t[_]=e[_])})(t,e)},function(t,e){function _(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(_.prototype=e.prototype,new _)}),a=function(){},s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(a),u=function(t){function e(e){var _=t.call(this)||this;return _.radius=e,_}return o(e,t),e.prototype.exitScreen=function(t,e,_){var n=Math.sqrt(Math.pow(t.shaped_sprite.w,2)+Math.pow(t.shaped_sprite.h,2));return Math.abs(t.px)>e+n*t.magn||Math.abs(t.py)>_+n*t.magn},e.prototype.distanceTo=function(t,e,_){return Math.sqrt(Math.pow(e-t.px,2)+Math.pow(_-t.py,2))-this.radius*t.magn},e.prototype.rawDistanceTo=function(t,e,_,n,i){return Math.sqrt(Math.pow(n-t,2)+Math.pow(i-e,2))-this.radius*_},e.prototype.rawExitScreen=function(t,e,_,n,i){var r=Math.sqrt(Math.pow(_.w,2)+Math.pow(_.h,2));return Math.abs(t)>n+r||Math.abs(e)>i+r},e}(s),p=function(t){function e(e,_){var n=t.call(this)||this;return n.len=e,n.rad=_,n}return o(e,t),e.orthDis=function(t,e,_,n){var i=n/2;t=Math.abs(t);var r=_*_/i/2+i/2-i;return(e=Math.abs(e))>=0&&_*(e+r)>t*r?Math.sqrt(Math.pow(t,2)+Math.pow(e+r,2))-r-i:Math.sqrt(Math.pow(t-_,2)+Math.pow(e,2))-i},e.prototype.exitScreen=function(t,e,_){var n=Math.sqrt(Math.pow(t.shaped_sprite.w,2)+Math.pow(t.shaped_sprite.h,2));return Math.abs(t.px)>e+n*t.magn||Math.abs(t.py)>_+n*t.magn},e.prototype.distanceTo=function(t,_,n){var i=_-t.px,r=n-t.py,o=i*Math.cos(-t.dir)-r*Math.sin(-t.dir),a=i*Math.sin(-t.dir)+r*Math.cos(-t.dir);return e.orthDis(o,a,this.len/2*t.magn,this.rad*t.magn)},e}(s),c=function(){},h=(o((function(){return null!==i&&i.apply(this,arguments)||this}),i=c),function(){function t(t,e){this.collideCheck=null,this.renderType=t,this.shaped_sprite=e}return t.prototype.distanceTo=function(t,e){var _;return(null===(_=this.shaped_sprite)||void 0===_?void 0:_.shape)?this.shaped_sprite.shape.distanceTo(this,t,e):1/0},t}()),l=function(t){function e(e){var _=t.call(this,r.I.RECT,e)||this;return _.magn=1,_.alpha=1,_}return o(e,t),e.prototype.rectCount=function(){return 1},e.prototype.render=function(t,e){t[10*e+0]=this.px,t[10*e+1]=this.py,t[10*e+2]=this.dir+Math.PI/2,t[10*e+3]=this.shaped_sprite.w/2*this.magn,t[10*e+4]=this.shaped_sprite.h/2*this.magn;var _=this.shaped_sprite.sprite;t[10*e+5]=_.tx/_.sprite.w,t[10*e+6]=_.ty/_.sprite.h,t[10*e+7]=_.tw/_.sprite.w,t[10*e+8]=_.th/_.sprite.h,t[10*e+9]=this.alpha},e}(h),E=function(t){function e(){return t.call(this,null,null)||this}return o(e,t),e}(h);function d(t,e){if(t.collideCheck)return t.collideCheck(e);if(e.collideCheck)return e.collideCheck(t);if(t instanceof l&&t.shaped_sprite.shape instanceof u)return e.distanceTo(t.px,t.py)<t.shaped_sprite.shape.radius;if(e instanceof l&&e.shaped_sprite.shape instanceof u)return d(e,t);throw new Error("non-circle non-circle collision not found")}},68:(t,e,_)=>{_.d(e,{I:()=>n,Z:()=>o});var n,i=_(924),r=_(940);!function(t){t[t.RECT=0]="RECT",t[t.STRIP=1]="STRIP"}(n||(n={}));var o=function(){function t(t){this.img=null,this.path=t}return t.prototype.loaded=function(){return this.img},t.prototype.load=function(){return t=this,e=void 0,n=function(){var t;return function(t,e){var _,n,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(_)throw new TypeError("Generator is already executing.");for(;o;)try{if(_=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,n=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=e.call(t,o)}catch(t){r=[6,t],n=0}finally{_=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}}(this,(function(e){switch(e.label){case 0:return[4,i.po(this.path)];case 1:return t=e.sent(),this.img=i.yG(t),[2]}}))},new((_=void 0)||(_=Promise))((function(i,r){function o(t){try{s(n.next(t))}catch(t){r(t)}}function a(t){try{s(n.throw(t))}catch(t){r(t)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof _?e:new _((function(t){t(e)}))).then(o,a)}s((n=n.apply(t,e||[])).next())}));var t,e,_,n},t.get=function(e){return t.INS[e]?t.INS[e]:t.INS[e]=new t(e)},t.prototype.draw=function(t){this.drawRect(t,r.fz.Overlay),this.drawRect(t,r.fz.AddBlend);for(var e=0,_=t;e<_.length;e++){var o=_[e];if(o.renderType==n.STRIP)for(var a=o,s=a.getSprite(),u=s.sprite,p=0,c=a.render();p<c.length;p++){var h=c[p];i.AJ(h,s.w,h.length/2,u.tx,u.ty,u.tw,u.th,this.img)}}},t.prototype.drawRect=function(t,e){var _=t.reduce((function(t,_){return _.renderType==n.RECT&&_.shaped_sprite.sprite.mode==e?t+_.rectCount():t}),0);if(_){i.PM(e);for(var r=new Float32Array(10*_),o=0,a=0,s=t;a<s.length;a++){var u=s[a];if(u.renderType==n.RECT&&u.shaped_sprite.sprite.mode==e){var p=u;p.render(r,o),o+=p.rectCount()}}i.bn(r,_,this.img)}},t.INS={},t}()},583:(t,e,_)=>{_.d(e,{u3:()=>n,xg:()=>p,p3:()=>c,iW:()=>h});var n,i=_(296),r=_(566),o=_(68),a=_(940);!function(t){t[t.Laser=0]="Laser",t[t.Scale=1]="Scale",t[t.Grain=4]="Grain"}(n||(n={}));var s=[[1.4,0],[2.4,2.4,4,4,2.4,2.4,2.4,2.8,2.4,2.4,4,2.4,2.4,2.4,2.4,2.4],[6,7,8.5,7,6,7,0,10],[14,14]],u=.75;function p(t,e){return e*=u,{sprite:t,shape:new r.D8(s[t.category][t.type]*e),w:t.tw*e,h:t.th*e,renderType:o.I.RECT}}function c(t,e,_){var n=(0,a.e8)(a.qb.Grain,t,e);return{sprite:n,shape:new r.HC(_,s[a.WD.Small][a.qb.Grain]*u),renderType:o.I.RECT,w:n.tw*u,h:1.25*_}}function h(t,e,_,r,s,c,h){var l=(0,a.e8)(t,e,r);return l.ty+=t==n.Laser?4:t==n.Grain||t==n.Scale?1:NaN,l.th-=t==n.Laser?8:t==n.Grain?2:t==n.Scale?1:NaN,{sprite:l,shape:new i.cE(t==n.Laser?i.cE.line_circle:t==n.Scale?i.cE.half_arc:t==n.Grain?i.cE.double_arc:null),renderType:o.I.RECT,sprite_width:l.tw*u/2*h,hitbox_width:2.4*u*h,l_ratio:t==n.Laser||c>0?1:t==n.Grain?1.15:t==n.Scale?1.2:NaN,base:p((0,a.hZ)(a.Dp.Light,_,r),s*h),end:p((0,a.hZ)(a.Dp.Light,_,r),c*h)}}},940:(t,e,_)=>{var n,i,r,o,a,s,u,p;_.d(e,{fz:()=>n,WD:()=>i,qO:()=>r,qb:()=>o,C8:()=>a,Dp:()=>s,Xp:()=>E,e8:()=>d,hZ:()=>f,a_:()=>M,cI:()=>P}),function(t){t[t.Overlay=0]="Overlay",t[t.AddBlend=1]="AddBlend"}(n||(n={})),function(t){t[t.Special=0]="Special",t[t.Small=1]="Small",t[t.Medium=2]="Medium",t[t.Large=3]="Large"}(i||(i={})),function(t){t[t.Grey=0]="Grey",t[t.RedX=1]="RedX",t[t.Red=2]="Red",t[t.PinkX=3]="PinkX",t[t.Pink=4]="Pink",t[t.BlueX=5]="BlueX",t[t.Blue=6]="Blue",t[t.CyanX=7]="CyanX",t[t.Cyan=8]="Cyan",t[t.GreenX=9]="GreenX",t[t.Green=10]="Green",t[t.Lemon=11]="Lemon",t[t.YellowX=12]="YellowX",t[t.Yellow=13]="Yellow",t[t.Orange=14]="Orange",t[t.White=15]="White"}(r||(r={})),function(t){t[t.Laser=0]="Laser",t[t.Scale=1]="Scale",t[t.Ring=2]="Ring",t[t.Ball=3]="Ball",t[t.Grain=4]="Grain",t[t.Niddle=5]="Niddle",t[t.Knife=6]="Knife",t[t.Spell=7]="Spell",t[t.Bullet=8]="Bullet",t[t.Germ=9]="Germ",t[t.Star=10]="Star",t[t.Planet=11]="Planet",t[t.S_Cross=12]="S_Cross",t[t.S_Ball=13]="S_Ball",t[t.Curve=14]="Curve",t[t.Drop=15]="Drop"}(o||(o={})),function(t){t[t.Grey=0]="Grey",t[t.Red=1]="Red",t[t.Pink=2]="Pink",t[t.Blue=3]="Blue",t[t.Cyan=4]="Cyan",t[t.Green=5]="Green",t[t.Yellow=6]="Yellow",t[t.White=7]="White"}(a||(a={})),function(t){t[t.Light=0]="Light",t[t.Star=1]="Star",t[t.Ball=2]="Ball",t[t.Butterfly=3]="Butterfly",t[t.Knife=4]="Knife",t[t.Oval=5]="Oval",t[t.LightX=6]="LightX",t[t.Heart=7]="Heart"}(s||(s={})),function(t){t[t.Red=0]="Red",t[t.Blue=1]="Blue",t[t.Green=2]="Green",t[t.Yellow=3]="Yellow"}(u||(u={})),function(t){t[t.Ball=0]="Ball",t[t.Rose=1]="Rose"}(p||(p={}));var c=[0,0,1,1,0,0,0,0,0,1,1,1,1,0,0],h=[1,1,1,0,0,0,1,0],l=2*Math.PI/600,E={path:"assets/bullet_000.png",w:516,h:772};function d(t,e,_){return{sprite:E,tx:t<12?1+16*e:t<14?1+e%8*8:t<15?1:258+16*e,ty:t<12?1+16*t:t<14?(t<13?193:241)+8*(e>>3):e<15?515+16*e:449,tw:t<12?16:t<14?8:t<15?256:16,th:t<12?16:t<14?8:16,mode:_,category:i.Small,type:t,color:e,omega:c[t]*l}}function f(t,e,_){return{sprite:E,tx:(t<7?1:258)+32*e,ty:0==t?209:t<7?226+32*t:257,tw:32,th:32,mode:_,category:i.Medium,type:t,color:e,omega:h[t]*l}}var M={sprite:E,tx:258,ty:17,tw:64,th:64,mode:n.Overlay,category:i.Special,type:0,color:0,omega:l},P=(n.Overlay,i.Special,{sprite:E,tx:386,ty:81,tw:128,th:128,mode:n.Overlay,category:i.Special,type:2,color:0,omega:l})},924:(t,e,_)=>{_.d(e,{cY:()=>o,PM:()=>a,po:()=>s,yG:()=>p,ZH:()=>c,bn:()=>M,AJ:()=>P});var n=_(349),i=_(940);const r={gl:null,shader:{program:0,attribute:{coord:0,tex:0,alpha:0},uniform:{uSampler:0}}};function o(){var t=document.getElementById("glcanvas"),e=t.getContext("webgl");if(null===e)return void alert("Unable to initialize WebGL. Your browser or machine may not support it.");r.gl=e;var _=e.createShader(e.VERTEX_SHADER),n=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(_,"\nattribute vec2 coord;\nattribute vec2 tex;\nattribute float alpha;\nvarying highp vec2 vTexCoord;\nvarying highp float vTexAlpha;\nvoid main() {\n    gl_Position = vec4(coord, 0.0, 1.0);\n    vTexCoord = tex;\n    vTexAlpha = alpha;\n}\n"),e.shaderSource(n,"\nprecision highp float;\nvarying highp vec2 vTexCoord;\nvarying highp float vTexAlpha;\nuniform sampler2D uSampler;\nvoid main() {\n    vec4 col = texture2D(uSampler, vTexCoord);\n    col.a *= vTexAlpha;\n    col.rgb *= col.a;\n    gl_FragColor = col;\n}\n"),e.compileShader(_),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS)){var i=e.getShaderInfoLog(n);return void console.log(i)}var o=e.createProgram();e.attachShader(o,_),e.attachShader(o,n),e.linkProgram(o),e.useProgram(o);const a=r.shader;a.program=o,a.attribute.coord=e.getAttribLocation(o,"coord"),a.attribute.tex=e.getAttribLocation(o,"tex"),a.attribute.alpha=e.getAttribLocation(o,"alpha"),a.uniform.uSampler=e.getUniformLocation(o,"uSampler"),e.enable(e.BLEND),e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA),e.disable(e.DEPTH_TEST),e.viewport(0,0,t.width,t.height)}function a(t){const e=r.gl;t==i.fz.Overlay?e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA):t==i.fz.AddBlend&&e.blendFuncSeparate(e.ONE,e.ONE,e.ONE,e.ONE_MINUS_SRC_ALPHA)}function s(t){return new Promise(((e,_)=>{let n=new Image;n.onload=()=>e(n),n.onerror=_,n.src=t}))}function u(t,e,_,n,i){const o=r.gl,a=o.createBuffer(),s=r.shader.attribute.coord;o.bindBuffer(o.ARRAY_BUFFER,a),o.bufferData(o.ARRAY_BUFFER,t,o.STATIC_DRAW),o.vertexAttribPointer(s,2,o.FLOAT,!1,0,0),o.enableVertexAttribArray(s);const u=o.createBuffer(),p=r.shader.attribute.tex;o.bindBuffer(o.ARRAY_BUFFER,u),o.bufferData(o.ARRAY_BUFFER,e,o.STATIC_DRAW),o.vertexAttribPointer(p,2,o.FLOAT,!1,0,0),o.enableVertexAttribArray(p);const c=o.createBuffer(),h=r.shader.attribute.alpha;o.bindBuffer(o.ARRAY_BUFFER,c),o.bufferData(o.ARRAY_BUFFER,_,o.STATIC_DRAW),o.vertexAttribPointer(h,1,o.FLOAT,!1,0,0),o.enableVertexAttribArray(h),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,n),o.uniform1i(r.shader.uniform.uSampler,0),o.drawArrays(o.TRIANGLES,0,i)}function p(t){const e=r.gl,_=e.createTexture();return e.bindTexture(e.TEXTURE_2D,_),e.bindTexture(e.TEXTURE_2D,_),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_SHORT_4_4_4_4,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),_}function c(){const t=r.gl;t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT),t.clearColor(0,0,1,1)}const h=[-1,-1,1,-1,1,1],l=[-1,1,1,-1,-1,1],E=[0,0,1,0,1,1],d=[0,1,1,0,0,1];function f(t){for(var e=0;e<t.length/2;e++)t[2*e]=(0,n.OK)(t[2*e]),t[2*e+1]=(0,n.ZA)(t[2*e+1])}function M(t,e,_){const n=new Float32Array(12*e),i=new Float32Array(12*e),r=new Float32Array(6*e);Math.PI;for(var o=0;o<e;o++)for(var a=0;a<6;a++){const e=t[10*o+2],_=t[10*o+3]*h[a],s=t[10*o+4]*l[a];n[12*o+2*a+0]=t[10*o+0]+_*Math.cos(e)-s*Math.sin(e),n[12*o+2*a+1]=t[10*o+1]+_*Math.sin(e)+s*Math.cos(e),i[12*o+2*a+0]=t[10*o+5]+E[a]*t[10*o+7],i[12*o+2*a+1]=t[10*o+6]+d[a]*t[10*o+8],r[6*o+a]=t[10*o+9]}f(n),u(n,i,r,_,6*e)}function P(t,e,_,n,i,o,a,s){const u=new Float32Array(6*_),p=new Float32Array(_),c=new Float32Array(6*_),h=new Int16Array(2*(_-1));for(var l=0,E=0;E<_-1;E++){const _=t[2*E],n=t[2*E+1],i=t[2*E+2],r=t[2*E+3],o=(_+i)/2,a=(n+r)/2,s=Math.sqrt((i-_)*(i-_)+(r-n)*(r-n));p[E]=s,l+=s,u[6*E+0]=_,u[6*E+1]=n,u[6*E+2]=o-(a-n)/s*e,u[6*E+3]=a+(o-_)/s*e,u[6*E+4]=o+(a-n)/s*e,u[6*E+5]=a-(o-_)/s*e}f(u),l-=p[0]/2+p[_-1]/2;var d=-p[0]/2;for(E=1;E<_;E++)c[6*E+0]=n+o*d/l,c[6*E+1]=i+a/2,d+=p[E]/2,c[6*E+2]=n+o*d/l,c[6*E+3]=i,c[6*E+4]=n+o*d/l,c[6*E+5]=i+a,d+=p[E]/2;for(E=0;E<_-1;E++)h[2*E+0]=3*E+1,h[2*E+1]=3*E+3;h[2*_-3]--;const M=r.gl,P=M.createBuffer(),y=r.shader.attribute.coord;M.bindBuffer(M.ARRAY_BUFFER,P),M.bufferData(M.ARRAY_BUFFER,u,M.STATIC_DRAW),M.vertexAttribPointer(y,2,M.FLOAT,!1,0,0),M.enableVertexAttribArray(y);const v=M.createBuffer(),D=r.shader.attribute.tex;M.bindBuffer(M.ARRAY_BUFFER,v),M.bufferData(M.ARRAY_BUFFER,c,M.STATIC_DRAW),M.vertexAttribPointer(D,2,M.FLOAT,!1,0,0),M.enableVertexAttribArray(D),M.activeTexture(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,s),M.uniform1i(r.shader.uniform.uSampler,0);const O=M.createBuffer();for(M.bindBuffer(M.ELEMENT_ARRAY_BUFFER,O),M.bufferData(M.ELEMENT_ARRAY_BUFFER,h,M.STATIC_DRAW),M.drawElements(M.TRIANGLE_STRIP,2*_-2,M.UNSIGNED_SHORT,0),E=0;E<_-1;E++)h[2*E+0]=3*E,h[2*E+1]=3*E+2;h[0]++,M.bufferData(M.ELEMENT_ARRAY_BUFFER,h,M.STATIC_DRAW),M.drawElements(M.TRIANGLE_STRIP,2*_-2,M.UNSIGNED_SHORT,0)}window.debug_info={},window.debug_info.global_gl=r,window.debug_info.gl_func={setup:o,clear:c,draw:u,drawStrip:function(t,e,_,n,i){const o=r.gl,a=o.createBuffer(),s=r.shader.attribute.coord;o.bindBuffer(o.ARRAY_BUFFER,a),o.bufferData(o.ARRAY_BUFFER,t,o.STATIC_DRAW),o.vertexAttribPointer(s,2,o.FLOAT,!1,0,0),o.enableVertexAttribArray(s);const u=o.createBuffer(),p=r.shader.attribute.tex;o.bindBuffer(o.ARRAY_BUFFER,u),o.bufferData(o.ARRAY_BUFFER,e,o.STATIC_DRAW),o.vertexAttribPointer(p,2,o.FLOAT,!1,0,0),o.enableVertexAttribArray(p);const c=o.createBuffer();o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,c),o.bufferData(o.ELEMENT_ARRAY_BUFFER,_,o.STATIC_DRAW),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,n),o.uniform1i(r.shader.uniform.uSampler,0),o.drawElements(o.TRIANGLE_STRIP,i,o.UNSIGNED_SHORT,0)},drawRects:M,drawSnake:P}}},__webpack_module_cache__={};function __webpack_require__(t){if(__webpack_module_cache__[t])return __webpack_module_cache__[t].exports;var e=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](e,e.exports,__webpack_require__),e.exports}__webpack_require__.d=(t,e)=>{for(var _ in e)__webpack_require__.o(e,_)&&!__webpack_require__.o(t,_)&&Object.defineProperty(t,_,{enumerable:!0,get:e[_]})},__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t={};__webpack_require__.r(t),__webpack_require__.d(t,{KEY_CLICK:()=>g,KEY_PRESS:()=>w,canvas_height:()=>l,canvas_width:()=>h,devicePixelRatio:()=>M,keys:()=>O,last_update_rate:()=>P,mainloop_start:()=>m,mainloop_terminate:()=>T,mouse:()=>D,setup_canvas:()=>A,test_fps:()=>y});var e=__webpack_require__(176),_=__webpack_require__(924),n=__webpack_require__(822),i=__webpack_require__(533),r=__webpack_require__(349),o=!1,a=!1,s=0,u=0,p=0,c=0;var h,l,E=0,d=0,f=null,M=1,P=1;function y(){return E=performance.now(),d=241,v(),new Promise(((t,e)=>{f=t}))}function v(){if(--d)requestAnimationFrame(v);else{var t=(performance.now()-E)/240;P=Math.round(t/(1e3/60)),f(P)}}var D={x:0,y:0},O={};function A(){document.onmousemove=t=>{D.x=t.pageX,D.y=t.pageY},document.ontouchstart=t=>{O._touch=3,D.x=t.pageX,D.y=t.pageY,t.preventDefault()},document.ontouchend=t=>{O._touch=1,D.x=t.pageX,D.y=t.pageY,t.preventDefault()},document.ontouchmove=t=>{D.x=t.pageX,D.y=t.pageY,t.preventDefault()},document.onmousedown=t=>{O._press=3},document.onmouseup=t=>{O._press=1},document.addEventListener("keydown",(t=>{var e=t.key;1==e.length&&(e=e.toLowerCase()),O[e]=3}),!1),document.addEventListener("keyup",(t=>{var e=t.key;1==e.length&&(e=e.toLowerCase()),O[e]=1}),!1);var t=window.innerWidth,e=window.innerHeight,n=.95*Math.min(t/r.Fy,e/r.bE),i=document.getElementById("glcanvas");h=n*r.Fy,l=n*r.bE,i.style.width=h+"px",i.style.height=l+"px",M=window.devicePixelRatio||1,i.width=h*M,i.height=l*M,_.cY()}var R=!1;function m(){R||(R=!0,I())}function T(){R=!1}function I(){!function(){var t=n.n.INSTANCE;if(t){var e=function(){if(O.Escape==g&&(o=!o),o)return a=!1,null;var t=0,e=0;O.Shift>=w||O._touch>=w||O._press>=w?(a||(a=!0,s=D.x,u=D.y,p=0,c=0),t=D.x-s-p,e=D.y-u-c,p+=t,c+=e):a=!1,t=t/h*r.Fy*2,e=-e/l*r.bE*2;var _=O.Shift>=w?2:3;return(O.w>=w||O.ArrowUp>=w)&&(e+=_),(O.s>=w||O.ArrowDown>=w)&&(e-=_),(O.a>=w||O.ArrowLeft>=w)&&(t-=_),(O.d>=w||O.ArrowRight>=w)&&(t+=_),{pos_x:t,pos_y:e,key_z:O.z>=w,key_x:O.x==g,key_c:O.c==g}}();if(!o&&(i.U.updateState(e),!o))for(var E=0;E<P;E++)t.update();_.ZH(),t.render()}}(),function(){for(var t in O)3==O[t]&&(O[t]=2),1==O[t]&&(O[t]=0)}(),R&&requestAnimationFrame(I)}const w=2,g=3;window.onload=async function(){y(),A(),await e.S(),m(),window.debug_info.stg={fps:y,init:e.S,start:m,terminate:T},window.debug_info.platform=t}})()})();