(()=>{var __webpack_modules__={349:(t,e,n)=>{"use strict";n.d(e,{SH:()=>i,ZP:()=>r,Fy:()=>_,bE:()=>o,OK:()=>a,ZA:()=>s,io:()=>p,ax:()=>c});var i=192,r=224,_=360,o=240;function a(t){return t/_}function s(t){return t/o}var u=1/64;function p(t){t.rect([-i,-r,2*i,2*r],u)}function c(t){var e=function(e){return t.rect(e,u)};e([-i,o-16,2*i,16]),e([-i,-o,2*i,16]),e([-_,-o,_-i,2*o]),e([i,-o,_-i,2*o])}},780:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{l:()=>GLHelper});var _gl__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(924),_Screen__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(349),__spreadArrays=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var _=arguments[e],o=0,a=_.length;o<a;o++,r++)i[r]=_[o];return i},GLHelper=function(){function GLHelper(){this.ver=[],this.tex=[],this.alp=[],this.n=0}return GLHelper.prototype.bind=function(t){this.img=t},GLHelper.prototype.rect=function(t,e){var n,i,r=t[0],_=t[1],o=t[2],a=t[3],s=[r,_,r,_+a,r+o,_,r,_+a,r+o,_,r+o,_+a];(n=this.ver).push.apply(n,s),(i=this.tex).push.apply(i,s.map((function(t){return t*e}))),this.alp.push(1,1,1,1,1,1),this.n+=6},GLHelper.prototype.fan=function(_a,n){for(var _b,_c,da=_a[0],oa=_a[1],ox=_a[2],oy=_a[3],or=_a[4],ta=_a[5],tx=_a[6],ty=_a[7],trw=_a[8],trh=_a[9],alpha=_a[10],num=Math.ceil(Math.abs(da)/(2*Math.PI)*n),f0=function(t,e,n,i,r){return[t+n*Math.cos(r),e+i*Math.sin(r)]},f1=function(t,e,n,i,r,_){return __spreadArrays(f0(t,e,0,0,0),f0(t,e,n,i,r),f0(t,e,n,i,_))},i=0;i<num;i++)(_b=this.ver).push.apply(_b,f1(ox,oy,or,or,oa+da/num*i,oa+da/num*(i+1))),(_c=this.tex).push.apply(_c,f1(tx,ty,trw,trh,ta+da/num*i,ta+da/num*(i+1))),this.alp.push(alpha,alpha,alpha);this.n+=3*num,eval("window.debug_info.fver = this.ver")},GLHelper.prototype.flush=function(){for(var t=new Float32Array(this.ver),e=0;e<t.length;e+=2)t[e]=(0,_Screen__WEBPACK_IMPORTED_MODULE_1__.OK)(t[e]),t[e+1]=(0,_Screen__WEBPACK_IMPORTED_MODULE_1__.ZA)(t[e+1]);_gl__WEBPACK_IMPORTED_MODULE_0__.draw(t,new Float32Array(this.tex),new Float32Array(this.alp),this.img,this.n),this.ver=[],this.tex=[],this.alp=[],this.n=0},GLHelper}()},516:(t,e,n)=>{"use strict";n.d(e,{Z:()=>h});var i=n(924),r=n(780),_=n(940),o=n(583),a=n(822),s=n(68),u=n(869),p=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var _=arguments[e],o=0,a=_.length;o<a;o++,r++)i[r]=_[o];return i},c=o.xg(_.cI,1),h=function(){function t(){this.special_duration=100,this.special_remain=0}return t.prototype.updateEnable=function(t,e){return this.special_remain>0&&(a.n.INSTANCE.special_effects.time_slowdown(.5),this.special_remain-=a.n.INSTANCE.special_effects.time_rate),!(this.special_remain>0||!(e&&t.ability_count>0)||(t.ability_count--,this.special_remain=this.special_duration,1))},t.prototype.render=function(t,e){if(t==u.t4+50){var n=new r.l;i.setMode(0);var _=c.sprite,o=[(_.tx+_.tw/2)/_.sprite.w,(_.ty+_.th/2)/_.sprite.h,_.tw/2/_.sprite.w,_.th/2/_.sprite.h];if(n.bind(s.Z.get(_.sprite.path).img),0==this.special_remain){var a=2*Math.PI*e.ability_count/(e.ability.max_ability+1),h=2*Math.PI*(e.graze_current/e.ability.max_graze)/(e.ability.max_ability+1),l=e.post_grazed?.7:.5,f=e.graze_current==e.ability.max_graze?l:e.post_grazed?.7:.2;n.fan(p([a,Math.PI/2,e.px,e.py,c.w/2,Math.PI/6],o,[l]),32),n.fan(p([h,Math.PI/2+a,e.px,e.py,c.w/2,Math.PI/6+a],o,[f]),32)}else a=2*Math.PI*this.special_remain/this.special_duration,n.fan(p([a,-a+Math.PI/2,e.px,e.py,c.w/2,-a+Math.PI/6],o,[1]),32);n.flush()}},t.prototype.layers=function(){return[u.t4+50]},t}()},799:(t,e,n)=>{"use strict";n.d(e,{Fe:()=>o,VN:()=>a,wv:()=>s,cf:()=>u,DP:()=>p,zA:()=>c,so:()=>h});var i=n(349),r=n(822),_=n(296),o=function(){return{onInit:[],onUpdate:[],onPostMotion:[],onPostUpdate:[],onAttack:[],onDestroy:[],onExitScreen:[],onKill:[]}},a=function(){return{onInit:[],onUpdate:[],onPostMotion:[],onStateChange:[],onPostUpdate:[],onAttack:[],onContact:[],onDestroy:[]}},s={w0:-i.SH,w1:i.SH,h0:-i.ZP,h1:i.ZP,max:1/0,inner_bound:!0,outer_bound:!1},u=function(t){return function(e){e.onInit.push((function(e){var n=e.custom_fields;n.in_screen=e.px>t.w0&&e.px<t.w1&&e.py>t.h0&&e.py<t.h1,n.ref_count=0})),e.onPostMotion.push((function(e,n){var i=e.custom_fields,r=i.in_screen;i.in_screen=e.px>t.w0&&e.px<t.w1&&e.py>t.h0&&e.py<t.h1,r&&!i.in_screen&&t.inner_bound&&(i.ref_count<t.max&&e.px<=t.w0&&(i.ref_count++,e.vx=-e.vx,e.px=2*t.w0-e.px),i.ref_count<t.max&&e.px>=t.w1&&(i.ref_count++,e.vx=-e.vx,e.px=2*t.w1-e.px),i.ref_count<t.max&&e.py<=t.h0&&(i.ref_count++,e.vy=-e.vy,e.py=2*t.h0-e.py),i.ref_count<t.max&&e.py>=t.h1&&(i.ref_count++,e.vy=-e.vy,e.py=2*t.h1-e.py),e.dir=Math.atan2(e.vy,e.vx),i.in_screen=!0),!r&&i.in_screen&&t.outer_bound&&(i.ref_count<t.max&&e.px>=t.w0&&(i.ref_count++,e.vx=-e.vx,e.px=2*t.w0-e.px),i.ref_count<t.max&&e.px<=t.w1&&(i.ref_count++,e.vx=-e.vx,e.px=2*t.w1-e.px),i.ref_count<t.max&&e.py>=t.h0&&(i.ref_count++,e.vy=-e.vy,e.py=2*t.h0-e.py),i.ref_count<t.max&&e.py<=t.h1&&(i.ref_count++,e.vy=-e.vy,e.py=2*t.h1-e.py),e.dir=Math.atan2(e.vy,e.vx),i.in_screen=!1)}))}},p=function(t){return function(e){return e.custom_fields.ref_count=t.max}},c={name:"",w0:-i.SH,w1:i.SH,h0:-i.ZP,h1:i.ZP,max:1/0,maxlen:NaN,v:NaN,body:null,cf:null},h=function(t){return function(e){var n=function(e,n){var r=e.custom_fields;if(r.togrow>0){var _=Math.min(r.togrow,t.v*n);n-=_/t.v,e.len+=_,r.togrow-=_}n>0&&(e.px+=n*r.vx,e.py+=n*r.vy),e.shaped_sprite.end.shape.rawExitScreen(e.px+e.len*Math.cos(e.dir),e.py+e.len*Math.sin(e.dir),e.shaped_sprite.base,i.SH,i.ZP)&&e.shaped_sprite.base.shape.rawExitScreen(e.px,e.py,e.shaped_sprite.base,i.SH,i.ZP)&&(e.state=3)},o=function(e,n){return e>t.w0&&e<t.w1&&n>t.h0&&n<t.h1},a=function(e,n){var r=e.custom_fields;if(r.toshrink>0){var _=Math.min(r.toshrink,t.v*n);e.len-=_,r.toshrink-=_,r.toshrink<=0&&(e.state=3)}r.togrow>0&&(n-=(_=Math.min(r.togrow,t.v*n))/t.v,e.len+=_,r.togrow-=_),n>0&&(e.px+=n*r.vx,e.py+=n*r.vy),e.shaped_sprite.base.shape.rawExitScreen(e.px,e.py,e.shaped_sprite.base,i.SH,i.ZP)&&(e.state=3)};e.onInit.push((function(e){var i=e.custom_fields;i.ref_count=0,i.vx=t.v*Math.cos(e.dir),i.vy=t.v*Math.sin(e.dir),i.togrow=t.maxlen,i.toshrink=0,e.motion=n})),e.onPostMotion.push((function(e,n){var i=e.custom_fields,s=(o(e.px,e.py),e.px+e.len*Math.cos(e.dir)),u=e.py+e.len*Math.sin(e.dir);if(!o(s,u)&&i.ref_count<t.max){var p=new _.Fu(t.body,t.cf,a);p.init(e.px,e.py,e.dir,e.len);var c=p.custom_fields;c.vx=i.vx,c.vy=i.vy,c.togrow=i.togrow,r.n.INSTANCE.add(p);var h=0,l=0;i.ref_count<t.max&&s<=t.w0&&(h=t.w0,l=e.py+(t.w0-e.px)*i.vy/i.vx,i.ref_count++,i.vx=-i.vx,e.px=2*t.w0-e.px),i.ref_count<t.max&&s>=t.w1&&(h=t.w1,l=e.py+(t.w1-e.px)*i.vy/i.vx,i.ref_count++,i.vx=-i.vx,e.px=2*t.w1-e.px),i.ref_count<t.max&&u<=t.h0&&(l=t.h0,h=e.px+(t.h0-e.py)*i.vx/i.vy,i.ref_count++,i.vy=-i.vy,e.py=2*t.h0-e.py),i.ref_count<t.max&&u>=t.h1&&(l=t.h1,h=e.px+(t.h1-e.py)*i.vx/i.vy,i.ref_count++,i.vy=-i.vy,e.py=2*t.h1-e.py);var f=Math.sqrt(Math.pow(e.px-h,2)+Math.pow(e.py-l,2));e.len-=f,e.px=h,e.py=l,i.togrow+=f,p.len=f,c.toshrink=f+c.togrow,e.dir=Math.atan2(i.vy,i.vx)}}))}}},869:(t,e,n)=>{"use strict";n.d(e,{T:()=>i,ZE:()=>r,yR:()=>_,A4:()=>o,t_:()=>a,T7:()=>s,KZ:()=>u,DV:()=>p,P4:()=>c,k8:()=>h,Gs:()=>l,Io:()=>f,NH:()=>d,t4:()=>E,bm:()=>y,$7:()=>M,d9:()=>v,S:()=>P});var i=0,r=1,_=2,o=3,a=4,s=5,u=0,p=1,c=1,h=1,l=14,f=0,d=0,E=100,y=500,M=700;function v(t){return Object.assign({},t)}var P={render_layer:M,collide_group:i,collide_mask:u}},651:(t,e,n)=>{"use strict";n.d(e,{R0:()=>u,uQ:()=>c});var i,r=n(869),_=n(822),o=n(349),a=n(566),s=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u={render_layer:r.bm,collide_group:r.A4,collide_mask:r.A4,kill_on_exit:!0,kill_by:function(t){return t==r.t_||t==r.T},auto_direction:!0,life:0,listener:null},p=function(t,e){return!0},c=function(t){function e(e,n){var i=t.call(this,e)||this;return i.state=0,i.motion=p,i.custom_fields={},i.config=n,i.time=0,i}return s(e,t),e.prototype.setMotion=function(t){return this.motion=t,this.simpleInit(0,0,0,0)},e.prototype.simpleInit=function(t,e,n,i){return this.px=t,this.py=e,this.vx=n*Math.cos(i),this.vy=n*Math.sin(i),this.dir=i,this.motion(this,0)&&this.config.auto_direction&&(this.dir=Math.atan2(this.vy,this.vx)),this},e.prototype.init=function(t){return t(this),this},e.prototype.update=function(t){var e,n,i,r,o,a,s,u,p=this;0==this.state&&(this.state=1,null===(n=null===(e=this.config.listener)||void 0===e?void 0:e.onInit)||void 0===n||n.forEach((function(t){return t(p)})));var c=_.n.INSTANCE.special_effects.time_rate;this.time+=c,null===(r=null===(i=this.config.listener)||void 0===i?void 0:i.onUpdate)||void 0===r||r.forEach((function(t){return t(p,c)})),this.motion(this,c)&&(this.px+=this.vx*c,this.py+=this.vy*c,this.config.auto_direction&&(this.dir=Math.atan2(this.vy,this.vx))),(null===(a=null===(o=this.shaped_sprite)||void 0===o?void 0:o.sprite)||void 0===a?void 0:a.omega)&&(this.dir=this.time*this.shaped_sprite.sprite.omega),null===(u=null===(s=this.config.listener)||void 0===s?void 0:s.onPostMotion)||void 0===u||u.forEach((function(t){return t(p,c)}))},e.prototype.postUpdate=function(t){var e,n,i,r,_,a,s,u,p=this;(null===(n=null===(e=this.shaped_sprite)||void 0===e?void 0:e.shape)||void 0===n?void 0:n.exitScreen(this,o.SH,o.ZP))&&(this.config.kill_on_exit&&(this.state=2),null===(r=null===(i=this.config.listener)||void 0===i?void 0:i.onExitScreen)||void 0===r||r.forEach((function(t){return t(p)}))),this.config.life&&this.time>=this.config.life&&(this.state=2),null===(a=null===(_=this.config.listener)||void 0===_?void 0:_.onPostUpdate)||void 0===a||a.forEach((function(t){return t(p)})),2==this.state&&(null===(u=null===(s=this.config.listener)||void 0===s?void 0:s.onDestroy)||void 0===u||u.forEach((function(t){return t(p)})),this.state=3)},e.prototype.attack=function(t,e){var n,i,r=this;null===(i=null===(n=this.config.listener)||void 0===n?void 0:n.onAttack)||void 0===i||i.forEach((function(t){return t(r,e)})),e.damaged(e,this)},e.prototype.damaged=function(t,e){var n,i,r=this;return!!this.config.kill_by(e.config.collide_group)&&(this.state=2,null===(i=null===(n=this.config.listener)||void 0===n?void 0:n.onKill)||void 0===i||i.forEach((function(t){return t(r,e)})),!0)},e}(a.eY)},296:(t,e,n)=>{"use strict";n.d(e,{cE:()=>s,Fu:()=>u});var i,r,_=n(566),o=n(822),a=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(t){function e(e){var n=t.call(this)||this;return n.func=e,n}return a(e,t),e.prototype.distanceTo=function(t,e,n){return Math.min(this.func(t,e,n),t.shaped_sprite.base.shape.rawDistanceTo(t.px,t.py,1,e,n),t.shaped_sprite.end.shape.rawDistanceTo(t.px+t.len*Math.cos(t.dir),t.py+t.len*Math.sin(t.dir),1,e,n))},e.line_circle=function(t,e,n){var i=t.px+t.shaped_sprite.hitbox_width*Math.cos(t.dir),r=t.py+t.shaped_sprite.hitbox_width*Math.sin(t.dir),_=t.px+(t.len-t.shaped_sprite.hitbox_width)*Math.cos(t.dir),o=t.py+(t.len-t.shaped_sprite.hitbox_width)*Math.sin(t.dir),a=Math.sqrt(Math.pow(i-_,2)+Math.pow(r-o,2)),s=Math.abs((_-i)*(r-n)-(i-e)*(o-r)),u=Math.sqrt(Math.pow(i-e,2)+Math.pow(r-n,2)),p=Math.sqrt(Math.pow(_-e,2)+Math.pow(o-n,2));return Math.pow(Math.max(u,p),2)>Math.pow(Math.min(u,p),2)+Math.pow(a,2)?Math.min(u,p)-t.shaped_sprite.hitbox_width*t.w:Math.min(s/a,u,p)-t.shaped_sprite.hitbox_width*t.w},e.double_arc=function(t,e,n){var i=e-t.px,r=n-t.py,o=i*Math.cos(-t.dir)-r*Math.sin(-t.dir),a=i*Math.sin(-t.dir)+r*Math.cos(-t.dir);return _.HC.orthDis(o-t.len/2,a,t.len/2,t.w*t.shaped_sprite.hitbox_width)},e.half_arc=function(t,e,n){var i=e-t.px,r=n-t.py,o=i*Math.cos(-t.dir)-r*Math.sin(-t.dir),a=i*Math.sin(-t.dir)+r*Math.cos(-t.dir);return o<0?Math.sqrt(Math.pow(o,2)+Math.pow(a,2)):_.HC.orthDis(o,a,t.len,t.w*t.shaped_sprite.hitbox_width)},e}(_.bn),u=(r=_.Yw,a((function(){return null!==r&&r.apply(this,arguments)||this}),r),function(t){function e(e,n,i){var r=t.call(this,e)||this;return r.state=0,r.rstate=0,r.time=0,r.custom_fields={},r.config=n,r.motion=i,r}return a(e,t),e.prototype.init=function(t,e,n,i){return this.len=i,this.dir=n,this.px=t,this.py=e,this.checkState(),this},e.prototype.checkState=function(){var t,e,n,i,r,_,o,a,s,u,p=this;0==this.state&&(this.state=2,null===(e=null===(t=this.config.listener)||void 0===t?void 0:t.onInit)||void 0===e||e.forEach((function(t){return t(p)})));var c=this.config.warning_time,h=this.config.open_time+c,l=this.config.alive_time+h,f=this.config.close_time+l;0==this.rstate&&this.time>=c&&(this.rstate=1,null===(i=null===(n=this.config.listener)||void 0===n?void 0:n.onStateChange)||void 0===i||i.forEach((function(t){return t(p)}))),1==this.rstate&&(this.w=Math.min(1,(this.time-c)/(h-c)),this.time>=h&&(this.rstate=2,this.state=1,this.w=1,null===(_=null===(r=this.config.listener)||void 0===r?void 0:r.onStateChange)||void 0===_||_.forEach((function(t){return t(p)})))),2==this.rstate&&this.time>=l&&(this.rstate=3,this.state=2,null===(a=null===(o=this.config.listener)||void 0===o?void 0:o.onStateChange)||void 0===a||a.forEach((function(t){return t(p)}))),3==this.rstate&&(this.w=Math.max(0,1-(this.time-l)/(f-l)),this.time>=f&&(this.state=3,null===(u=null===(s=this.config.listener)||void 0===s?void 0:s.onDestroy)||void 0===u||u.forEach((function(t){return t(p)}))))},e.prototype.update=function(t){var e,n,i,r,_,a,s=this;0==this.state&&(this.state=2,null===(n=null===(e=this.config.listener)||void 0===e?void 0:e.onInit)||void 0===n||n.forEach((function(t){return t(s)})));var u=o.n.INSTANCE.special_effects.time_rate;this.time+=u,this.checkState(),null===(r=null===(i=this.config.listener)||void 0===i?void 0:i.onUpdate)||void 0===r||r.forEach((function(t){return t(s,u)})),this.motion(this,u),null===(a=null===(_=this.config.listener)||void 0===_?void 0:_.onPostMotion)||void 0===a||a.forEach((function(t){return t(s,u)}))},e.prototype.postUpdate=function(t){var e,n,i=this;null===(n=null===(e=this.config.listener)||void 0===e?void 0:e.onPostUpdate)||void 0===n||n.forEach((function(t){return t(i)}))},e.prototype.attack=function(t,e){var n,i,r=this;null===(i=null===(n=this.config.listener)||void 0===n?void 0:n.onAttack)||void 0===i||i.forEach((function(t){return t(r,e)})),e.damaged(e,this)},e.prototype.damaged=function(t,e){var n,i,r=this;return null===(i=null===(n=this.config.listener)||void 0===n?void 0:n.onContact)||void 0===i||i.forEach((function(t){return t(r,e)})),!1},e}(function(t){function e(e){var n=t.call(this,0,e)||this;return n.w=0,n}return a(e,t),e.prototype.rectCount=function(){return 3},e.prototype.render=function(t,e){var n=this.shaped_sprite.l_ratio*this.len/2;t[10*e+0]=this.px+n*Math.cos(this.dir),t[10*e+1]=this.py+n*Math.sin(this.dir),t[10*e+2]=this.dir+Math.PI/2,t[10*e+3]=Math.max(1,this.shaped_sprite.sprite_width*this.w),t[10*e+4]=n;var i=this.shaped_sprite.sprite;t[10*e+5]=i.tx/i.sprite.w,t[10*e+6]=i.ty/i.sprite.h,t[10*e+7]=i.tw/i.sprite.w,t[10*e+8]=i.th/i.sprite.h,t[10*e+9]=1,e++;var r=this.shaped_sprite.base;t[10*e+0]=this.px,t[10*e+1]=this.py,t[10*e+2]=this.dir+Math.PI/2,t[10*e+3]=r.w/2,t[10*e+4]=r.h/2,i=r.sprite,t[10*e+5]=i.tx/i.sprite.w,t[10*e+6]=i.ty/i.sprite.h,t[10*e+7]=i.tw/i.sprite.w,t[10*e+8]=i.th/i.sprite.h,t[10*e+9]=1,e++,r=this.shaped_sprite.end,t[10*e+0]=this.px+this.len*Math.cos(this.dir),t[10*e+1]=this.py+this.len*Math.sin(this.dir),t[10*e+2]=this.dir+Math.PI/2,t[10*e+3]=r.w/2,t[10*e+4]=r.h/2,i=r.sprite,t[10*e+5]=i.tx/i.sprite.w,t[10*e+6]=i.ty/i.sprite.h,t[10*e+7]=i.tw/i.sprite.w,t[10*e+8]=i.th/i.sprite.h,t[10*e+9]=1},e}(_.hE)))},533:(t,e,n)=>{"use strict";n.d(e,{f:()=>c,U:()=>h});var i,r=n(566),_=n(68),o=n(349),a=n(869),s=n(822),u=n(924),p=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(){function t(t,e,n){this.shoot=t,this.bomb=e,this.ability=n}return t.prototype.updateShoot=function(t,e){var n;return null===(n=this.shoot)||void 0===n?void 0:n.updateEnable(t,e)},t.prototype.updateBomb=function(t,e){var n;return null===(n=this.bomb)||void 0===n?void 0:n.updateEnable(t,e)},t.prototype.updateAbility=function(t,e){var n;return null===(n=this.ability)||void 0===n?void 0:n.updateEnable(t,e)},t.prototype.render=function(t,e){var n,i,r;null===(n=this.shoot)||void 0===n||n.render(t,e),null===(i=this.bomb)||void 0===i||i.render(t,e),null===(r=this.ability)||void 0===r||r.render(t,e)},t.prototype.layers=function(){var t=[];return this.shoot&&(t=t.concat(this.shoot.layers())),this.bomb&&(t=t.concat(this.bomb.layers())),this.ability&&(t=t.concat(this.ability.layers())),t},t}(),h=function(t){function e(n,i,r,_,o){var s=t.call(this,2,null)||this;return s.config=a.S,s.state=1,s.time=0,s.missed=!1,s.bombed=!1,s.grazed=!1,s.post_grazed=!1,s.pre_miss=0,s.miss_time=0,s.invince_time=0,s.px=0,s.py=0,s.dir=0,s.prex=0,s.prey=0,s.graze_total=0,s.graze_current=0,s.collideCheck=function(t){for(var e=Math.sqrt(Math.pow(s.px-s.prex,2)+Math.pow(s.py-s.prey,2)),n=Math.max(1,Math.ceil(e/2)),i=1/0,r=0;r<n;r++){var _=s.px+(s.prex-s.px)*r/n,o=s.py+(s.prey-s.py)*r/n;i=Math.min(i,t.distanceTo(_,o))}return i-s.shaped_sprite.shape.radius<s.ability.graze_radius&&(s.grazed=!0),i<s.shaped_sprite.shape.radius},e.INSTANCE=s,s.proto=i,s.ability=r,s.sprite=n,s.px=_,s.py=o,s.dir=0,s.bomb_count=r.init_bomb,s.life_count=r.init_life,s.ability_count=r.init_ability,s.renderType=2,s}return p(e,t),e.updateState=function(t){e.action=t},e.prototype.update=function(t){if(e.action){this.prex=this.px,this.prey=this.py;var n=s.n.INSTANCE.special_effects.time_rate;this.time+=n,this.px+=e.action.pos_x,this.py+=e.action.pos_y,this.px<-o.SH&&(this.px=-o.SH),this.px>o.SH&&(this.px=o.SH),this.py<-o.ZP&&(this.py=-o.ZP),this.py>o.ZP&&(this.py=o.ZP),this.dir=this.time*this.sprite.sprite.omega,this.bombed=this.proto.updateShoot(this,e.action.key_z),this.bombed||(this.bombed=this.proto.updateBomb(this,e.action.key_x)),this.bombed||(this.bombed=this.proto.updateAbility(this,e.action.key_c))}},e.prototype.postUpdate=function(t){this.post_grazed=this.grazed,this.grazed&&(this.graze_current<this.ability.max_graze&&(this.graze_current+=s.n.INSTANCE.special_effects.time_rate),this.graze_total++,this.graze_current>=this.ability.max_graze&&this.ability_count<this.ability.max_ability&&(this.ability_count++,this.graze_current=0),this.grazed=!1),this.miss_time>0&&this.miss_time--,this.pre_miss>0&&(this.pre_miss--,0==this.pre_miss&&(console.log("missed"),this.miss_time=this.ability.miss_time)),this.missed&&(this.missed=!1,this.pre_miss=this.ability.pre_miss),this.bombed&&(this.bombed=!1,this.miss_time=this.ability.bomb_time,this.pre_miss>0&&(console.log("bomb after miss"),this.pre_miss=0)),this.miss_time>0||this.pre_miss>0?(this.state=2,this.invince_time++,Math.floor(this.invince_time/6)%2==0?this.shaped_sprite=null:this.shaped_sprite=this.sprite):(this.state=1,this.invince_time=0,this.shaped_sprite=this.sprite)},e.prototype.attack=function(t,e){},e.prototype.damaged=function(t,e){return 0==this.pre_miss&&0==this.miss_time&&(this.missed=!0),e.damaged(e,this)},e.prototype.layers=function(){return function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var _=arguments[e],o=0,a=_.length;o<a;o++,r++)i[r]=_[o];return i}(this.proto.layers(),[a.$7])},e.prototype.render=function(t){var e,n=[],i=0,r=null;this.proto.render(t,this),t==a.$7&&(null===(e=this.shaped_sprite)||void 0===e?void 0:e.sprite)&&(function(t,e,o,a,s){n.push(t),n.push(e),n.push(o+Math.PI/2),n.push(s.w/2),n.push(s.h/2);var u=s.sprite;n.push(u.tx/u.sprite.w),n.push(u.ty/u.sprite.h),n.push(u.tw/u.sprite.w),n.push(u.th/u.sprite.h),n.push(1),i++,r=_.Z.get(u.sprite.path).img}(this.px,this.py,this.dir,0,this.shaped_sprite),u.setMode(0),u.drawRects(new Float32Array(n),i,r))},e.INSTANCE=null,e.action=null,e}(r.hE)},822:(t,e,n)=>{"use strict";n.d(e,{n:()=>a});var i=n(869),r=n(566),_=n(68),o=function(){function t(){this.time_rate=1,this.time_rate_next=1}return t.prototype.process=function(){this.time_rate=this.time_rate_next,this.time_rate_next=1},t.prototype.time_slowdown=function(t){this.time_rate_next*=t},t}(),a=function(){function t(){this.groups=[],this.pending=[],this.update_stage=0,this.time=0,this.special_effects=new o,t.INSTANCE=this,this.groups.push({id:i.T,mask:i.KZ,list:[]}),this.groups.push({id:i.ZE,mask:i.DV,list:[]}),this.groups.push({id:i.yR,mask:i.P4,list:[]}),this.groups.push({id:i.A4,mask:i.k8,list:[]}),this.groups.push({id:i.t_,mask:i.Gs,list:[]}),this.groups.push({id:i.T7,mask:i.Io,list:[]})}return t.prototype.registerGroup=function(t){var e=this.groups.length;return this.groups.push({id:e,mask:t,list:[]}),e},t.prototype.add=function(t){3!=this.update_stage&&0!=this.update_stage?this.pending.push(t):this.groups[t.config.collide_group].list.push(t)},t.prototype.update=function(){var t=this;this.update_stage=1,this.groups.forEach((function(t){return t.list.forEach((function(t){return t.update(t)}))}));for(var e=0;e<this.groups.length;e++)for(var n=0;n<this.groups.length;n++)if(this.groups[e].mask&1<<n)for(var i=0,_=this.groups[e].list;i<_.length;i++){var o=_[i];if(1==o.state&&o.shaped_sprite&&o.shaped_sprite.shape)for(var a=0,s=this.groups[n].list;a<s.length;a++){var u=s[a];1==u.state&&u.shaped_sprite&&u.shaped_sprite.shape&&(0,r._R)(o,u)&&o.attack(o,u)}}this.update_stage=2,this.groups.forEach((function(t){return t.list.forEach((function(t){return t.postUpdate(t)}))})),this.groups.forEach((function(t){return t.list=t.list.filter((function(t){return 3!=t.state}))})),this.update_stage=3,this.special_effects.process(),this.pending.forEach((function(e){return t.add(e)})),this.pending=[],this.time++},t.prototype.render=function(){var t,e,n,i,r,o,a,s;return r=this,o=void 0,s=function(){var r,o,a,s,u,p,c,h,l,f,d,E;return function(t,e){var n,i,r,_,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return _={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(_[Symbol.iterator]=function(){return this}),_;function a(_){return function(a){return function(_){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&_[0]?i.return:_[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,_[1])).done)return r;switch(i=0,r&&(_=[2&_[0],r.value]),_[0]){case 0:case 1:r=_;break;case 4:return o.label++,{value:_[1],done:!1};case 5:o.label++,i=_[1],_=[0];continue;case 7:_=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==_[0]&&2!==_[0])){o=0;continue}if(3===_[0]&&(!r||_[1]>r[0]&&_[1]<r[3])){o.label=_[1];break}if(6===_[0]&&o.label<r[1]){o.label=r[1],r=_;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(_);break}r[2]&&o.ops.pop(),o.trys.pop();continue}_=e.call(t,o)}catch(t){_=[6,t],i=0}finally{n=r=0}if(5&_[0])throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}([_,a])}}}(this,(function(y){for(r=new Map,o=[],a=0,s=this.groups;a<s.length;a++)for(u=s[a],p=0,c=u.list;p<c.length;p++)2!=(h=c[p]).renderType?h.config.render_layer&&(null===(t=h.shaped_sprite)||void 0===t?void 0:t.sprite)&&(r.has(h.config.render_layer)||r.set(h.config.render_layer,new Map),f=r.get(h.config.render_layer),d=null===(i=null===(n=null===(e=h.shaped_sprite)||void 0===e?void 0:e.sprite)||void 0===n?void 0:n.sprite)||void 0===i?void 0:i.path,f.has(d)||f.set(d,[]),f.get(d).push(h)):(l=h,o.push(l),l.layers().forEach((function(t){return r.set(t,new Map)})));return E=[],r.forEach((function(t,e){return E.push({rl:e,v:t})})),E.sort((function(t,e){return t.rl-e.rl})),E.forEach((function(t){o.forEach((function(e){return e.render(t.rl)})),t.v.forEach((function(t,e){return _.Z.get(e).draw(t)}))})),[2]}))},new((a=void 0)||(a=Promise))((function(t,e){function n(t){try{_(s.next(t))}catch(t){e(t)}}function i(t){try{_(s.throw(t))}catch(t){e(t)}}function _(e){var r;e.done?t(e.value):(r=e.value,r instanceof a?r:new a((function(t){t(r)}))).then(n,i)}_((s=s.apply(r,o||[])).next())}))},t}()},334:(t,e,n)=>{"use strict";n.d(e,{FX:()=>c,hP:()=>d,b2:()=>y});var i,r=n(869),_=n(566),o=n(822),a=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var _=arguments[e],o=0,a=_.length;o<a;o++,r++)i[r]=_[o];return i},u=function(){},p=function(t){function e(e){var n=t.call(this)||this;return n.remain=e,n}return a(e,t),e.prototype.update=function(t){return this.remain-=t,this.remain<0?-this.remain:0},e}(u),c=function(t){function e(e){var n=t.call(this)||this;return n.time=0,n.init=e,n}return a(e,t),e.random=function(t,n){return function(){return new e((function(e){var i=Math.max(n.px0-t.px,-n.dx1),r=Math.min(n.px1-t.px,n.dx1),_=Math.max(n.py0-t.py,-n.dy1),o=Math.min(n.py1-t.py,n.dy1),a=i+Math.random()*(r-i),s=_+Math.random()*(o-_);e.target=t,e.duration=n.duration,e.dx=a,e.dy=s,e.x0=t.px,e.y0=t.py,e.ease=n.ease}))}},e.prototype.update=function(t){0==this.time&&this.init(this),this.time+=t;var e=Math.min(1,this.time/this.duration),n=this.ease(e);return this.target.px=this.x0+this.dx*n,this.target.py=this.y0+this.dy*n,this.time>this.duration?this.time-this.duration:0},e}(u),h=function(t){function e(e){var n=t.call(this)||this;return n.todo=e,n}return a(e,t),e.prototype.update=function(t,e){var n=this.todo();return void 0===n?t:"number"==typeof n?(e.list[0]=new p(n),e.list[0].update(t,e)):(e.list.unshift(e.list[0]),e.list[1]=n,t)},e}(u),l=function(){};function f(t){return t.map((function(t){return"number"==typeof t?new p(t):"function"==typeof t?new h(t):t}))}var d=function(t){function e(e,n){var i=t.call(this)||this;return i.index=0,i.todo=e,i.total=n,i}return a(e,t),e.prototype.supply=function(){return this.index>=this.total?null:(t="function"==typeof this.todo?this.todo(this.index):this.todo,this.index++,f(t));var t},e}(l),E={render_layer:r.NH,collide_group:r.T7,collide_mask:r.Io},y=function(t){function e(e){var n=t.call(this)||this;return n.custom_fields={},n.config=E,n.state=0,n.time=0,n.list=f("object"==typeof e?e:e(n)),n}return a(e,t),e.prototype.init=function(t){return t(this),this},e.prototype.update=function(t){0==this.state&&(this.state=1);var e=o.n.INSTANCE.special_effects.time_rate;for(this.time+=e;this.list.length>0&&e;){var n=this.list[0];if(n instanceof l){var i=n.supply();i&&i.length?this.list=s(i,this.list):this.list.shift()}else(e=n.update(e,this))>0&&this.list.shift()}0==this.list.length&&(this.state=2)},e.prototype.postUpdate=function(t){2==this.state&&(this.state=3)},e.prototype.attack=function(t){},e.prototype.damaged=function(t,e){return!1},e}(_.u5)},176:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{S:()=>init});var _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(651),_entity_SelfMachine__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(533),_stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(334),_util_SpriteManager__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(68),_util_sprites__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(940),_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(583),_stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(822),_entity_Entity__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(869),_entity_RayLaser__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(296),_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(799),_data_SlowAbility__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(516),__awaiter=function(t,e,n,i){return new(n||(n=Promise))((function(r,_){function o(t){try{s(i.next(t))}catch(t){_(t)}}function a(t){try{s(i.throw(t))}catch(t){_(t)}}function s(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}s((i=i.apply(t,e||[])).next())}))},__generator=function(t,e){var n,i,r,_,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return _={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(_[Symbol.iterator]=function(){return this}),_;function a(_){return function(a){return function(_){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&_[0]?i.return:_[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,_[1])).done)return r;switch(i=0,r&&(_=[2&_[0],r.value]),_[0]){case 0:case 1:r=_;break;case 4:return o.label++,{value:_[1],done:!1};case 5:o.label++,i=_[1],_=[0];continue;case 7:_=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==_[0]&&2!==_[0])){o=0;continue}if(3===_[0]&&(!r||_[1]>r[0]&&_[1]<r[3])){o.label=_[1];break}if(6===_[0]&&o.label<r[1]){o.label=r[1],r=_;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(_);break}r[2]&&o.ops.pop(),o.trys.pop();continue}_=e.call(t,o)}catch(t){_=[6,t],i=0}finally{n=r=0}if(5&_[0])throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}([_,a])}}},sm_proto=new _entity_SelfMachine__WEBPACK_IMPORTED_MODULE_1__.f(null,null,new _data_SlowAbility__WEBPACK_IMPORTED_MODULE_10__.Z),sm_abi={pre_miss:30,miss_time:60,bomb_time:60,graze_radius:24,max_graze:600,init_bomb:3,init_life:3,init_ability:5,max_bomb:10,max_life:10,max_ability:5},repeat=function(t,e){return void 0===e&&(e=1/0),function(){return new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.hP(t,e)}},nonblock=function(t){return function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2(t))}},sinit={load_sprite:function(){return _util_SpriteManager__WEBPACK_IMPORTED_MODULE_3__.Z.get(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.Xp.path).load()},add_player:function(){return new _entity_SelfMachine__WEBPACK_IMPORTED_MODULE_1__.U(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.a_,1),sm_proto,sm_abi,0,-192)},add_schedule:null},stage_list,stage_000=function(t){var e=_util_sprites__WEBPACK_IMPORTED_MODULE_4__.hZ(5,1,0),n=_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(e,1);return new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([30*t,repeat((function(e){return[repeat((function(i){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(n,_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0).simpleInit(0,0,8/t,.003/t*e*e+2*Math.PI/5*i))}]}),5),1*t]}),1/0)])},stage_001=function(t){var e=function(t){return _util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.e8(1,t,0),1)},n=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0);n.life=180*t,n.kill_on_exit=!1;var i={duration:100*t,px0:-96,px1:96,py0:32,py1:112,dx1:64,dy1:64,ease:function(t){return(1-Math.cos(Math.PI*t))/2}},r=1*t,_=3/t,o=-_/70,a=.06/t,s=new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.cI,2),_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0).setMotion((function(t){return t.dir=t.time*Math.PI*2/600,!1})).simpleInit(0,64,0,0),u=null,p=function(t,e,i,p){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([repeat((function(c){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(u=new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(null,n).simpleInit(s.px,s.py,_,2*Math.PI/47*c*e*t))},repeat((function(e){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(c%2==0?i:p,_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0).setMotion((n=u,r=2*Math.PI/30*e,_=a*t,70,s=o,function(t,e){var i=r+_*t.time,o=70*Math.sin(s*t.time);return t.px=n.px+o*Math.cos(i),t.py=n.py+o*Math.sin(i),t.dir=Math.atan2(o*_,70*s*Math.cos(s*t.time))+i,!1})));var n,r,_,s}]}),30),r]}),47)]))};return new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(s)},30*t,repeat((function(n){return[function(){return p(n%2*2-1,7,e(2),e(10))},50*t,function(){return p(n%2*2-1,5,e(13),e(6))},50*t,function(){return p(n%2*2-1,1,e(8),e(4))},_stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.FX.random(s,i)]}))])},test_000=function(t){var e=function(t,e,n){return _util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.iW(t,2,1,1,e,n,1)},n=[e(0,0,0),e(0,1,1),e(0,0,1),e(0,1,0),e(4,0,0),e(4,1,1),e(4,0,1),e(4,1,0),e(1,0,0),e(1,1,0)],i={render_layer:_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0.render_layer,collide_group:_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0.collide_group,collide_mask:_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0.collide_mask,warning_time:30*t,open_time:10*t,alive_time:6e3*t,close_time:10*t,listener:null},r=0*Math.PI*2/240/t;return new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([30*t,repeat((function(e){return[repeat((function(t){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _entity_RayLaser__WEBPACK_IMPORTED_MODULE_8__.Fu(n[t],i,(_=r*(e%2*2-1),function(t,e){return t.dir+=e*_})).init(50*Math.cos(2*Math.PI/10*t),50*Math.sin(2*Math.PI/10*t),2*Math.PI/10*t,100));var _}]}),10),6e3*t]}))])},stage_002=function(t){var e=_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.p3(2,0,64),n=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0);n.auto_direction=!1;var i={duration:50*t,px0:-96,px1:96,py0:32,py1:112,dx1:64,dy1:64,ease:function(t){return(1-Math.cos(Math.PI*t))/2}},r=new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.cI,2),_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0).setMotion((function(t){return t.dir=t.time*Math.PI*2/600,!1})).simpleInit(0,64,0,0),_=function(t){return repeat((function(i){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(e,n).setMotion((function(e,n){return e.dir+=n*t,!0})).simpleInit(r.px,r.py,u,p+2*Math.PI/o*i).init((function(t){return t.dir+=2*Math.PI*a/o*i})))}]}),o)},o=50,a=2.5,s=2*Math.PI/60/t,u=6/t,p=0;return new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(r)},30*t,repeat((function(e){return[function(){return p=Math.random()*Math.PI*2},_(s),20*t,_(-s),_stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.FX.random(r,i)]}))])},stage_003=function(t){var e=_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.e8(4,2,0),1),n=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0);n.listener=(0,_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.Fe)();var i=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.wv);i.max=100,(0,_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.cf)(i)(n.listener);var r=Math.PI/24,_=6/t,o=100*t,a=1*t,s=1*t,u={duration:o-40*s-20*a,px0:-96,px1:96,py0:32,py1:112,dx1:64,dy1:64,ease:function(t){return(1-Math.cos(Math.PI*t))/2}},p=new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.cI,2),_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0).setMotion((function(t){return t.dir=t.time*Math.PI*2/600,!1})).simpleInit(0,64,0,0),c=0;return new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(p)},30*t,repeat((function(t){return[function(){return c=Math.random()*Math.PI*2},repeat((function(t){return[nonblock([repeat((function(){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(e,n).setMotion((function(e,n){var a=o-t*s;return e.time-n<a&&e.time>=a&&((0,_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.DP)(i)(e),e.simpleInit(e.px,e.py,_,e.dir+(2*Math.random()-1)*r)),!0})).simpleInit(p.px,p.py,_,c+2*Math.PI/40*t))},a]}),20)]),s]}),40),20*a,_stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.FX.random(p,u)]}))])},stage_004=function(t){var e=[_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.e8(4,2,0),1),_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.e8(4,6,0),1)],n=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0),i=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0);n.listener=(0,_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.Fe)(),i.listener=(0,_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.Fe)();var r=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.wv),_=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.wv);r.max=2,r.h0=-1/0,_.max=1,_.h0=-1/0,(0,_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.cf)(r)(n.listener),(0,_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.cf)(_)(i.listener);var o=6/t,a=1*t,s=3*t,u={duration:40*t,px0:-96,px1:96,py0:32,py1:112,dx1:64,dy1:64,ease:function(t){return(1-Math.cos(Math.PI*t))/2}},p=new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.cI,2),_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0).setMotion((function(t){return t.dir=t.time*Math.PI*2/600,!1})).simpleInit(0,64,0,0),c=0,h=function(t,e,n,i){return repeat((function(r){return[nonblock([repeat((function(_){return[repeat((function(a){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(t,i).simpleInit(p.px,p.py,o,c+n*Math.PI*2*(r/8/4+a/4+_/4/8/e*.5)))}]}),8),a]}),e)]),s]}),8)};return new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(p)},30*t,repeat((function(t){return[function(){return c=Math.random()*Math.PI*2},h(e[0],10,1,n),10*a,_stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.FX.random(p,u),h(e[1],15,-1,i),20*a,_stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.FX.random(p,u)]}))])},stage_005=function(t){var e=function(e,n){var i=_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.iW(4,e,n,1,1,1,.75),r={render_layer:_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0.render_layer,collide_group:_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0.collide_group,collide_mask:_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0.collide_mask,warning_time:0,open_time:0,alive_time:1/0,close_time:0,listener:null},_=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(r);r.listener=(0,_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.VN)();var o=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.zA);return o.max=2,o.v=8/t,o.maxlen=128,o.body=i,o.cf=_,o.name=e+"-"+n,(0,_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.so)(o)(r.listener),[i,r,o]},n=[e(6,3),e(2,1)],i=2*Math.PI/t,r=t,_=function(t,e,i,r,_,o){return repeat((function(t){return[repeat((function(_){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _entity_RayLaser__WEBPACK_IMPORTED_MODULE_8__.Fu(n[e][0],n[e][1],null).init(0,0,o+2*Math.PI/i*_+r*t,0))}]}),i),_]}),t)};return new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([30*t,repeat((function(e){return[_(20,0,3,(e%2*2-1)*i*.0678,6*r,2*Math.random()*Math.PI),100*t,_(120,1,1,(e%2*2-1)*i*.0234,r,2*Math.random()*Math.PI),100*t]}))])},test_001=function(t){var e=(0,_entity_Entity__WEBPACK_IMPORTED_MODULE_7__.d9)(_entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.R0);e.listener=(0,_entity_ComplexListener__WEBPACK_IMPORTED_MODULE_9__.Fe)(),e.listener.onAttack.push((function(t){return t.custom_fields.callback()}));var n=[[_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.e8(3,6,0),1),_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.hZ(2,3,0),1)],[_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.e8(3,2,0),1),_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.hZ(2,1,0),1)],[_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.e8(3,8,0),1),_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.hZ(2,4,0),1)],[_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.e8(3,10,0),1),_util_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.xg(_util_sprites__WEBPACK_IMPORTED_MODULE_4__.hZ(2,5,0),1)]],i=2/t;return new _stage_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([60*t,repeat((function(r){return[nonblock((10,_=r%4,function(r,o){return void 0===o&&(o=r.custom_fields),[function(){var t=Math.random()*Math.PI*2;o.ox=50*Math.cos(t),o.oy=64+50*Math.sin(t),o.count=0},repeat([repeat((function(t){return[function(){return _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n.INSTANCE.add(new _entity_MovePoint__WEBPACK_IMPORTED_MODULE_0__.uQ(0==o.count?n[_][0]:n[_][1],e).simpleInit(o.ox,o.oy,i,2*Math.PI/30*t).init((function(t,e){void 0===e&&(e=t.custom_fields),e.callback=function(){return o.count++}})))}]}),30),function(){return o.count=0},60*t],10)]})),165*t];var _}))])};stage_list=[{name:"RayLaser Hitbox Test",init:test_000},{name:"Local Variable Test",init:test_001},{name:"波与粒的境界",init:stage_000},{name:"龙纹弹",init:stage_001},{name:"rotating long bullet",init:stage_002},{name:"reflect and delayed altering",init:stage_003},{name:"finite reflect",init:stage_004},{name:"reflect laser",init:stage_005}];var stage_settings={init,stage:1,scale:3,list:stage_list};function init(){return __awaiter(this,void 0,void 0,(function(){var pool;return __generator(this,(function(_a){switch(_a.label){case 0:return[4,sinit.load_sprite()];case 1:return _a.sent(),pool=new _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n,pool.add(sinit.add_player()),pool.add(stage_list[stage_settings.stage].init(stage_settings.scale)),eval("window.debug_info.pool = pool"),eval("window.debug_info.stage = stage_settings"),[2]}}))}))}},566:(t,e,n)=>{"use strict";n.d(e,{bn:()=>o,D8:()=>s,HC:()=>u,Yw:()=>p,hE:()=>c,eY:()=>h,u5:()=>l,_R:()=>f});var i,r,_=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=function(){},a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e}(o),s=function(t){function e(e){var n=t.call(this)||this;return n.radius=e,n}return _(e,t),e.prototype.exitScreen=function(t,e,n){var i=Math.sqrt(Math.pow(t.shaped_sprite.w,2)+Math.pow(t.shaped_sprite.h,2));return Math.abs(t.px)>e+i*t.magn||Math.abs(t.py)>n+i*t.magn},e.prototype.distanceTo=function(t,e,n){return Math.sqrt(Math.pow(e-t.px,2)+Math.pow(n-t.py,2))-this.radius*t.magn},e.prototype.rawDistanceTo=function(t,e,n,i,r){return Math.sqrt(Math.pow(i-t,2)+Math.pow(r-e,2))-this.radius*n},e.prototype.rawExitScreen=function(t,e,n,i,r){var _=Math.sqrt(Math.pow(n.w,2)+Math.pow(n.h,2));return Math.abs(t)>i+_||Math.abs(e)>r+_},e}(a),u=function(t){function e(e,n){var i=t.call(this)||this;return i.len=e,i.rad=n,i}return _(e,t),e.orthDis=function(t,e,n,i){var r=i/2;t=Math.abs(t);var _=n*n/r/2+r/2-r;return(e=Math.abs(e))>=0&&n*(e+_)>t*_?Math.sqrt(Math.pow(t,2)+Math.pow(e+_,2))-_-r:Math.sqrt(Math.pow(t-n,2)+Math.pow(e,2))-r},e.prototype.exitScreen=function(t,e,n){var i=Math.sqrt(Math.pow(t.shaped_sprite.w,2)+Math.pow(t.shaped_sprite.h,2));return Math.abs(t.px)>e+i*t.magn||Math.abs(t.py)>n+i*t.magn},e.prototype.distanceTo=function(t,n,i){var r=n-t.px,_=i-t.py,o=r*Math.cos(-t.dir)-_*Math.sin(-t.dir),a=r*Math.sin(-t.dir)+_*Math.cos(-t.dir);return e.orthDis(o,a,this.len/2*t.magn,this.rad*t.magn)},e}(a),p=function(){},c=(_((function(){return null!==r&&r.apply(this,arguments)||this}),r=p),function(){function t(t,e){this.collideCheck=null,this.renderType=t,this.shaped_sprite=e}return t.prototype.distanceTo=function(t,e){var n;return(null===(n=this.shaped_sprite)||void 0===n?void 0:n.shape)?this.shaped_sprite.shape.distanceTo(this,t,e):1/0},t}()),h=function(t){function e(e){var n=t.call(this,0,e)||this;return n.magn=1,n.alpha=1,n}return _(e,t),e.prototype.rectCount=function(){return 1},e.prototype.render=function(t,e){t[10*e+0]=this.px,t[10*e+1]=this.py,t[10*e+2]=this.dir+Math.PI/2,t[10*e+3]=this.shaped_sprite.w/2*this.magn,t[10*e+4]=this.shaped_sprite.h/2*this.magn;var n=this.shaped_sprite.sprite;t[10*e+5]=n.tx/n.sprite.w,t[10*e+6]=n.ty/n.sprite.h,t[10*e+7]=n.tw/n.sprite.w,t[10*e+8]=n.th/n.sprite.h,t[10*e+9]=this.alpha},e}(c),l=function(t){function e(){return t.call(this,null,null)||this}return _(e,t),e}(c);function f(t,e){if(t.collideCheck)return t.collideCheck(e);if(e.collideCheck)return e.collideCheck(t);if(t instanceof h&&t.shaped_sprite.shape instanceof s)return e.distanceTo(t.px,t.py)<t.shaped_sprite.shape.radius;if(e instanceof h&&e.shaped_sprite.shape instanceof s)return f(e,t);throw new Error("non-circle non-circle collision not found")}},68:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});var i=n(924),r=function(){function t(t){this.img=null,this.path=t}return t.prototype.loaded=function(){return this.img},t.prototype.load=function(){return t=this,e=void 0,r=function(){var t;return function(t,e){var n,i,r,_,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return _={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(_[Symbol.iterator]=function(){return this}),_;function a(_){return function(a){return function(_){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&_[0]?i.return:_[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,_[1])).done)return r;switch(i=0,r&&(_=[2&_[0],r.value]),_[0]){case 0:case 1:r=_;break;case 4:return o.label++,{value:_[1],done:!1};case 5:o.label++,i=_[1],_=[0];continue;case 7:_=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==_[0]&&2!==_[0])){o=0;continue}if(3===_[0]&&(!r||_[1]>r[0]&&_[1]<r[3])){o.label=_[1];break}if(6===_[0]&&o.label<r[1]){o.label=r[1],r=_;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(_);break}r[2]&&o.ops.pop(),o.trys.pop();continue}_=e.call(t,o)}catch(t){_=[6,t],i=0}finally{n=r=0}if(5&_[0])throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}([_,a])}}}(this,(function(e){switch(e.label){case 0:return[4,i.loadImage(this.path)];case 1:return t=e.sent(),this.img=i.loadTexture(t),[2]}}))},new((n=void 0)||(n=Promise))((function(i,_){function o(t){try{s(r.next(t))}catch(t){_(t)}}function a(t){try{s(r.throw(t))}catch(t){_(t)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}s((r=r.apply(t,e||[])).next())}));var t,e,n,r},t.get=function(e){return t.INS[e]?t.INS[e]:t.INS[e]=new t(e)},t.prototype.draw=function(t){this.drawRect(t,0),this.drawRect(t,1);for(var e=0,n=t;e<n.length;e++){var r=n[e];if(1==r.renderType)for(var _=r,o=_.getSprite(),a=o.sprite,s=0,u=_.render();s<u.length;s++){var p=u[s];i.drawSnake(p,o.w,p.length/2,a.tx,a.ty,a.tw,a.th,this.img)}}},t.prototype.drawRect=function(t,e){var n=t.reduce((function(t,n){return 0==n.renderType&&n.shaped_sprite.sprite.mode==e?t+n.rectCount():t}),0);if(n){i.setMode(e);for(var r=new Float32Array(10*n),_=0,o=0,a=t;o<a.length;o++){var s=a[o];if(0==s.renderType&&s.shaped_sprite.sprite.mode==e){var u=s;u.render(r,_),_+=u.rectCount()}}i.drawRects(r,n,this.img)}},t.INS={},t}()},583:(t,e,n)=>{"use strict";n.d(e,{xg:()=>s,p3:()=>u,iW:()=>p});var i=n(296),r=n(566),_=n(940),o=[[1.4,0],[2.4,2.4,4,4,2.4,2.4,2.4,2.8,2.4,2.4,4,2.4,2.4,2.4,2.4,2.4],[6,7,8.5,7,6,7,0,10],[14,14]],a=.75;function s(t,e){return e*=a,{sprite:t,shape:new r.D8(o[t.category][t.type]*e),w:t.tw*e,h:t.th*e,renderType:0}}function u(t,e,n){var i=(0,_.e8)(4,t,e);return{sprite:i,shape:new r.HC(n,o[1][4]*a),renderType:0,w:i.tw*a,h:1.25*n}}function p(t,e,n,r,o,u,p){var c=(0,_.e8)(t,e,r);return c.ty+=0==t?4:4==t||1==t?1:NaN,c.th-=0==t?8:4==t?2:1==t?1:NaN,{sprite:c,shape:new i.cE(0==t?i.cE.line_circle:1==t?i.cE.half_arc:4==t?i.cE.double_arc:null),renderType:0,sprite_width:c.tw*a/2*p,hitbox_width:2.4*a*p,l_ratio:0==t||u>0?1:4==t?1.15:1==t?1.2:NaN,base:s((0,_.hZ)(0,n,r),o*p),end:s((0,_.hZ)(0,n,r),u*p)}}},940:(t,e,n)=>{"use strict";n.d(e,{Xp:()=>o,e8:()=>a,hZ:()=>s,a_:()=>u,cI:()=>p});var i=[0,0,1,1,0,0,0,0,0,1,1,1,1,0,0],r=[1,1,1,0,0,0,1,0],_=2*Math.PI/600,o={path:"assets/bullet_000.png",w:516,h:772};function a(t,e,n){return{sprite:o,tx:t<12?1+16*e:t<14?1+e%8*8:t<15?1:258+16*e,ty:t<12?1+16*t:t<14?(t<13?193:241)+8*(e>>3):e<15?515+16*e:449,tw:t<12?16:t<14?8:t<15?256:16,th:t<12?16:t<14?8:16,mode:n,category:1,type:t,color:e,omega:i[t]*_}}function s(t,e,n){return{sprite:o,tx:(t<7?1:258)+32*e,ty:0==t?209:t<7?226+32*t:257,tw:32,th:32,mode:n,category:2,type:t,color:e,omega:r[t]*_}}var u={sprite:o,tx:258,ty:17,tw:64,th:64,mode:0,category:0,type:0,color:0,omega:_},p={sprite:o,tx:386,ty:81,tw:128,th:128,mode:0,category:0,type:2,color:0,omega:_}},235:()=>{const t=document.getElementById("stage_start"),e=document.getElementById("stage_dec"),n=document.getElementById("stage_inc"),i=debug_info.stage,r=()=>{e.disabled=0==i.stage,n.disabled=i.stage==i.list.length-1,t.value=`start stage ${i.list[i.stage].name}`};e.onclick=()=>{i.stage>0&&i.stage--,r()},n.onclick=()=>{i.stage<i.list.length&&i.stage++,r()},r()},924:(t,e,n)=>{"use strict";n.r(e),n.d(e,{global_gl:()=>r,setup:()=>_,setMode:()=>o,loadImage:()=>a,draw:()=>s,drawStrip:()=>u,loadTexture:()=>p,clear:()=>c,drawRects:()=>y,drawSnake:()=>M});var i=n(349);const r={gl:null,shader:{program:0,attribute:{coord:0,tex:0,alpha:0},uniform:{uSampler:0}}};function _(){var t=document.getElementById("glcanvas"),e=t.getContext("webgl");if(null===e)return void alert("Unable to initialize WebGL. Your browser or machine may not support it.");r.gl=e;var n=e.createShader(e.VERTEX_SHADER),i=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(n,"\nattribute vec2 coord;\nattribute vec2 tex;\nattribute float alpha;\nvarying highp vec2 vTexCoord;\nvarying highp float vTexAlpha;\nvoid main() {\n    gl_Position = vec4(coord, 0.0, 1.0);\n    vTexCoord = tex;\n    vTexAlpha = alpha;\n}\n"),e.shaderSource(i,"\nprecision highp float;\nvarying highp vec2 vTexCoord;\nvarying highp float vTexAlpha;\nuniform sampler2D uSampler;\nvoid main() {\n    vec4 col = texture2D(uSampler, vTexCoord);\n    col.a *= vTexAlpha;\n    col.rgb *= col.a;\n    gl_FragColor = col;\n}\n"),e.compileShader(n),e.compileShader(i);var _=e.createProgram();e.attachShader(_,n),e.attachShader(_,i),e.linkProgram(_),e.useProgram(_);const o=r.shader;o.program=_,o.attribute.coord=e.getAttribLocation(_,"coord"),o.attribute.tex=e.getAttribLocation(_,"tex"),o.attribute.alpha=e.getAttribLocation(_,"alpha"),o.uniform.uSampler=e.getUniformLocation(_,"uSampler"),e.enable(e.BLEND),e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA),e.disable(e.DEPTH_TEST),e.viewport(0,0,t.width,t.height)}function o(t){const e=r.gl;0==t?e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA):e.blendFuncSeparate(e.ONE,e.ONE,e.ONE,e.ONE_MINUS_SRC_ALPHA)}function a(t){return new Promise(((e,n)=>{let i=new Image;i.onload=()=>e(i),i.onerror=n,i.src=t}))}function s(t,e,n,i,_){const o=r.gl,a=o.createBuffer(),s=r.shader.attribute.coord;o.bindBuffer(o.ARRAY_BUFFER,a),o.bufferData(o.ARRAY_BUFFER,t,o.STATIC_DRAW),o.vertexAttribPointer(s,2,o.FLOAT,!1,0,0),o.enableVertexAttribArray(s);const u=o.createBuffer(),p=r.shader.attribute.tex;o.bindBuffer(o.ARRAY_BUFFER,u),o.bufferData(o.ARRAY_BUFFER,e,o.STATIC_DRAW),o.vertexAttribPointer(p,2,o.FLOAT,!1,0,0),o.enableVertexAttribArray(p);const c=o.createBuffer(),h=r.shader.attribute.alpha;o.bindBuffer(o.ARRAY_BUFFER,c),o.bufferData(o.ARRAY_BUFFER,n,o.STATIC_DRAW),o.vertexAttribPointer(h,1,o.FLOAT,!1,0,0),o.enableVertexAttribArray(h),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,i),o.uniform1i(r.shader.uniform.uSampler,0),o.drawArrays(o.TRIANGLES,0,_)}function u(t,e,n,i,_){const o=r.gl,a=o.createBuffer(),s=r.shader.attribute.coord;o.bindBuffer(o.ARRAY_BUFFER,a),o.bufferData(o.ARRAY_BUFFER,t,o.STATIC_DRAW),o.vertexAttribPointer(s,2,o.FLOAT,!1,0,0),o.enableVertexAttribArray(s);const u=o.createBuffer(),p=r.shader.attribute.tex;o.bindBuffer(o.ARRAY_BUFFER,u),o.bufferData(o.ARRAY_BUFFER,e,o.STATIC_DRAW),o.vertexAttribPointer(p,2,o.FLOAT,!1,0,0),o.enableVertexAttribArray(p);const c=o.createBuffer();o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,c),o.bufferData(o.ELEMENT_ARRAY_BUFFER,n,o.STATIC_DRAW),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,i),o.uniform1i(r.shader.uniform.uSampler,0),o.drawElements(o.TRIANGLE_STRIP,_,o.UNSIGNED_SHORT,0)}function p(t,e=!0,n=!1){const i=r.gl,_=i.createTexture();return i.bindTexture(i.TEXTURE_2D,_),i.bindTexture(i.TEXTURE_2D,_),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_SHORT_4_4_4_4,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,e?i.LINEAR:i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,e?i.LINEAR:i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,n?i.REPEAT:i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,n?i.REPEAT:i.CLAMP_TO_EDGE),_}function c(){const t=r.gl;t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT),t.clearColor(0,0,1,1)}const h=[-1,-1,1,-1,1,1],l=[-1,1,1,-1,-1,1],f=[0,0,1,0,1,1],d=[0,1,1,0,0,1];function E(t){for(var e=0;e<t.length/2;e++)t[2*e]=(0,i.OK)(t[2*e]),t[2*e+1]=(0,i.ZA)(t[2*e+1])}function y(t,e,n){const i=new Float32Array(12*e),r=new Float32Array(12*e),_=new Float32Array(6*e);for(var o=0;o<e;o++)for(var a=0;a<6;a++){const e=t[10*o+2],n=t[10*o+3]*h[a],s=t[10*o+4]*l[a];i[12*o+2*a+0]=t[10*o+0]+n*Math.cos(e)-s*Math.sin(e),i[12*o+2*a+1]=t[10*o+1]+n*Math.sin(e)+s*Math.cos(e),r[12*o+2*a+0]=t[10*o+5]+f[a]*t[10*o+7],r[12*o+2*a+1]=t[10*o+6]+d[a]*t[10*o+8],_[6*o+a]=t[10*o+9]}E(i),s(i,r,_,n,6*e)}function M(t,e,n,i,_,o,a,s){const u=new Float32Array(6*n),p=new Float32Array(n),c=new Float32Array(6*n),h=new Int16Array(2*(n-1));for(var l=0,f=0;f<n-1;f++){const n=t[2*f],i=t[2*f+1],r=t[2*f+2],_=t[2*f+3],o=(n+r)/2,a=(i+_)/2,s=Math.sqrt((r-n)*(r-n)+(_-i)*(_-i));p[f]=s,l+=s,u[6*f+0]=n,u[6*f+1]=i,u[6*f+2]=o-(a-i)/s*e,u[6*f+3]=a+(o-n)/s*e,u[6*f+4]=o+(a-i)/s*e,u[6*f+5]=a-(o-n)/s*e}E(u),l-=p[0]/2+p[n-1]/2;var d=-p[0]/2;for(f=1;f<n;f++)c[6*f+0]=i+o*d/l,c[6*f+1]=_+a/2,d+=p[f]/2,c[6*f+2]=i+o*d/l,c[6*f+3]=_,c[6*f+4]=i+o*d/l,c[6*f+5]=_+a,d+=p[f]/2;for(f=0;f<n-1;f++)h[2*f+0]=3*f+1,h[2*f+1]=3*f+3;h[2*n-3]--;const y=r.gl,M=y.createBuffer(),v=r.shader.attribute.coord;y.bindBuffer(y.ARRAY_BUFFER,M),y.bufferData(y.ARRAY_BUFFER,u,y.STATIC_DRAW),y.vertexAttribPointer(v,2,y.FLOAT,!1,0,0),y.enableVertexAttribArray(v);const P=y.createBuffer(),m=r.shader.attribute.tex;y.bindBuffer(y.ARRAY_BUFFER,P),y.bufferData(y.ARRAY_BUFFER,c,y.STATIC_DRAW),y.vertexAttribPointer(m,2,y.FLOAT,!1,0,0),y.enableVertexAttribArray(m),y.activeTexture(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,s),y.uniform1i(r.shader.uniform.uSampler,0);const g=y.createBuffer();for(y.bindBuffer(y.ELEMENT_ARRAY_BUFFER,g),y.bufferData(y.ELEMENT_ARRAY_BUFFER,h,y.STATIC_DRAW),y.drawElements(y.TRIANGLE_STRIP,2*n-2,y.UNSIGNED_SHORT,0),f=0;f<n-1;f++)h[2*f+0]=3*f,h[2*f+1]=3*f+2;h[0]++,y.bufferData(y.ELEMENT_ARRAY_BUFFER,h,y.STATIC_DRAW),y.drawElements(y.TRIANGLE_STRIP,2*n-2,y.UNSIGNED_SHORT,0)}window.debug_info={},window.debug_info.global_gl=r,window.debug_info.gl_func={setup:_,clear:c,draw:s,drawStrip:u,drawRects:y,drawSnake:M}}},__webpack_module_cache__={};function __webpack_require__(t){if(__webpack_module_cache__[t])return __webpack_module_cache__[t].exports;var e=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](e,e.exports,__webpack_require__),e.exports}__webpack_require__.d=(t,e)=>{for(var n in e)__webpack_require__.o(e,n)&&!__webpack_require__.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{"use strict";var t={};__webpack_require__.r(t),__webpack_require__.d(t,{KEY_CLICK:()=>C,KEY_PRESS:()=>I,canvas_height:()=>E,canvas_width:()=>d,devicePixelRatio:()=>P,keys:()=>D,last_update_rate:()=>m,mainloop_start:()=>A,mainloop_terminate:()=>T,mouse:()=>b,setup_canvas:()=>O,test_fps:()=>g});var e,n,i=__webpack_require__(176),r=__webpack_require__(924),_=__webpack_require__(822),o=__webpack_require__(533),a=__webpack_require__(349),s=__webpack_require__(780),u=!1,p=!1,c=0,h=0,l=0,f=0;var d,E,y=0,M=0,v=null,P=1,m=1;function g(){return y=performance.now(),M=241,w(),new Promise(((t,e)=>{v=t}))}function w(){if(--M)requestAnimationFrame(w);else{var t=(performance.now()-y)/240;m=Math.round(t/(1e3/60)),v(m)}}var b={x:0,y:0},D={};function O(){document.onmousemove=t=>{b.x=t.pageX,b.y=t.pageY},document.ontouchstart=t=>{D._touch=3,b.x=t.pageX,b.y=t.pageY,t.preventDefault()},document.ontouchend=t=>{D._touch=1,b.x=t.pageX,b.y=t.pageY,t.preventDefault()},document.ontouchmove=t=>{b.x=t.pageX,b.y=t.pageY,t.preventDefault()},document.onmousedown=t=>{D._press=3},document.onmouseup=t=>{D._press=1},document.addEventListener("keydown",(t=>{var e=t.key;1==e.length&&(e=e.toLowerCase()),D[e]=3}),!1),document.addEventListener("keyup",(t=>{var e=t.key;1==e.length&&(e=e.toLowerCase()),D[e]=1}),!1);var t=window.innerWidth,e=window.innerHeight,n=.95*Math.min(t/a.Fy,e/a.bE),i=document.getElementById("glcanvas");d=n*a.Fy,E=n*a.bE,i.style.width=d+"px",i.style.height=E+"px",P=window.devicePixelRatio||1,i.width=d*P,i.height=E*P,r.setup()}var x=!1;async function A(){x||(x=!0,await function(){return t=this,i=void 0,o=function(){var t,i,_,o;return function(t,e){var n,i,r,_,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return _={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(_[Symbol.iterator]=function(){return this}),_;function a(_){return function(a){return function(_){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&_[0]?i.return:_[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,_[1])).done)return r;switch(i=0,r&&(_=[2&_[0],r.value]),_[0]){case 0:case 1:r=_;break;case 4:return o.label++,{value:_[1],done:!1};case 5:o.label++,i=_[1],_=[0];continue;case 7:_=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==_[0]&&2!==_[0])){o=0;continue}if(3===_[0]&&(!r||_[1]>r[0]&&_[1]<r[3])){o.label=_[1];break}if(6===_[0]&&o.label<r[1]){o.label=r[1],r=_;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(_);break}r[2]&&o.ops.pop(),o.trys.pop();continue}_=e.call(t,o)}catch(t){_=[6,t],i=0}finally{n=r=0}if(5&_[0])throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}([_,a])}}}(this,(function(a){switch(a.label){case 0:return i=(t=r).loadTexture,[4,r.loadImage("assets/ui_bg.png")];case 1:return e=i.apply(t,[a.sent(),!1,!0]),o=(_=r).loadTexture,[4,r.loadImage("assets/scene_bg.png")];case 2:return n=o.apply(_,[a.sent(),!1,!0]),[2]}}))},new((_=void 0)||(_=Promise))((function(e,n){function r(t){try{s(o.next(t))}catch(t){n(t)}}function a(t){try{s(o.throw(t))}catch(t){n(t)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof _?n:new _((function(t){t(n)}))).then(r,a)}s((o=o.apply(t,i||[])).next())}));var t,i,_,o}(),R())}function T(){x=!1}function R(){!function(){var t=_.n.INSTANCE;if(t){var i=function(){if(D.Escape==C&&(u=!u),u)return p=!1,null;var t=0,e=0;D.Shift>=I||D._touch>=I||D._press>=I?(p||(p=!0,c=b.x,h=b.y,l=0,f=0),t=b.x-c-l,e=b.y-h-f,l+=t,f+=e):p=!1,t=t/d*a.Fy*2,e=-e/E*a.bE*2;var n=D.Shift>=I?2:3;return(D.w>=I||D.ArrowUp>=I)&&(e+=n),(D.s>=I||D.ArrowDown>=I)&&(e-=n),(D.a>=I||D.ArrowLeft>=I)&&(t-=n),(D.d>=I||D.ArrowRight>=I)&&(t+=n),{pos_x:t,pos_y:e,key_z:D.z>=I,key_x:D.x==C,key_c:D.c==C}}();if(!u&&(o.U.updateState(i),!u))for(var y=0;y<m;y++)t.update();r.clear();var M=new s.l;M.bind(n),a.io(M),M.flush(),t.render(),r.setMode(0),M.bind(e),a.ax(M),M.flush()}}(),function(){for(var t in D)3==D[t]&&(D[t]=2),1==D[t]&&(D[t]=0)}(),x&&requestAnimationFrame(R)}const I=2,C=3;window.onload=async function(){O(),await i.S(),__webpack_require__(235),A(),window.debug_info.stg={fps:g,init:i.S,start:A,terminate:T},window.debug_info.platform=t}})()})();