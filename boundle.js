(()=>{"use strict";var __webpack_modules__={506:(t,e,r)=>{r.d(e,{R0:()=>u,gT:()=>p});var n,i=r(869),o=r(822),a=r(466),s=r(962),_=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),u={render_layer:i.bm,collide_group:i.A4,collide_mask:i.A4,kill_on_exit:!0,kill_by_bomb:!0,auto_direction:!0},c=function(t,e){return!0},p=function(t){function e(e,r){var n=t.call(this,e)||this;return n.state=i.ZM.PRE_ENTRY,n.motion=c,n.motion_stat=null,n.config=r,n}return _(e,t),e.prototype.simpleInit=function(t,e,r,n){return this.px=t,this.py=e,this.vx=r*Math.cos(n),this.vy=r*Math.sin(n),this.dir=n,this},e.prototype.update=function(t){this.state==i.ZM.PRE_ENTRY&&(this.state=i.ZM.ALIVE);var e=o.n.INSTANCE.special_effects.time_rate;this.motion(this,e)&&(this.px+=this.vx*e,this.py+=this.vy*e,this.config.auto_direction&&(this.dir=Math.atan2(this.vy,this.vx)))},e.prototype.postUpdate=function(t){this.shaped_sprite.shape.exitScreen(this.px,this.py,this.dir,a.SH,a.ZP)&&this.config.kill_on_exit&&(this.state=i.ZM.LEAVING),this.state==i.ZM.LEAVING&&(this.state=i.ZM.DEAD)},e.prototype.attack=function(t,e){e.damaged(e,this)},e.prototype.damaged=function(t,e){return!(!this.config.kill_by_bomb||e.config.collide_group!=i.t_&&e.config.collide_group!=i.T||(this.state=i.ZM.LEAVING,0))},e}(s.eY)},869:(t,e,r)=>{r.d(e,{T:()=>i,ZE:()=>o,yR:()=>a,A4:()=>s,t_:()=>_,T7:()=>u,KZ:()=>c,DV:()=>p,P4:()=>l,k8:()=>h,Gs:()=>f,Io:()=>d,NH:()=>E,bm:()=>y,ZM:()=>n,d9:()=>b,S:()=>m});var n,i=0,o=1,a=2,s=3,_=4,u=5,c=0,p=1,l=1,h=1,f=14,d=0,E=0,y=400;function b(t){return Object.assign({},t)}!function(t){t[t.PRE_ENTRY=0]="PRE_ENTRY",t[t.ALIVE=1]="ALIVE",t[t.LEAVING=2]="LEAVING",t[t.DEAD=3]="DEAD"}(n||(n={}));var m={render_layer:600,collide_group:i,collide_mask:c}},533:(t,e,r)=>{r.d(e,{U:()=>_});var n,i=r(962),o=r(466),a=r(869),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),_=function(t){function e(r,n,i,o,s){var _=t.call(this,(0,a.d9)(r))||this;return _.config=a.S,_.state=a.ZM.ALIVE,_.miss=!1,_.bomb=!1,_.pre_miss=0,_.miss_time=0,_.invince_time=0,e.INSTANCE=_,_.proto=n,_.ability=i,_.sprite=r,_.px=o,_.py=s,_.dir=0,_}return s(e,t),e.updateState=function(t){e.action=t},e.prototype.update=function(t){e.action&&(this.px+=e.action.pos_x,this.py+=e.action.pos_y,this.px<-o.SH&&(this.px=-o.SH),this.px>o.SH&&(this.px=o.SH),this.py<-o.ZP&&(this.py=-o.ZP),this.py>o.ZP&&(this.py=o.ZP),this.proto.updateShoot(e.action.key_z),this.bomb=this.proto.updateBomb(e.action.key_x),this.proto.updateSpecial(e.action.key_c))},e.prototype.postUpdate=function(t){this.miss_time>0&&this.miss_time--,this.pre_miss>0&&(this.pre_miss--,0==this.pre_miss&&(console.log("missed"),this.miss_time=this.ability.miss_time)),this.miss&&(this.miss=!1,this.pre_miss=this.ability.pre_miss),this.bomb&&(this.bomb=!1,this.miss_time=this.ability.bomb_time,this.pre_miss>0&&(console.log("bomb after miss"),this.pre_miss=0)),this.miss_time>0||this.pre_miss>0?(this.invince_time++,Math.floor(this.invince_time/6)%2==0?this.shaped_sprite.sprite=null:this.shaped_sprite.sprite=this.sprite.sprite):(this.invince_time=0,this.shaped_sprite.sprite=this.sprite.sprite)},e.prototype.attack=function(t,e){},e.prototype.damaged=function(t,e){return 0==this.pre_miss&&0==this.miss_time&&(this.miss=!0),e.damaged(e,this)},e.INSTANCE=null,e.action=null,e}(i.eY)},378:(t,e,r)=>{r.d(e,{hP:()=>f,b2:()=>E});var n,i=r(869),o=r(962),a=r(822),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),_=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)n[i]=o[a];return n},u=function(){},c=function(t){function e(e){var r=t.call(this)||this;return r.remain=e,r}return s(e,t),e.prototype.update=function(t){return this.remain-=t,this.remain<0?-this.remain:0},e}(u),p=function(t){function e(e){var r=t.call(this)||this;return r.todo=e,r}return s(e,t),e.prototype.update=function(t){return this.todo(),t},e}(u),l=function(){};function h(t){return t.map((function(t){return"number"==typeof t?new c(t):"function"==typeof t?new p(t):t}))}var f=function(t){function e(e,r){var n=t.call(this)||this;return n.index=0,n.todo=e,n.total=r,n}return s(e,t),e.prototype.supply=function(){return this.index>=this.total?null:(t="function"==typeof this.todo?this.todo(this.index):this.todo,this.index++,h(t));var t},e}(l),d={render_layer:i.NH,collide_group:i.T7,collide_mask:i.Io},E=function(t){function e(e){var r=t.call(this)||this;return r.config=d,r.state=i.ZM.PRE_ENTRY,r.list=h(e),r}return s(e,t),e.prototype.update=function(t){this.state==i.ZM.PRE_ENTRY&&(this.state=i.ZM.ALIVE);for(var e=a.n.INSTANCE.special_effects.time_rate;this.list.length>0&&e;){var r=this.list[0];if(r instanceof l){var n=r.supply();n&&n.length?this.list=_(n,this.list):this.list.shift()}else(e=r.update(e))>0&&this.list.shift()}0==this.list.length&&(this.state=i.ZM.LEAVING)},e.prototype.postUpdate=function(t){this.state==i.ZM.LEAVING&&(this.state=i.ZM.DEAD)},e.prototype.attack=function(t){},e.prototype.damaged=function(t,e){return!1},e}(o.u5)},962:(t,e,r)=>{r.d(e,{D8:()=>s,eY:()=>u,u5:()=>c,_R:()=>p});var n,i,o=r(396),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=function(t){function e(e){var r=t.call(this)||this;return r.radius=e,r}return a(e,t),e.prototype.exitScreen=function(t,e,r,n,i){return Math.abs(t)>n+this.radius||Math.abs(e)>i+this.radius},e.prototype.distanceTo=function(t,e,r){return e-=t.px,r-=t.py,Math.sqrt(e*e+r*r)-this.radius},e.prototype._distanceTo=function(t,e){return Math.sqrt(t*t+e*e)-this.radius},e}(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.distanceTo=function(t,e,r){e-=t.px,r-=t.py;var n=t.dir,i=e*Math.cos(-n)-r*Math.sin(-n),o=r*Math.cos(-n)+e*Math.sin(-n);return this._distanceTo(i,o)},e}((function(){}))),_=(a((function(){return null!==i&&i.apply(this,arguments)||this}),i=function(){}),function(){function t(t,e){this.renderType=t,this.shaped_sprite=e}return t.prototype.distanceTo=function(t,e){return this.shaped_sprite.shape.distanceTo(this,t,e)},t}()),u=function(t){function e(e){return t.call(this,o.I.RECT,e)||this}return a(e,t),e.prototype.rectCount=function(){return 1},e.prototype.render=function(t,e){t[9*e+0]=this.px,t[9*e+1]=this.py,t[9*e+2]=this.dir-3*Math.PI/4,t[9*e+3]=this.shaped_sprite.w/2,t[9*e+4]=this.shaped_sprite.h/2;var r=this.shaped_sprite.sprite;t[9*e+5]=r.tx/r.sprite.w,t[9*e+6]=r.ty/r.sprite.h,t[9*e+7]=r.tw/r.sprite.w,t[9*e+8]=r.th/r.sprite.h},e}(_),c=function(t){function e(){return t.call(this,null,null)||this}return a(e,t),e}(_);function p(t,e){if(t instanceof u&&t.shaped_sprite.shape instanceof s)return e.distanceTo(t.px,t.py)<t.shaped_sprite.shape.radius;if(e instanceof u&&e.shaped_sprite.shape instanceof s)return p(e,t);throw new Error("non-circle non-circle collision not found")}},396:(t,e,r)=>{r.d(e,{I:()=>n,Z:()=>o});var n,i=r(984);!function(t){t[t.RECT=0]="RECT",t[t.STRIP=1]="STRIP"}(n||(n={}));var o=function(){function t(t){this.img=null,this.path=t}return t.prototype.loaded=function(){return this.img},t.prototype.load=function(){return t=this,e=void 0,n=function(){var t;return function(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(e){switch(e.label){case 0:return[4,(0,i.po)(this.path)];case 1:return t=e.sent(),this.img=(0,i.yG)(t),[2]}}))},new((r=void 0)||(r=Promise))((function(i,o){function a(t){try{_(n.next(t))}catch(t){o(t)}}function s(t){try{_(n.throw(t))}catch(t){o(t)}}function _(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}_((n=n.apply(t,e||[])).next())}));var t,e,r,n},t.get=function(e){return t.INS[e]?t.INS[e]:t.INS[e]=new t(e)},t.prototype.draw=function(t){for(var e=t.reduce((function(t,e){return e.renderType==n.RECT?t+e.rectCount():t}),0),r=new Float32Array(9*e),o=0,a=0,s=t;a<s.length;a++)if((p=s[a]).renderType==n.RECT){var _=p;_.render(r,o),o+=_.rectCount()}(0,i.bn)(r,t.length,this.img);for(var u=0,c=t;u<c.length;u++){var p;if((p=c[u]).renderType==n.STRIP)for(var l=p,h=l.getSprite(),f=h.sprite,d=0,E=l.render();d<E.length;d++){var y=E[d];(0,i.AJ)(y,h.w,y.length/2,f.tx,f.ty,f.tw,f.th,this.img)}}},t.INS={},t}()},394:(t,e,r)=>{r.d(e,{x:()=>a});var n=r(962),i=r(396),o=[[1.4],[2.4,2.4,4,4,2.4,2.4,2.4,2.8,2.4,2.4,4,2.4,2.4,2.4,2.4,2.4],[6,7,8.5,7,6,7,0,10],[14,14]];function a(t,e,r){return{sprite:t,shape:new n.D8(o[t.category][t.type]*e),w:t.tw,h:t.th,renderType:i.I.RECT,alpha:r}}},507:(t,e,r)=>{var n,i,o,a,s,_,u,c;r.d(e,{fz:()=>n,qO:()=>o,qb:()=>a,Xp:()=>p,e8:()=>l,a_:()=>h}),function(t){t[t.Overlay=0]="Overlay",t[t.AddBlend=1]="AddBlend"}(n||(n={})),function(t){t[t.Special=0]="Special",t[t.Small=1]="Small",t[t.Medium=2]="Medium",t[t.Large=3]="Large"}(i||(i={})),function(t){t[t.Grey=0]="Grey",t[t.RedX=1]="RedX",t[t.Red=2]="Red",t[t.PinkX=3]="PinkX",t[t.Pink=4]="Pink",t[t.BlueX=5]="BlueX",t[t.Blue=6]="Blue",t[t.CyanX=7]="CyanX",t[t.Cyan=8]="Cyan",t[t.GreenX=9]="GreenX",t[t.Green=10]="Green",t[t.Lemon=11]="Lemon",t[t.YellowX=12]="YellowX",t[t.Yellow=13]="Yellow",t[t.Orange=14]="Orange",t[t.White=15]="White"}(o||(o={})),function(t){t[t.Laser=0]="Laser",t[t.Scale=1]="Scale",t[t.Ring=2]="Ring",t[t.Ball=3]="Ball",t[t.Grain=4]="Grain",t[t.Niddle=5]="Niddle",t[t.Knife=6]="Knife",t[t.Spell=7]="Spell",t[t.Bullet=8]="Bullet",t[t.Germ=9]="Germ",t[t.Star=10]="Star",t[t.Planet=11]="Planet",t[t.S_Cross=12]="S_Cross",t[t.S_Ball=13]="S_Ball",t[t.Curve=14]="Curve",t[t.Drop=15]="Drop"}(a||(a={})),function(t){t[t.Grey=0]="Grey",t[t.Red=1]="Red",t[t.Pink=2]="Pink",t[t.Blue=3]="Blue",t[t.Cyan=4]="Cyan",t[t.Green=5]="Green",t[t.Yellow=6]="Yellow",t[t.White=7]="White"}(s||(s={})),function(t){t[t.Light=0]="Light",t[t.Star=1]="Star",t[t.Ball=2]="Ball",t[t.Butterfly=3]="Butterfly",t[t.Knife=4]="Knife",t[t.Oval=5]="Oval",t[t.LightX=6]="LightX",t[t.Heart=7]="Heart"}(_||(_={})),function(t){t[t.Red=0]="Red",t[t.Blue=1]="Blue",t[t.Green=2]="Green",t[t.Yellow=3]="Yellow"}(u||(u={})),function(t){t[t.Ball=0]="Ball",t[t.Rose=1]="Rose"}(c||(c={}));var p={path:"assets/bullet_000.png",w:516,h:772};function l(t,e,r){return{sprite:p,tx:t<12?1+16*e:t<14?1+e%8*8:t<15?1:258+16*e,ty:t<12?1+16*t:t<14?(t<13?193:241)+8*(e>>3):e<15?515+16*e:449,tw:t<12?16:t<14?8:t<15?256:16,th:t<12?16:t<14?8:16,mode:r,category:i.Small,type:t,color:e}}var h={sprite:p,tx:258,ty:17,tw:64,th:64,mode:n.Overlay,category:i.Special,type:0,color:0};n.Overlay,i.Special,n.Overlay,i.Special},822:(t,e,r)=>{r.d(e,{n:()=>_});var n,i=r(869),o=r(962),a=r(396),s=function(){this.time_rate=1};!function(t){t[t.PRE_INIT=0]="PRE_INIT",t[t.UPDATE=1]="UPDATE",t[t.POST_UPDATE=2]="POST_UPDATE",t[t.ADD_BACK=3]="ADD_BACK"}(n||(n={}));var _=function(){function t(){this.groups=[],this.pending=[],this.update_stage=n.PRE_INIT,this.time=0,this.special_effects=new s,t.INSTANCE=this,this.groups.push({id:i.T,mask:i.KZ,list:[]}),this.groups.push({id:i.ZE,mask:i.DV,list:[]}),this.groups.push({id:i.yR,mask:i.P4,list:[]}),this.groups.push({id:i.A4,mask:i.k8,list:[]}),this.groups.push({id:i.t_,mask:i.Gs,list:[]}),this.groups.push({id:i.T7,mask:i.Io,list:[]})}return t.prototype.registerGroup=function(t){var e=this.groups.length;return this.groups.push({id:e,mask:t,list:[]}),e},t.prototype.add=function(t){this.update_stage!=n.ADD_BACK&&this.update_stage!=n.PRE_INIT?this.pending.push(t):this.groups[t.config.collide_group].list.push(t)},t.prototype.update=function(){var t=this;this.update_stage=n.UPDATE,this.groups.forEach((function(t){return t.list.forEach((function(t){return t.update(t)}))}));for(var e=0;e<this.groups.length;e++)for(var r=0;r<this.groups.length;r++)if(this.groups[e].mask&1<<r)for(var a=0,s=this.groups[e].list;a<s.length;a++){var _=s[a];if(_.state==i.ZM.ALIVE&&_.shaped_sprite&&_.shaped_sprite.shape)for(var u=0,c=this.groups[r].list;u<c.length;u++){var p=c[u];p.state==i.ZM.ALIVE&&p.shaped_sprite&&p.shaped_sprite.shape&&(0,o._R)(_,p)&&_.attack(_,p)}}this.update_stage=n.POST_UPDATE,this.groups.forEach((function(t){return t.list.forEach((function(t){return t.postUpdate(t)}))})),this.groups.forEach((function(t){return t.list=t.list.filter((function(t){return t.state!=i.ZM.DEAD}))})),this.update_stage=n.ADD_BACK,this.pending.forEach((function(e){return t.add(e)})),this.pending=[],this.time++},t.prototype.render=function(){var t,e,r,n,i,o,s,_;return i=this,o=void 0,_=function(){var i,o,s,_,u,c,p,l,h,f;return function(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(d){for(i=new Map,o=0,s=this.groups;o<s.length;o++)for(_=s[o],u=0,c=_.list;u<c.length;u++)(p=c[u]).config.render_layer&&(null===(t=p.shaped_sprite)||void 0===t?void 0:t.sprite)&&(i.has(p.config.render_layer)||i.set(p.config.render_layer,new Map),l=i.get(p.config.render_layer),h=null===(n=null===(r=null===(e=p.shaped_sprite)||void 0===e?void 0:e.sprite)||void 0===r?void 0:r.sprite)||void 0===n?void 0:n.path,l.has(h)||l.set(h,[]),l.get(h).push(p));return f=[],i.forEach((function(t,e){return f.push({rl:e,v:t})})),f.sort((function(t,e){return t.rl-e.rl})),f.forEach((function(t){return t.v.forEach((function(t,e){return a.Z.get(e).draw(t)}))})),[2]}))},new((s=void 0)||(s=Promise))((function(t,e){function r(t){try{a(_.next(t))}catch(t){e(t)}}function n(t){try{a(_.throw(t))}catch(t){e(t)}}function a(e){var i;e.done?t(e.value):(i=e.value,i instanceof s?i:new s((function(t){t(i)}))).then(r,n)}a((_=_.apply(i,o||[])).next())}))},t}()},466:(t,e,r)=>{r.d(e,{SH:()=>n,ZP:()=>i,Fy:()=>o,bE:()=>a,OK:()=>s,ZA:()=>_});var n=192,i=224,o=192,a=224;function s(t){return t/o}function _(t){return t/a}},176:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{S:()=>init});var _entity_Bullet__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(506),_entity_SelfMachine__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(533),_schedule_Scheuler__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(378),_sprite_SpriteManager__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(396),_sprite_sprites__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(507),_sprite_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(394),_stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(822),__awaiter=function(t,e,r,n){return new(r||(r=Promise))((function(i,o){function a(t){try{_(n.next(t))}catch(t){o(t)}}function s(t){try{_(n.throw(t))}catch(t){o(t)}}function _(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}_((n=n.apply(t,e||[])).next())}))},__generator=function(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},sm_proto={updateShoot:function(t){return!1},updateBomb:function(t){return!1},updateSpecial:function(t){return!1}},sm_abi={pre_miss:30,miss_time:60,bomb_time:60};function init(){return __awaiter(this,void 0,void 0,(function(){var pool,repeat,n,sprite,ss;return __generator(this,(function(_a){switch(_a.label){case 0:return[4,_sprite_SpriteManager__WEBPACK_IMPORTED_MODULE_3__.Z.get(_sprite_sprites__WEBPACK_IMPORTED_MODULE_4__.Xp.path).load()];case 1:return _a.sent(),pool=new _stage_EntityPool__WEBPACK_IMPORTED_MODULE_6__.n,pool.add(new _entity_SelfMachine__WEBPACK_IMPORTED_MODULE_1__.U(_sprite_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.x(_sprite_sprites__WEBPACK_IMPORTED_MODULE_4__.a_,1,1),sm_proto,sm_abi,0,0)),eval("window.debug_info.pool = pool"),repeat=function(t,e){return void 0===e&&(e=1/0),new _schedule_Scheuler__WEBPACK_IMPORTED_MODULE_2__.hP(t,e)},n=5,sprite=_sprite_sprites__WEBPACK_IMPORTED_MODULE_4__.e8(_sprite_sprites__WEBPACK_IMPORTED_MODULE_4__.qb.Scale,_sprite_sprites__WEBPACK_IMPORTED_MODULE_4__.qO.Red,_sprite_sprites__WEBPACK_IMPORTED_MODULE_4__.fz.Overlay),ss=_sprite_shaped_sprites__WEBPACK_IMPORTED_MODULE_5__.x(sprite,1,1),pool.add(new _schedule_Scheuler__WEBPACK_IMPORTED_MODULE_2__.b2([60,repeat((function(t){return[repeat((function(e){return[function(){return pool.add(new _entity_Bullet__WEBPACK_IMPORTED_MODULE_0__.gT(ss,_entity_Bullet__WEBPACK_IMPORTED_MODULE_0__.R0).simpleInit(0,0,2,8e-4*t*t+2*Math.PI/n*e))}]}),n),2]}),1/0)])),[2]}}))}))}},984:(t,e,r)=>{r.d(e,{cY:()=>o,po:()=>a,yG:()=>_,ZH:()=>u,bn:()=>f,AJ:()=>d});var n=r(466);const i={gl:null,shader:{program:0,attribute:{coord:0,tex:0},uniform:{uSampler:0}}};function o(){var t=document.getElementById("glcanvas"),e=t.getContext("webgl");if(null===e)return void alert("Unable to initialize WebGL. Your browser or machine may not support it.");i.gl=e;var r=e.createShader(e.VERTEX_SHADER),n=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(r,"\nattribute vec2 coord;\nattribute vec2 tex;\nvarying highp vec2 vTexCoord;\nvoid main(void) {\n    gl_Position = vec4(coord, 0.0, 1.0);\n    vTexCoord = tex;\n}\n"),e.shaderSource(n,"\nvarying highp vec2 vTexCoord;\nuniform sampler2D uSampler;\nvoid main(void) {\n    gl_FragColor = texture2D(uSampler, vTexCoord);\n}\n"),e.compileShader(r),e.compileShader(n);var o=e.createProgram();e.attachShader(o,r),e.attachShader(o,n),e.linkProgram(o),e.useProgram(o);const a=i.shader;a.program=o,a.attribute.coord=e.getAttribLocation(o,"coord"),a.attribute.tex=e.getAttribLocation(o,"tex"),a.uniform.uSampler=e.getUniformLocation(o,"uSampler"),e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.disable(e.DEPTH_TEST),e.viewport(0,0,t.width,t.height)}function a(t){return new Promise(((e,r)=>{let n=new Image;n.onload=()=>e(n),n.onerror=r,n.src=t}))}function s(t,e,r,n){const o=i.gl,a=o.createBuffer(),s=i.shader.attribute.coord;o.bindBuffer(o.ARRAY_BUFFER,a),o.bufferData(o.ARRAY_BUFFER,t,o.STATIC_DRAW),o.vertexAttribPointer(s,2,o.FLOAT,!1,0,0),o.enableVertexAttribArray(s);const _=o.createBuffer(),u=i.shader.attribute.tex;o.bindBuffer(o.ARRAY_BUFFER,_),o.bufferData(o.ARRAY_BUFFER,e,o.STATIC_DRAW),o.vertexAttribPointer(u,2,o.FLOAT,!1,0,0),o.enableVertexAttribArray(u),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,r),o.uniform1i(i.shader.uniform.uSampler,0),o.drawArrays(o.TRIANGLES,0,n)}function _(t){const e=i.gl,r=e.createTexture();return e.bindTexture(e.TEXTURE_2D,r),e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_SHORT_4_4_4_4,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.generateMipmap(e.TEXTURE_2D),r}function u(){const t=i.gl;t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT),t.clearColor(0,0,1,1)}const c=[3,-3,-1,3,1,-1],p=[0,0,1,0,1,1],l=[0,1,1,0,0,1];function h(t){for(var e=0;e<t.length/2;e++)t[2*e]=(0,n.OK)(t[2*e]),t[2*e+1]=(0,n.ZA)(t[2*e+1])}function f(t,e,r){const n=new Float32Array(12*e),i=new Float32Array(12*e),o=Math.PI/4;for(var a=0;a<e;a++)for(var _=0;_<6;_++){const e=t[9*a+2]+c[_]*o;n[12*a+2*_+0]=t[9*a+0]+t[9*a+3]*Math.cos(e)-t[9*a+4]*Math.sin(e),n[12*a+2*_+1]=t[9*a+1]+t[9*a+3]*Math.sin(e)+t[9*a+4]*Math.cos(e),i[12*a+2*_+0]=t[9*a+5]+p[_]*t[9*a+7],i[12*a+2*_+1]=t[9*a+6]+l[_]*t[9*a+8]}h(n),s(n,i,r,6*e)}function d(t,e,r,n,o,a,s,_){const u=new Float32Array(6*r),c=new Float32Array(r),p=new Float32Array(6*r),l=new Int16Array(2*(r-1));for(var f=0,d=0;d<r-1;d++){const r=t[2*d],n=t[2*d+1],i=t[2*d+2],o=t[2*d+3],a=(r+i)/2,s=(n+o)/2,_=Math.sqrt((i-r)*(i-r)+(o-n)*(o-n));c[d]=_,f+=_,u[6*d+0]=r,u[6*d+1]=n,u[6*d+2]=a-(s-n)/_*e,u[6*d+3]=s+(a-r)/_*e,u[6*d+4]=a+(s-n)/_*e,u[6*d+5]=s-(a-r)/_*e}h(u),f-=c[0]/2+c[r-1]/2;var E=-c[0]/2;for(d=1;d<r;d++)p[6*d+0]=n+a*E/f,p[6*d+1]=o+s/2,E+=c[d]/2,p[6*d+2]=n+a*E/f,p[6*d+3]=o,p[6*d+4]=n+a*E/f,p[6*d+5]=o+s,E+=c[d]/2;for(d=0;d<r-1;d++)l[2*d+0]=3*d+1,l[2*d+1]=3*d+3;l[2*r-3]--;const y=i.gl,b=y.createBuffer(),m=i.shader.attribute.coord;y.bindBuffer(y.ARRAY_BUFFER,b),y.bufferData(y.ARRAY_BUFFER,u,y.STATIC_DRAW),y.vertexAttribPointer(m,2,y.FLOAT,!1,0,0),y.enableVertexAttribArray(m);const A=y.createBuffer(),v=i.shader.attribute.tex;y.bindBuffer(y.ARRAY_BUFFER,A),y.bufferData(y.ARRAY_BUFFER,p,y.STATIC_DRAW),y.vertexAttribPointer(v,2,y.FLOAT,!1,0,0),y.enableVertexAttribArray(v),y.activeTexture(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,_),y.uniform1i(i.shader.uniform.uSampler,0);const T=y.createBuffer();for(y.bindBuffer(y.ELEMENT_ARRAY_BUFFER,T),y.bufferData(y.ELEMENT_ARRAY_BUFFER,l,y.STATIC_DRAW),y.drawElements(y.TRIANGLE_STRIP,2*r-2,y.UNSIGNED_SHORT,0),d=0;d<r-1;d++)l[2*d+0]=3*d,l[2*d+1]=3*d+2;l[0]++,y.bufferData(y.ELEMENT_ARRAY_BUFFER,l,y.STATIC_DRAW),y.drawElements(y.TRIANGLE_STRIP,2*r-2,y.UNSIGNED_SHORT,0)}window.debug_info={},window.debug_info.global_gl=i,window.debug_info.gl_func={setup:o,clear:u,draw:s,drawStrip:function(t,e,r,n,o){const a=i.gl,s=a.createBuffer(),_=i.shader.attribute.coord;a.bindBuffer(a.ARRAY_BUFFER,s),a.bufferData(a.ARRAY_BUFFER,t,a.STATIC_DRAW),a.vertexAttribPointer(_,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(_);const u=a.createBuffer(),c=i.shader.attribute.tex;a.bindBuffer(a.ARRAY_BUFFER,u),a.bufferData(a.ARRAY_BUFFER,e,a.STATIC_DRAW),a.vertexAttribPointer(c,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(c);const p=a.createBuffer();a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,p),a.bufferData(a.ELEMENT_ARRAY_BUFFER,r,a.STATIC_DRAW),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,n),a.uniform1i(i.shader.uniform.uSampler,0),a.drawElements(a.TRIANGLE_STRIP,o,a.UNSIGNED_SHORT,0)},drawRects:f,drawSnake:d}}},__webpack_module_cache__={};function __webpack_require__(t){if(__webpack_module_cache__[t])return __webpack_module_cache__[t].exports;var e=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](e,e.exports,__webpack_require__),e.exports}__webpack_require__.d=(t,e)=>{for(var r in e)__webpack_require__.o(e,r)&&!__webpack_require__.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t={};__webpack_require__.r(t),__webpack_require__.d(t,{KEY_CLICK:()=>x,KEY_PRESS:()=>D,canvas_height:()=>h,canvas_width:()=>l,devicePixelRatio:()=>y,keys:()=>T,last_update_rate:()=>b,mainloop_start:()=>w,mainloop_terminate:()=>P,mouse:()=>v,setup_canvas:()=>g,test_fps:()=>m});var e=__webpack_require__(176),r=__webpack_require__(984),n=__webpack_require__(822),i=__webpack_require__(533),o=__webpack_require__(466),a=!1,s=!1,_=0,u=0,c=0,p=0;var l,h,f=0,d=0,E=null,y=1,b=1;function m(){return f=performance.now(),d=241,A(),new Promise(((t,e)=>{E=t}))}function A(){if(--d)requestAnimationFrame(A);else{var t=(performance.now()-f)/240;b=Math.round(t/(1e3/60)),E(b)}}var v={x:0,y:0},T={};function g(){document.onmousemove=t=>{v.x=t.pageX,v.y=t.pageY},document.ontouchstart=t=>{T._touch=3,v.x=t.pageX,v.y=t.pageY,t.preventDefault()},document.ontouchend=t=>{T._touch=1,v.x=t.pageX,v.y=t.pageY,t.preventDefault()},document.ontouchmove=t=>{v.x=t.pageX,v.y=t.pageY,t.preventDefault()},document.onmousedown=t=>{T._press=3},document.onmouseup=t=>{T._press=1},document.addEventListener("keydown",(t=>{var e=t.key;1==e.length&&(e=e.toLowerCase()),T[e]=3}),!1),document.addEventListener("keyup",(t=>{var e=t.key;1==e.length&&(e=e.toLowerCase()),T[e]=1}),!1);var t=window.innerWidth,e=window.innerHeight,n=.95*Math.min(t/o.Fy,e/o.bE),i=document.getElementById("glcanvas");l=n*o.Fy,h=n*o.bE,i.style.width=l+"px",i.style.height=h+"px",y=window.devicePixelRatio||1,i.width=l*y,i.height=h*y,r.cY()}var R=!1;function w(){R||(R=!0,S())}function P(){R=!1}function S(){!function(){var t=n.n.INSTANCE;if(t){var e=function(){if(T.Escape==x&&(a=!a),a)return s=!1,null;var t=0,e=0;T.Shift>=D||T._touch>=D||T._press>=D?(s||(s=!0,_=v.x,u=v.y,c=0,p=0),t=v.x-_-c,e=v.y-u-p,c+=t,p+=e):s=!1,t=t/l*o.Fy*2,e=-e/h*o.bE*2;var r=T.Shift>=D?2:3;return(T.w>=D||T.ArrowUp>=D)&&(e+=r),(T.s>=D||T.ArrowDown>=D)&&(e-=r),(T.a>=D||T.ArrowLeft>=D)&&(t-=r),(T.d>=D||T.ArrowRight>=D)&&(t+=r),{pos_x:t,pos_y:e,key_z:T.z>=D,key_x:T.x==x,key_c:T.c==x}}();if(!a&&(i.U.updateState(e),!a))for(var f=0;f<b;f++)t.update();r.ZH(),t.render()}}(),function(){for(var t in T)3==T[t]&&(T[t]=2),1==T[t]&&(T[t]=0)}(),R&&requestAnimationFrame(S)}const D=2,x=3;window.onload=async function(){m(),g(),await e.S(),w(),window.debug_info.stg={fps:m,init:e.S,start:w,terminate:P},window.debug_info.platform=t}})()})();