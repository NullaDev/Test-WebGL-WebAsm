(()=>{"use strict";const e={gl:null,shader:{program:0,attribute:{coord:0,tex:0},uniform:{uSampler:0}}};window.onload=async function(){var r=window.innerWidth,t=window.innerHeight,a=.8*Math.min(r,t),n=document.getElementById("glcanvas");n.style.width=a+"px",n.style.height=a+"px";var o=window.devicePixelRatio||1;n.width=a*o,n.height=a*o,function(){var r=document.getElementById("glcanvas"),t=r.getContext("webgl");if(null===t)return void alert("Unable to initialize WebGL. Your browser or machine may not support it.");e.gl=t;var a=t.createShader(t.VERTEX_SHADER),n=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(a,"\nattribute vec2 coord;\nattribute vec2 tex;\nvarying highp vec2 vTexCoord;\nvoid main(void) {\n    gl_Position = vec4(coord, 0.0, 1.0);\n    vTexCoord = tex;\n}\n"),t.shaderSource(n,"\nvarying highp vec2 vTexCoord;\nuniform sampler2D uSampler;\nvoid main(void) {\n    gl_FragColor = texture2D(uSampler, vTexCoord);\n}\n"),t.compileShader(a),t.compileShader(n);var o=t.createProgram();t.attachShader(o,a),t.attachShader(o,n),t.linkProgram(o),t.useProgram(o);const i=e.shader;i.program=o,i.attribute.coord=t.getAttribLocation(o,"coord"),i.attribute.tex=t.getAttribLocation(o,"tex"),i.uniform.uSampler=t.getUniformLocation(o,"uSampler"),t.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),t.disable(t.DEPTH_TEST),t.viewport(0,0,r.width,r.height)}(),await async function(){const r=function(r){const t=e.gl,a=t.createTexture();return t.bindTexture(t.TEXTURE_2D,a),t.bindTexture(t.TEXTURE_2D,a),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_SHORT_4_4_4_4,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.generateMipmap(t.TEXTURE_2D),a}(await("assets/missile_green.png",new Promise(((e,r)=>{let t=new Image;t.onload=()=>e(t),t.onerror=r,t.src="assets/missile_green.png"}))));!function(){const r=e.gl;r.clearColor(0,0,0,1),r.clear(r.COLOR_BUFFER_BIT),r.clearColor(0,0,1,1)}();for(var t=500,a=new Float32Array(1e3),n=0;n<t;n++)a[2*n+0]=.1*Math.sin(10*n*Math.PI/t),a[2*n+1]=1.8*n/t-.9;!function(e){var r=+new Date;e();var t=+new Date;console.log(t-r)}((()=>function(r,t,a,n,o,i,c,E){const l=new Float32Array(3e3),R=new Float32Array(a),T=new Float32Array(3e3),u=new Int16Array(998);for(var d=0,A=0;A<499;A++){const e=r[2*A],a=r[2*A+1],n=r[2*A+2],o=r[2*A+3],i=(e+n)/2,c=(a+o)/2,E=Math.sqrt((n-e)*(n-e)+(o-a)*(o-a));R[A]=E,d+=E,l[6*A+0]=e,l[6*A+1]=a,l[6*A+2]=i-(c-a)/E*t,l[6*A+3]=c+(i-e)/E*t,l[6*A+4]=i+(c-a)/E*t,l[6*A+5]=c-(i-e)/E*t}d-=R[0]/2+R[499]/2;var s=-R[0]/2;for(A=1;A<a;A++)T[6*A+0]=0+1*s/d,T[6*A+1]=.5,s+=R[A]/2,T[6*A+2]=0+1*s/d,T[6*A+3]=0,T[6*A+4]=0+1*s/d,T[6*A+5]=1,s+=R[A]/2;for(A=0;A<499;A++)u[2*A+0]=3*A+1,u[2*A+1]=3*A+3;u[997]--;const _=e.gl,f=_.createBuffer(),m=e.shader.attribute.coord;_.bindBuffer(_.ARRAY_BUFFER,f),_.bufferData(_.ARRAY_BUFFER,l,_.STATIC_DRAW),_.vertexAttribPointer(m,2,_.FLOAT,!1,0,0),_.enableVertexAttribArray(m);const g=_.createBuffer(),h=e.shader.attribute.tex;_.bindBuffer(_.ARRAY_BUFFER,g),_.bufferData(_.ARRAY_BUFFER,T,_.STATIC_DRAW),_.vertexAttribPointer(h,2,_.FLOAT,!1,0,0),_.enableVertexAttribArray(h),_.activeTexture(_.TEXTURE0),_.bindTexture(_.TEXTURE_2D,E),_.uniform1i(e.shader.uniform.uSampler,0);const b=_.createBuffer();for(_.bindBuffer(_.ELEMENT_ARRAY_BUFFER,b),_.bufferData(_.ELEMENT_ARRAY_BUFFER,u,_.STATIC_DRAW),_.drawElements(_.TRIANGLE_STRIP,998,_.UNSIGNED_SHORT,0),A=0;A<499;A++)u[2*A+0]=3*A,u[2*A+1]=3*A+2;u[0]++,_.bufferData(_.ELEMENT_ARRAY_BUFFER,u,_.STATIC_DRAW),_.drawElements(_.TRIANGLE_STRIP,998,_.UNSIGNED_SHORT,0)}(a,.03,t,0,0,0,0,r)))}()}})();